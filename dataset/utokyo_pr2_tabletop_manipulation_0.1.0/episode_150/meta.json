{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_150",
  "task_summary": "Detect, approach, grasp a grape bunch, transfer it over the plate, place it gently, and retreat.",
  "task_long_description": {
    "overview": "A PR2 arm interacts with a tabletop scene containing a plate, a grape bunch, and a wooden surface. The arm must visually locate the grapes, approach with an elevated pre-grasp, compute a pinch grasp, align precisely, and pick the grapes. After securing the grasp, it moves above the plate, lowers until contact to ensure gentle placement, opens the gripper to release, and retreats to a safe pose. Visual confirmation and careful alignment are emphasized to avoid knocking the grapes or the plate.",
    "preconditions": ["Workspace is clear except plate and grapes", "Camera provides view of table", "Gripper operational and empty", "Plate pose approximately known as plate_center"],
    "stepwise_plan": ["Open gripper", "Perceive grapes; scan if not visible", "Refine detection and move to pre-grasp above grapes", "Compute grasp and align precisely", "Pick grapes and confirm stability implicitly via sequence", "Move above plate", "Lower until contact and release", "Retreat to safe distance"],
    "success_criteria": ["Grapes end up resting on the plate surface", "No collision strong enough to displace plate", "Robot retreats with empty gripper"],
    "failure_and_recovery": ["If grapes not visible, raster scan to re-acquire", "If approach misaligned, repeat alignment step", "If pick fails, re-compute grasp and retry sequence from pre-grasp", "If contact detected too early, retreat slightly and re-approach"],
    "termination": "Tree completes after retreat following a successful release above the plate."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_4","frame_6","frame_2","frame_7","frame_1","frame_0","frame_8"],
    "scores": {
      "frame_0": 0.20,
      "frame_1": 0.42,
      "frame_2": 0.63,
      "frame_3": 0.93,
      "frame_4": 0.78,
      "frame_5": 0.88,
      "frame_6": 0.69,
      "frame_7": 0.47,
      "frame_8": 0.15
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "Gripper is aligned directly over the grapes, indicating imminent grasp.",
        "predicts_next": "Closing and lifting or secure pick followed by transfer toward the plate.",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "picking a grape",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7","frame_8"],
  "objects": ["grape_bunch", "plate", "table", "pr2_gripper"],
  "objects_from_instruction": ["grape"],
  "blackboard_keys": ["grasp_grape", "plate_center"],
  "node_specs": [
    {"id":"OpenGripper","type":"Action","ports":{"width":"float","timeout_ms":"int"},"description":"Open fingers to the given width to prepare for grasp or to release."},
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"string"},"description":"Checks if the specified target is currently visible."},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"string","pattern":"string","max_attempts":"int","timeout_ms":"int"},"description":"Performs a scanning motion to acquire the target if not visible."},
    {"id":"DetectObject","type":"Action","ports":{"target":"string","timeout_ms":"int"},"description":"Runs perception to refine pose of the target object."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"string","offset_z":"float","timeout_ms":"int"},"description":"Moves to a pose above the named target with vertical offset."},
    {"id":"ComputeGraspPose","type":"Action","ports":{"target":"string","strategy":"string","result_key":"string"},"description":"Computes a grasp pose for the target and stores it on the blackboard."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"string","tolerance":"float","timeout_ms":"int"},"description":"Carefully approaches and aligns the end-effector to within tolerance."},
    {"id":"Pick","type":"Action","ports":{"grasp_key":"string","timeout_ms":"int"},"description":"Executes a pick using a precomputed grasp referenced by key."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"string","max_depth":"float","force_threshold":"float","timeout_ms":"int"},"description":"Descends slowly until contact is sensed to ensure gentle placement."},
    {"id":"Retreat","type":"Action","ports":{"distance":"float","timeout_ms":"int"},"description":"Backs away by a safe distance after placing or when aborting."}
  ],
  "tree_stats": {"nodes_total": 14, "actions": 11, "conditions": 1, "depth": 4},
  "failure_modes": ["Target not visible due to occlusion", "Misalignment during approach causing slip", "Weak grasp leading to drop mid-transfer", "Collision with plate rim during placement", "Timeouts in motion or perception"],
  "recovery_strategy": ["Fallback scan when visibility fails", "Re-run ApproachAndAlign if tolerance not met", "Recompute grasp and re-Pick upon failure", "Slight retreat and re-lower if early contact detected"],
  "assumptions": ["Frames indicate a full pick-and-place onto a plate, while the instruction only says 'picking a grape'; tree follows the visual evidence.", "‘grape’ refers to a small bunch rather than a single berry.", "Plate center pose is known as symbolic key 'plate_center'."],
  "evaluation_notes": {
    "expected_success_criteria": ["Grapes resting on plate; gripper open; arm safely retracted", "No objects displaced off the table"],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"ScanForTarget","attrs":{"target":"grape","pattern":"raster","max_attempts":3,"timeout_ms":1500}},
      "active_path_ids": ["Sequence","Fallback","ScanForTarget"]
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"grape","offset_z":0.05,"timeout_ms":1200}},
      "active_path_ids": ["Sequence","MoveAbove"]
    },
    {
      "frame": "frame_2",
      "phase": "verify",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"grape","tolerance":0.005,"timeout_ms":1200}},
      "active_path_ids": ["Sequence","ApproachAndAlign"]
    },
    {
      "frame": "frame_3",
      "phase": "grasp",
      "active_leaf": {"id":"Pick","attrs":{"grasp_key":"grasp_grape","timeout_ms":1500}},
      "active_path_ids": ["Sequence","Pick"]
    },
    {
      "frame": "frame_4",
      "phase": "transfer",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"plate_center","offset_z":0.1,"timeout_ms":1200}},
      "active_path_ids": ["Sequence","MoveAbove"]
    },
    {
      "frame": "frame_5",
      "phase": "place",
      "active_leaf": {"id":"LowerUntilContact","attrs":{"speed":"slow","max_depth":0.03,"force_threshold":10.0,"timeout_ms":1200}},
      "active_path_ids": ["Sequence","LowerUntilContact"]
    },
    {
      "frame": "frame_6",
      "phase": "place",
      "active_leaf": {"id":"OpenGripper","attrs":{"width":0.09,"timeout_ms":800}},
      "active_path_ids": ["Sequence","OpenGripper"]
    },
    {
      "frame": "frame_7",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.2,"timeout_ms":1200}},
      "active_path_ids": ["Sequence","Retreat"]
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.2,"timeout_ms":1200}},
      "active_path_ids": ["Sequence","Retreat"]
    }
  ]
}
