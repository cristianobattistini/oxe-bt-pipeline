{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_176",
  "task_summary": "Detect a grape, approach with a top-pinching strategy, grasp it gently, then lift and retreat.",
  "task_long_description": {
    "overview": "A PR2 end-effector operates over a tabletop with a bright circular plate and a grape cluster visible in several frames. The behavior aims to pick a single grape using a precise top approach suitable for small, delicate objects. The process opens the gripper, detects the grape, computes a pinch grasp, aligns precisely, lowers until surface contact, closes with low force, verifies grasp stability, and retreats. The visual sequence shows approach over the plate and downward motion consistent with a pick from the plate surface.",
    "preconditions": ["Workspace cleared except plate and grape cluster", "Gripper functional and empty", "Camera calibrated and providing overhead view", "Collision model for table and plate loaded"],
    "stepwise_plan": ["Open gripper to minimal width for small objects", "Detect grape and compute a pinch grasp pose", "Move above the target with safe clearance", "Align precisely to the grasp pose", "Lower until gentle contact is detected", "Close gripper with low force to avoid crushing", "Execute pick using computed grasp", "Verify grasp stability and retreat upward"],
    "success_criteria": ["A single grape is held in the gripper after lift", "No slippage detected for at least one second", "No collision with plate edge or table during approach"],
    "failure_and_recovery": ["If detection fails, retry limited times with the same detector", "If contact not detected at expected depth, abort lowering and re-align", "If grasp unstable, reopen, replan grasp, and retry"],
    "termination": "Terminate when a stable grasp is confirmed and the robot has retreated to a safe height."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0", "frame_8"],
    "scores": {
      "frame_0": 0.12, "frame_1": 0.34, "frame_2": 0.56, "frame_3": 0.92,
      "frame_4": 0.28, "frame_5": 0.80, "frame_6": 0.49, "frame_7": 0.18, "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "first stable contact and alignment cue visible",
        "predicts_next": "push actuation expected; confirms goal direction",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "picking a grape",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7", "frame_8"],
  "objects": ["grape", "grape_cluster", "plate", "table", "robot_gripper"],
  "objects_from_instruction": ["grape"],
  "blackboard_keys": ["grasp_grape"],
  "node_specs": [
    {"id":"OpenGripper","type":"Action","ports":{"width":"0.06","timeout_ms":"500"},"description":"Prepare end-effector by opening to minimal width for small objects"},
    {"id":"DetectObject","type":"Action","ports":{"target":"grape","timeout_ms":"800"},"description":"Perceive the grape in the scene"},
    {"id":"ComputeGraspPose","type":"Action","ports":{"target":"grape","strategy":"pinch","result_key":"grasp_grape"},"description":"Plan a pinch grasp suitable for a small grape"},
    {"id":"MoveAbove","type":"Action","ports":{"target":"grape","offset_z":"0.05","timeout_ms":"1200"},"description":"Move to a pregrasp pose above the target"},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"grape","tolerance":"0.005","timeout_ms":"1200"},"description":"Align precisely to the grasp pose before descent"},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":"0.05","force_threshold":"10","timeout_ms":"1200"},"description":"Lower until gentle contact with the surface or object"},
    {"id":"CloseGripper","type":"Action","ports":{"force":"10","timeout_ms":"800"},"description":"Close the gripper with low force to avoid crushing"},
    {"id":"Pick","type":"Action","ports":{"grasp_key":"grasp_grape","timeout_ms":"1200"},"description":"Execute the pick using the computed grasp"},
    {"id":"IsGraspStable","type":"Condition","ports":{},"description":"Verify grasp stability before moving"},
    {"id":"Retreat","type":"Action","ports":{"distance":"0.1","timeout_ms":"1200"},"description":"Retreat to a safe height after grasp"}
  ],
  "tree_stats": {"nodes_total": 12, "actions": 9, "conditions": 1, "depth": 3},
  "failure_modes": ["Grape not detected", "Contact not sensed due to reflective plate", "Crushing or slipping due to excessive force", "Collision with plate rim during approach"],
  "recovery_strategy": ["Retry detection up to three times", "Recompute grasp with updated pose and re-align", "Reduce closing force and attempt again", "Retreat and adjust approach height before retry"],
  "assumptions": ["Frames depict approach over a bright circular plate; individual grape visibility is low, so a top pinch is assumed. Instruction says 'picking a grape' while some frames suggest interaction centered over a plate rather than clearly at the grape cluster; the design follows the picking goal but is grounded to the top-approach motion seen."],
  "evaluation_notes": {
    "expected_success_criteria": ["Single grape secured and lifted without deformation", "No collisions with plate or table"],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"grape","timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"grape","tolerance":0.005,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "approach",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"grape","tolerance":0.005,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "approach",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"grape","tolerance":0.005,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"grape","offset_z":0.05,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "grasp",
      "active_leaf": {"id":"LowerUntilContact","attrs":{"speed":"slow","max_depth":0.05,"force_threshold":10,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "grasp",
      "active_leaf": {"id":"CloseGripper","attrs":{"force":10,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "transfer",
      "active_leaf": {"id":"Pick","attrs":{"grasp_key":"grasp_grape","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":1200}},
      "active_path_ids": []
    }
  ]
}
