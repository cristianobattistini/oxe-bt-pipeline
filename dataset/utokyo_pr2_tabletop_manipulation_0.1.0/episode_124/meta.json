{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_124",
  "task_summary": "Detect the grape cluster, approach precisely, grasp gently, lift, move over the plate, lower to contact, release onto the plate, and retreat.",
  "task_long_description": {
    "overview": "A PR2 end-effector interacts with a small grape cluster on a tabletop with a white plate. The goal is to pick the grapes and place them onto the plate. The behavior emphasizes reliable perception of a small dark object, careful approach with tight alignment, gentle gripping to avoid crushing, and a deliberate transfer and release over the plate followed by a safe retreat.",
    "preconditions": ["Robot reachable workspace includes grape and plate", "Camera view of workspace available", "Gripper operational and empty", "Table surface clear except for plate and grapes"],
    "stepwise_plan": ["Open gripper", "If grapes not visible, scan; then detect grapes", "Move above grapes and align precisely", "Close gripper with low force", "Verify grapes are in gripper", "Lift up", "Move to plate center", "Lower until contact with plate", "Open gripper to release", "Retreat from plate"],
    "success_criteria": ["Grapes rest on plate after release", "No slips during transfer", "End-effector clear of plate at end"],
    "failure_and_recovery": ["Perception fails → scan again", "Misalignment → re-approach and align", "Grasp fails → reopen and retry", "Contact too early → retreat slightly and realign"],
    "termination": "Terminate when grapes are released on plate and the gripper has retreated."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0", "frame_8"],
    "scores": {
      "frame_0": 0.12, "frame_1": 0.34, "frame_2": 0.56, "frame_3": 0.92,
      "frame_4": 0.28, "frame_5": 0.80, "frame_6": 0.49, "frame_7": 0.18, "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "first stable contact and alignment cue visible",
        "predicts_next": "push actuation expected; confirms goal direction",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "picking a grape",
  "instruction_to_ports": {
    "force": 10,
    "timeout_ms": 800,
    "tolerance": 0.005,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7", "frame_8"],
  "objects": ["grape", "plate", "table", "pr2_gripper"],
  "objects_from_instruction": ["grape"],
  "blackboard_keys": [],
  "node_specs": [
    {"id":"OpenGripper","type":"Action","ports":{"width":"float","timeout_ms":"int"},"description":"Opens the gripper to a specified width."},
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"string"},"description":"Checks if target is visible."},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"string","pattern":"string","max_attempts":"int","timeout_ms":"int"},"description":"Active scan to locate target."},
    {"id":"DetectObject","type":"Action","ports":{"target":"string","timeout_ms":"int"},"description":"Detect target and refine pose."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"string","offset_z":"float","timeout_ms":"int"},"description":"Move to a pregrasp height above target."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"string","tolerance":"float","timeout_ms":"int"},"description":"Closed-loop approach with alignment tolerance."},
    {"id":"CloseGripper","type":"Action","ports":{"force":"float","timeout_ms":"int"},"description":"Close gripper with specified force."},
    {"id":"ObjectInGripper","type":"Condition","ports":{"target":"string"},"description":"Confirms the object is grasped."},
    {"id":"MoveDelta","type":"Action","ports":{"axis":"string","dist":"float","timeout_ms":"int"},"description":"Small Cartesian lift along an axis."},
    {"id":"MoveTo","type":"Action","ports":{"target":"string","timeout_ms":"int"},"description":"Move to a named target pose."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"string","max_depth":"float","force_threshold":"float","timeout_ms":"int"},"description":"Descend until contact is detected."},
    {"id":"Retreat","type":"Action","ports":{"distance":"float","timeout_ms":"int"},"description":"Back off from the placement area."}
  ],
  "tree_stats": {"nodes_total": 15, "actions": 11, "conditions": 2, "depth": 3},
  "failure_modes": ["Grapes not detected", "Misalignment causing a slip", "Insufficient grip force leading to drop", "Contact with plate before release"],
  "recovery_strategy": ["Fallback to scanning if not visible", "Re-approach with tighter tolerance", "Reopen and regrasp with adjusted pose", "Abort lower and lift slightly to reattempt place"],
  "assumptions": ["Although instruction says 'picking a grape', frames [5–8] indicate placement onto the plate; tree includes place + release accordingly.", "Frame_0 likely occurs after initial open-gripper step which may be off-camera."],
  "evaluation_notes": {
    "expected_success_criteria": ["Object visible and detected", "Object grasped (ObjectInGripper = true)", "Grapes released on plate", "End-effector safely retreated"],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"grape","timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"grape","offset_z":0.05,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "verify",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"grape","tolerance":0.005,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "grasp",
      "active_leaf": {"id":"CloseGripper","attrs":{"force":10,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "transfer",
      "active_leaf": {"id":"MoveDelta","attrs":{"axis":"z","dist":0.1,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"MoveTo","attrs":{"target":"plate_center","timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "place",
      "active_leaf": {"id":"LowerUntilContact","attrs":{"speed":"slow","max_depth":0.03,"force_threshold":10,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "place",
      "active_leaf": {"id":"OpenGripper","attrs":{"width":0.06,"timeout_ms":500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    }
  ]
}
