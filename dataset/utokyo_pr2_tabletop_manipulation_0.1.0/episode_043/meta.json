{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_043",
  "task_summary": "Fold the pink cloth by aligning the gripper, pressing the edge, pushing it inward to create a crease, wiping along the fold line, then retreating.",
  "task_long_description": {
    "overview": "A PR2 arm folds a pink cloth placed on a wooden table. The robot first ensures the cloth is visible, then approaches from above with an open gripper, aligns its yaw to the fold direction, and gently establishes contact. It performs a push of the cloth edge toward the center to start the fold and executes a line wipe along the intended crease to flatten it. The sequence favors gentle, precise motions and ends with a short retreat, leaving the folded cloth stable.",
    "preconditions": ["Cloth is on table and within reachable workspace", "Vision detects the cloth region", "Gripper is free and open"],
    "stepwise_plan": [
      "Verify visibility of the cloth; scan if not immediately visible.",
      "Detect the cloth region precisely.",
      "Open gripper and move above the cloth at safe height.",
      "Yaw-align tool to the fold direction and approach with tight tolerance.",
      "Lower until gentle contact is detected.",
      "Push the cloth edge inward to initiate the fold.",
      "Wipe along the fold line with a straight pattern to crease/flatten.",
      "Retreat to a safe distance and pause briefly."
    ],
    "success_criteria": ["Cloth shows a visible fold with edges overlapped or aligned", "No slipping or dragging the entire cloth off the workspace", "Robot ends in a safe pose"],
    "failure_and_recovery": ["Perception fails: re-scan raster pattern", "Contact not established: repeat approach and lower", "Fold not formed: repeat push with same parameters", "Excess movement: retreat and re-approach"],
    "termination": "Terminate after successful wipe along fold line and retreat."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0","frame_8"],
    "scores": {
      "frame_0": 0.12,
      "frame_1": 0.34,
      "frame_2": 0.56,
      "frame_3": 0.92,
      "frame_4": 0.28,
      "frame_5": 0.80,
      "frame_6": 0.49,
      "frame_7": 0.18,
      "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "Gripper is aligned near the cloth edge, indicating end of approach and imminent contact.",
        "predicts_next": "A push along the fold direction is expected next to initiate the crease.",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "folding a cloth",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": 0.005,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7","frame_8"],
  "objects": ["pink_cloth", "table", "pr2_gripper"],
  "objects_from_instruction": ["cloth"],
  "blackboard_keys": ["cloth", "fold_line", "cloth_edge"],
  "node_specs": [
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"cloth"},"description":"Checks if cloth is currently visible."},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"cloth","pattern":"raster","max_attempts":3,"timeout_ms":1500},"description":"Raster scan to find the cloth if not visible."},
    {"id":"DetectObject","type":"Action","ports":{"target":"cloth","timeout_ms":1200},"description":"Detect/segment cloth region."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.09,"timeout_ms":400},"description":"Ensure gripper is fully open for pushing/wiping."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"cloth","offset_z":0.03,"timeout_ms":1200},"description":"Move to pre-contact pose above cloth."},
    {"id":"SetTCPYaw","type":"Action","ports":{"yaw_deg":90},"description":"Align end-effector yaw to fold direction."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"cloth","tolerance":0.005,"timeout_ms":1200},"description":"Precisely approach with tight tolerance."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":0.02,"force_threshold":5.0,"timeout_ms":800},"description":"Lower gently until contact sensed."},
    {"id":"Push","type":"Action","ports":{"target":"cloth_edge","distance":0.1,"direction_deg":180,"timeout_ms":1500},"description":"Push edge inward to start fold."},
    {"id":"WipeArea","type":"Action","ports":{"area_id":"fold_line","pattern":"line","passes":2,"timeout_ms":1500},"description":"Wipe along fold to crease/flatten."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":800},"description":"Back off to a safe distance."},
    {"id":"Wait","type":"Action","ports":{"timeout_ms":400},"description":"Brief stabilization pause."}
  ],
  "tree_stats": {"nodes_total": 14, "actions": 11, "conditions": 1, "depth": 3},
  "failure_modes": ["Cloth not detected due to lighting", "Contact misses cloth edge", "Push drags entire cloth instead of folding", "Wipe overshoots and unfolds crease"],
  "recovery_strategy": ["Re-run raster scan", "Re-approach with same tolerance", "Repeat push at same distance", "Retreat then re-wipe"],
  "assumptions": ["Frames show a push/press fold rather than a lift-and-place fold; BT reflects this with Push/Wipe instead of grasping."],
  "evaluation_notes": {
    "expected_success_criteria": ["Visible crease and reduced cloth footprint", "Robot ends in retreat pose"],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"IsObjectVisible","attrs":{}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "approach",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"tolerance":0.005,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "verify",
      "active_leaf": {"id":"LowerUntilContact","attrs":{"speed":"slow","timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"Push","attrs":{"distance":0.1,"direction_deg":180,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "transfer",
      "active_leaf": {"id":"WipeArea","attrs":{"pattern":"line","passes":2,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "transfer",
      "active_leaf": {"id":"WipeArea","attrs":{"pattern":"line","passes":2,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    }
  ]
}
