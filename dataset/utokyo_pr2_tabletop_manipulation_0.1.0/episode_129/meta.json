{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_129",
  "task_summary": "Detect, grasp, and move a grape cluster from the tabletop to the center of the white plate, then release and retreat.",
  "task_long_description": {
    "overview": "A PR2-like manipulator must pick a grape cluster lying beside a white plate on a tabletop and place it onto the plate. The robot first perceives the target, opens the gripper, and approaches from above to compute a pinch-style grasp. After aligning, it executes the grasp, verifies the object is held, and lifts. It then moves above the plate, lowers gently until contact, releases the grapes, and retreats. The contact sheet shows approach near the grapes, transfer above the plate, placement, and final retreat.",
    "preconditions": [
      "Tabletop scene with grape cluster and empty plate visible",
      "Gripper free and operational",
      "Collision model of table and plate available",
      "Camera providing top-down view"
    ],
    "stepwise_plan": [
      "Search/verify visibility of grape cluster.",
      "Open gripper and move above target.",
      "Compute grasp pose (pinch) and align precisely.",
      "Pick and confirm object in gripper.",
      "Retreat and move above plate center.",
      "Lower until gentle contact with plate.",
      "Open gripper to place grapes.",
      "Retreat and wait briefly."
    ],
    "success_criteria": [
      "Grapes securely grasped before transfer",
      "Grapes released onto plate center",
      "No collision with plate rim or table",
      "End-effector retreats to a safe pose"
    ],
    "failure_and_recovery": [
      "Target not visible → scan raster up to 3 attempts",
      "Grasp unstable → recompute grasp and retry pick",
      "Placement contact not detected → lower slightly again within limits",
      "Object dropped during transfer → re-detect and repeat from approach"
    ],
    "termination": "Terminate after successful release on plate and final retreat wait completes."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0", "frame_8"],
    "scores": {
      "frame_0": 0.12,
      "frame_1": 0.34,
      "frame_2": 0.56,
      "frame_3": 0.92,
      "frame_4": 0.28,
      "frame_5": 0.80,
      "frame_6": 0.49,
      "frame_7": 0.18,
      "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "first stable contact and alignment cue visible",
        "predicts_next": "push actuation expected; confirms goal direction",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "picking a grape",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7", "frame_8"],
  "objects": ["grape_cluster","plate","table","robot_arm","gripper"],
  "objects_from_instruction": ["grape"],
  "blackboard_keys": ["grasp_grape"],
  "node_specs": [
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"grape_cluster"},"description":"Checks if the grape cluster is visible."},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"grape_cluster","pattern":"raster","max_attempts":3,"timeout_ms":1500},"description":"Raster scan to locate the grapes if not immediately visible."},
    {"id":"DetectObject","type":"Action","ports":{"target":"grape_cluster","timeout_ms":1200},"description":"Run detector to localize grapes."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.06,"timeout_ms":500},"description":"Prepare gripper for grasp."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"grape_cluster","offset_z":0.05,"timeout_ms":1200},"description":"Move to pre-grasp above grapes."},
    {"id":"ComputeGraspPose","type":"Action","ports":{"target":"grape_cluster","strategy":"pinch","result_key":"grasp_grape"},"description":"Compute a pinch grasp for grapes."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"grape_cluster","tolerance":0.005,"timeout_ms":1200},"description":"Fine approach and alignment to grasp pose."},
    {"id":"Pick","type":"Action","ports":{"grasp_key":"grasp_grape","timeout_ms":1500},"description":"Close gripper along computed grasp to pick."},
    {"id":"ObjectInGripper","type":"Condition","ports":{"target":"grape_cluster"},"description":"Verify the grapes are held."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":800},"description":"Lift up after grasp/place."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"plate_center","offset_z":0.06,"timeout_ms":1200},"description":"Move above the plate center."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":0.05,"force_threshold":10,"timeout_ms":1200},"description":"Lower gently until contact with plate."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.06,"timeout_ms":500},"description":"Release grapes on plate."},
    {"id":"Wait","type":"Action","ports":{"timeout_ms":400},"description":"Short stabilization pause after retreat."}
  ],
  "tree_stats": {"nodes_total": 17, "actions": 13, "conditions": 2, "depth": 3},
  "failure_modes": [
    "Grapes not detected due to glare or occlusion",
    "Pinch grasp slips on smooth grapes",
    "Collision with plate rim during placement",
    "Early release before above-plate position"
  ],
  "recovery_strategy": [
    "Invoke raster scan and re-detect",
    "Recompute grasp and retry pick",
    "Increase pre-place height then lower again",
    "If dropped, re-localize and repeat sequence"
  ],
  "assumptions": [
    "Instruction says 'picking a grape' but frames show moving a small grape cluster onto the plate; tree follows visual evidence.",
    "Plate center is a symbolic target available to the controller."
  ],
  "evaluation_notes": {
    "expected_success_criteria": ["Grapes end on plate; gripper empty; no collisions; robot in safe pose"],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"grape_cluster","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"grape_cluster","offset_z":0.05,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "verify",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"grape_cluster","tolerance":0.005,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "grasp",
      "active_leaf": {"id":"Pick","attrs":{"grasp_key":"grasp_grape","timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "transfer",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"plate_center","offset_z":0.06,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "place",
      "active_leaf": {"id":"LowerUntilContact","attrs":{"speed":"slow","max_depth":0.05,"force_threshold":10,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "place",
      "active_leaf": {"id":"OpenGripper","attrs":{"width":0.06,"timeout_ms":500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Wait","attrs":{"timeout_ms":400}},
      "active_path_ids": []
    }
  ]
}
