{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_186",
  "task_summary": "Detect, grasp, and place a bread roll from the tabletop onto a nearby plate using a side grasp, then retreat.",
  "task_long_description": {
    "overview": "A PR2 manipulator interacts on a tabletop with a small plate and a single bread roll. The robot must perceive the bread, pre-shape the gripper, compute a side-grasp pose, approach and align, execute the grasp, lift slightly, move to the plate, lower until contact, place the bread on the plate, release, and retreat. Visual evidence shows approach from the right, placement onto the plate, and a final retreat. Constraints include gentle contact on the plate and tight alignment near the rim.",
    "preconditions": [
      "Gripper is empty and operational",
      "Bread and plate are within reachable workspace",
      "Table area is clear of obstructions",
      "Camera provides view of bread for detection"
    ],
    "stepwise_plan": [
      "Check visibility or actively scan for the bread",
      "Detect bread and open gripper to pre-grasp width",
      "Compute side-grasp pose and move above bread",
      "Approach and align with tight tolerance",
      "Execute grasp and lift slightly",
      "Move toward the plate and descend until contact",
      "Place bread centered on plate, release, and retreat"
    ],
    "success_criteria": [
      "Bread rests stably on the plate after release",
      "No object slips during transfer",
      "End-effector retreats clear of the plate without collision"
    ],
    "failure_and_recovery": [
      "If not visible, scan in a spiral pattern until detected",
      "If contact occurs prematurely, retreat slightly and realign",
      "If grasp unstable, reopen and recompute grasp before retrying placement"
    ],
    "termination": "Terminate after bread is placed on the plate and the gripper has retreated to a safe distance."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0", "frame_8"],
    "scores": {
      "frame_0": 0.12,
      "frame_1": 0.34,
      "frame_2": 0.56,
      "frame_3": 0.92,
      "frame_4": 0.28,
      "frame_5": 0.80,
      "frame_6": 0.49,
      "frame_7": 0.18,
      "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "first stable contact and alignment cue visible",
        "predicts_next": "push actuation expected; confirms goal direction",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "picking a bread",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7", "frame_8"],
  "objects": ["bread", "plate", "table", "pr2_gripper"],
  "objects_from_instruction": ["bread"],
  "blackboard_keys": ["bread_grasp", "plate_center"],
  "node_specs": [
    {"id":"Sequence","type":"composite","ports":{},"description":"Root sequence executing perceive→grasp→place→retreat"},
    {"id":"Fallback","type":"composite","ports":{},"description":"Visibility check with active scan recovery"},
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"bread"},"description":"Checks if bread is visible"},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"bread","pattern":"spiral","max_attempts":3,"timeout_ms":1200},"description":"Active scan to find bread when not visible"},
    {"id":"DetectObject","type":"Action","ports":{"target":"bread","timeout_ms":1200},"description":"Run detector for bread localization"},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.09,"timeout_ms":800},"description":"Pre-shape gripper before grasp"},
    {"id":"ComputeGraspPose","type":"Action","ports":{"target":"bread","strategy":"side","result_key":"bread_grasp"},"description":"Compute side grasp pose"},
    {"id":"MoveAbove","type":"Action","ports":{"target":"bread","offset_z":0.05,"timeout_ms":1200},"description":"Move to pregrasp above bread"},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"bread","tolerance":0.005,"timeout_ms":1500},"description":"Align gripper tightly to grasp axis"},
    {"id":"Pick","type":"Action","ports":{"grasp_key":"bread_grasp","timeout_ms":1200},"description":"Execute grasp using computed pose"},
    {"id":"MoveDelta","type":"Action","ports":{"axis":"z","dist":0.1,"timeout_ms":800},"description":"Lift the grasped bread slightly"},
    {"id":"MoveTo","type":"Action","ports":{"target":"plate_center","timeout_ms":1500},"description":"Move above plate center"},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":0.05,"force_threshold":10,"timeout_ms":1200},"description":"Descend until plate contact sensed"},
    {"id":"PlaceAt","type":"Action","ports":{"pose_key":"plate_center","yaw_deg":0,"press_force":10,"timeout_ms":1200},"description":"Place bread onto plate center"},
    {"id":"OpenGripper_release","type":"Action","ports":{"width":0.09,"timeout_ms":800},"description":"Release bread on plate"},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":800},"description":"Retreat to safe position"}
  ],
  "tree_stats": {"nodes_total": 16, "actions": 13, "conditions": 1, "depth": 3},
  "failure_modes": ["Bread not detected", "Collision with plate rim during approach", "Unstable grasp causing slip", "Premature contact during descent"],
  "recovery_strategy": ["Active scan when not visible", "Re-align with tight tolerance then retry pick", "Reopen and recompute grasp if unstable", "Retreat slightly and re-approach if contact early"],
  "assumptions": ["Frames show a place-on-plate after grasp; instruction says 'picking a bread'—tree follows frames and logs this mismatch", "Side grasp is inferred from approach angle", "Exact plate pose key 'plate_center' is symbolic and assumed available"],
  "evaluation_notes": {
    "expected_success_criteria": ["Bread stably on plate and gripper clear", "No collisions and smooth retreat"],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"bread","timeout_ms":1200}},
      "active_path_ids": ["Sequence","DetectObject"]
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"bread","offset_z":0.05,"timeout_ms":1200}},
      "active_path_ids": ["Sequence","MoveAbove"]
    },
    {
      "frame": "frame_2",
      "phase": "verify",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"bread","tolerance":0.005,"timeout_ms":1500}},
      "active_path_ids": ["Sequence","ApproachAndAlign"]
    },
    {
      "frame": "frame_3",
      "phase": "grasp",
      "active_leaf": {"id":"OpenGripper","attrs":{"width":0.09,"timeout_ms":800}},
      "active_path_ids": ["Sequence","OpenGripper"]
    },
    {
      "frame": "frame_4",
      "phase": "grasp",
      "active_leaf": {"id":"Pick","attrs":{"grasp_key":"bread_grasp","timeout_ms":1200}},
      "active_path_ids": ["Sequence","Pick"]
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"MoveDelta","attrs":{"axis":"z","dist":0.1,"timeout_ms":800}},
      "active_path_ids": ["Sequence","MoveDelta"]
    },
    {
      "frame": "frame_6",
      "phase": "place",
      "active_leaf": {"id":"PlaceAt","attrs":{"pose_key":"plate_center","yaw_deg":0,"press_force":10,"timeout_ms":1200}},
      "active_path_ids": ["Sequence","PlaceAt"]
    },
    {
      "frame": "frame_7",
      "phase": "place",
      "active_leaf": {"id":"OpenGripper","attrs":{"width":0.09,"timeout_ms":800}},
      "active_path_ids": ["Sequence","OpenGripper"]
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": ["Sequence","Retreat"]
    }
  ]
}
