{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_004",
  "task_summary": "Perceive bread and plate, approach the bread from the right, align and yaw the TCP, then laterally push the bread onto the plate and retreat.",
  "task_long_description": {
    "overview": "A PR2 end-effector operates over a green mat with a small bread-like item and a white plate. The arm moves in from the right, aligns to the bread’s side, and performs a lateral push toward the plate so the bread ends up centered on the dish. The tree emphasizes robust perception with fallback scanning, tight alignment tolerance, fixed yaw for diagonal approach, and a bounded push distance. After the push, the robot verifies the bread is still visible and retreats to clear the workspace.",
    "preconditions": [
      "Workspace clear with plate fixed on mat",
      "Bread present within reachable area",
      "Camera provides visibility of bread and plate",
      "No obstacles along push path toward plate"
    ],
    "stepwise_plan": [
      "Detect bread; if missed, scan with a raster pattern.",
      "Detect plate; if missed, scan.",
      "Open gripper and move above the bread.",
      "Approach and align to the bread with tight tolerance.",
      "Set tool yaw to diagonal (225°) for left/down push.",
      "Push the bread 0.2 m toward the plate.",
      "Re-detect bread to confirm visibility on the plate.",
      "Retreat to a safe standoff."
    ],
    "success_criteria": [
      "Bread rests on the plate surface after the push",
      "No collision that displaces the plate",
      "End-effector retreats clear of objects"
    ],
    "failure_and_recovery": [
      "Perception failure: use ScanForTarget fallback",
      "Misalignment: re-run ApproachAndAlign",
      "Insufficient push: repeat Push with same direction",
      "Obstacle or unexpected contact: abort and Retreat"
    ],
    "termination": "Terminate when bread is detected after push and the robot has completed the retreat action."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0", "frame_8"],
    "scores": {
      "frame_0": 0.12,
      "frame_1": 0.34,
      "frame_2": 0.56,
      "frame_3": 0.92,
      "frame_4": 0.28,
      "frame_5": 0.80,
      "frame_6": 0.49,
      "frame_7": 0.18,
      "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "First clear contact and alignment of the gripper with the bread’s side.",
        "predicts_next": "A diagonal push toward the plate is imminent.",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "picking a bread",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7", "frame_8"],
  "objects": ["bread", "plate", "table_mat", "pr2_gripper"],
  "objects_from_instruction": ["bread"],
  "blackboard_keys": [],
  "node_specs": [
    {"id":"DetectObject","type":"Action","ports":{"target":"bread","timeout_ms":800},"description":"Find bread; fast perception pass."},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"bread","pattern":"raster","max_attempts":3,"timeout_ms":1500},"description":"Raster scan if initial bread detection fails."},
    {"id":"DetectObject","type":"Action","ports":{"target":"plate","timeout_ms":800},"description":"Detect plate for push direction awareness."},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"plate","pattern":"raster","max_attempts":3,"timeout_ms":1500},"description":"Fallback scan for plate."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.09,"timeout_ms":400},"description":"Ensure gripper is open before approach."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"bread","offset_z":0.05,"timeout_ms":1200},"description":"Move to a pre-push height over the bread."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"bread","tolerance":0.005,"timeout_ms":1200},"description":"Precise lateral approach to the bread’s side."},
    {"id":"SetTCPYaw","type":"Action","ports":{"yaw_deg":225},"description":"Yaw the tool to align with diagonal push path."},
    {"id":"Push","type":"Action","ports":{"target":"bread","distance":0.2,"direction_deg":225,"timeout_ms":1500},"description":"Execute lateral push toward the plate."},
    {"id":"DetectObject","type":"Action","ports":{"target":"bread","timeout_ms":800},"description":"Verify bread still visible after push."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":800},"description":"Back off to a safe distance."}
  ],
  "tree_stats": {"nodes_total": 14, "actions": 11, "conditions": 0, "depth": 3},
  "failure_modes": [
    "Bread not detected due to lighting/view",
    "Plate not detected; push direction uncertain",
    "End-effector misaligned causing slip",
    "Push too short or overshoot",
    "Unintended contact with plate rim"
  ],
  "recovery_strategy": [
    "Use ScanForTarget when detection fails",
    "Re-run ApproachAndAlign with same tolerance",
    "Repeat Push with same vector if bread not fully on plate",
    "Immediate Retreat if abnormal contact sensed"
  ],
  "assumptions": [
    "Frames show pushing bread onto plate rather than grasping; tree follows frames, not the instruction wording.",
    "Plate is static and provides a stable stop for pushing.",
    "Diagonal push direction (225°) matches visual motion from right toward plate."
  ],
  "evaluation_notes": {
    "expected_success_criteria": [
      "Bread ends on plate after the push",
      "No significant plate displacement",
      "Robot retreats without collisions"
    ],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"bread","timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"bread","offset_z":0.05,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "approach",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"bread","tolerance":0.005,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "verify",
      "active_leaf": {"id":"SetTCPYaw","attrs":{"yaw_deg":225}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "transfer",
      "active_leaf": {"id":"Push","attrs":{"target":"bread","distance":0.2,"direction_deg":225,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"Push","attrs":{"target":"bread","distance":0.2,"direction_deg":225,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "transfer",
      "active_leaf": {"id":"Push","attrs":{"target":"bread","distance":0.2,"direction_deg":225,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "place",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"bread","timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    }
  ]
}
