{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_050",
  "task_summary": "Locate the pink cloth, approach and orient the tool, press to make contact, push along the cloth edge to fold it over, then retreat and pause.",
  "task_long_description": {
    "overview": "A single robot arm folds a pink cloth on a wooden tabletop. The end-effector does not grasp; instead, it orients flat, makes gentle contact with the cloth near its edge, and executes a linear push to flip one side over the other, forming a fold. The sequence emphasizes alignment and controlled contact before a straight push. The final frames show the cloth neatly folded and the arm retracted.",
    "preconditions": ["Cloth visible on table", "Workspace clear of obstacles", "Arm has room to push left-to-right", "End-effector capable of planar contact"],
    "stepwise_plan": ["Detect the cloth", "Move above the cloth at safe height", "Yaw the tool to align push direction", "Approach and align to the edge", "Lower until contact is detected (gentle)", "Push along the edge to create the fold", "Retreat from the workspace", "Brief wait to stabilize"],
    "success_criteria": ["Cloth edge is flipped creating a visible fold", "No object displacement other than the cloth", "Arm ends clear of the cloth"],
    "failure_and_recovery": ["Perception fails → retry detection", "Misalignment → re-approach and realign", "Insufficient fold after push → repeat push with same path", "Excess friction → slightly increase approach depth (within limits)"],
    "termination": "Terminate after successful push and retreat with folded cloth visible."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_6","frame_2","frame_1","frame_4","frame_7","frame_0","frame_8"],
    "scores": {
      "frame_0": 0.14,
      "frame_1": 0.45,
      "frame_2": 0.60,
      "frame_3": 0.93,
      "frame_4": 0.38,
      "frame_5": 0.88,
      "frame_6": 0.74,
      "frame_7": 0.26,
      "frame_8": 0.12
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "End-effector aligned at the cloth edge; imminent contact.",
        "predicts_next": "Linear push is expected after alignment.",
        "uncertainty_reduction": "high"
      },
      "frame_5": {
        "now_evidence": "Clear pushing motion with cloth folding upward.",
        "predicts_next": "Continuation of push and fold completion.",
        "uncertainty_reduction": "high"
      },
      "frame_8": {
        "now_evidence": "Arm retracted; cloth appears folded.",
        "predicts_next": "Task termination.",
        "uncertainty_reduction": "medium"
      }
    }
  },
  "task_instruction": "folding a cloth",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7","frame_8"],
  "objects": ["cloth", "cloth_edge", "table", "robot_arm", "gripper"],
  "objects_from_instruction": ["cloth"],
  "blackboard_keys": [],
  "node_specs": [
    {"id":"DetectObject","type":"Action","ports":{"target":"cloth","timeout_ms":1200},"description":"Perceive the cloth on the table."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"cloth","offset_z":0.05,"timeout_ms":1500},"description":"Move to a safe pre-contact height above the cloth."},
    {"id":"SetTCPYaw","type":"Action","ports":{"yaw_deg":90},"description":"Orient tool yaw to align with push direction."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"cloth","tolerance":0.005,"timeout_ms":1200},"description":"Planar approach and alignment to cloth edge."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":0.02,"force_threshold":5.0,"timeout_ms":1500},"description":"Lower gently until surface contact is achieved."},
    {"id":"Push","type":"Action","ports":{"target":"cloth_edge","distance":0.1,"direction_deg":180,"timeout_ms":1500},"description":"Execute straight push to flip the cloth edge and form a fold."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":1200},"description":"Back away from the folded cloth."},
    {"id":"Wait","type":"Action","ports":{"timeout_ms":500},"description":"Pause for stability and observation."},
    {"id":"RetryUntilSuccessful","type":"Decorator","ports":{"num_attempts":3},"description":"Retry detection up to 3 times if it fails."},
    {"id":"Sequence","type":"Composite","ports":{},"description":"Linear orchestration of the folding routine."}
  ],
  "tree_stats": {"nodes_total": 10, "actions": 8, "conditions": 0, "depth": 3},
  "failure_modes": ["Cloth not detected", "Tool misaligned with cloth edge", "Contact not achieved (too high)", "Push distance/direction insufficient to fold", "Cloth bunches causing jam"],
  "recovery_strategy": ["Retry perception (decorator)", "Re-run ApproachAndAlign", "Slightly increase max_depth within limits", "Repeat Push once more if fold incomplete", "Abort and retreat if unexpected resistance"],
  "assumptions": ["Folding is done by pushing rather than grasping, consistent with frames.", "Push direction assumed leftward (180°) based on arm approach from right.", "Single-layer soft cloth with adequate friction; no grasp required."],
  "evaluation_notes": {
    "expected_success_criteria": ["Fold clearly visible after push", "Arm ends outside immediate cloth area", "No collisions with table borders"],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"cloth","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"cloth","offset_z":0.05,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "approach",
      "active_leaf": {"id":"SetTCPYaw","attrs":{"yaw_deg":90}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "verify",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"cloth","tolerance":0.005,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "verify",
      "active_leaf": {"id":"LowerUntilContact","attrs":{"speed":"slow","max_depth":0.02,"force_threshold":5.0,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"Push","attrs":{"target":"cloth_edge","distance":0.1,"direction_deg":180,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "transfer",
      "active_leaf": {"id":"Push","attrs":{"target":"cloth_edge","distance":0.1,"direction_deg":180,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Wait","attrs":{"timeout_ms":500}},
      "active_path_ids": []
    }
  ]
}
