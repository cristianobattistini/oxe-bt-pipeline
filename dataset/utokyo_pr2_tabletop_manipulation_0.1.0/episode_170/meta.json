{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_170",
  "task_summary": "Fold the pink cloth by approaching, contacting the surface, and pushing to create a crease, then settling and retreating.",
  "task_long_description": {
    "overview": "A robot arm must fold a pink cloth lying on a wooden tabletop. The arm approaches from the right, aligns over the cloth, makes gentle top-down contact, and executes a short push to create a fold. The motion appears contact-based (press-and-push) rather than a pinch grasp. The sequence emphasizes accurate alignment, low-speed descent to detect contact, and a straight push along the surface. After forming the fold, the arm pauses to let the cloth settle and then retreats to a safe height.",
    "preconditions": [
      "Cloth is on a flat, reachable workspace",
      "Robot has free workspace and calibrated camera",
      "End-effector is unobstructed and functional"
    ],
    "stepwise_plan": [
      "Verify/locate the cloth; scan if not visible",
      "Move above the cloth and refine alignment",
      "Set tool yaw appropriate for pushing direction",
      "Lower until contact with low force",
      "Push along the surface to fold the cloth",
      "Wait briefly to let the fold settle",
      "Retreat to a safe distance"
    ],
    "success_criteria": [
      "A visible crease/fold in the cloth",
      "No unwanted displacement off the workspace",
      "Robot safely retreats after the fold"
    ],
    "failure_and_recovery": [
      "Perception fails: trigger raster scan and re-detect",
      "Misalignment: re-run ApproachAndAlign",
      "Insufficient fold: perform a second push after re-contact"
    ],
    "termination": "End when the push is completed, the cloth is visibly folded, and the arm has retreated."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0","frame_8"],
    "scores": {
      "frame_0": 0.12,
      "frame_1": 0.34,
      "frame_2": 0.56,
      "frame_3": 0.92,
      "frame_4": 0.28,
      "frame_5": 0.80,
      "frame_6": 0.49,
      "frame_7": 0.18,
      "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "End-effector is precisely aligned above the cloth, indicating imminent contact.",
        "predicts_next": "Lowering to contact followed by a push is expected.",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "folding a cloth",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7","frame_8"],
  "objects": ["cloth", "table", "robot_arm", "workspace"],
  "objects_from_instruction": ["cloth"],
  "blackboard_keys": [],
  "node_specs": [
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"cloth"},"description":"Check if the cloth is currently visible."},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"cloth","pattern":"raster","max_attempts":3,"timeout_ms":1500},"description":"Raster scan to find the cloth if not immediately visible."},
    {"id":"DetectObject","type":"Action","ports":{"target":"cloth","timeout_ms":1200},"description":"Run detection to localize the cloth precisely."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"cloth","offset_z":0.02,"timeout_ms":1200},"description":"Move to a pre-contact height above the cloth."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"cloth","tolerance":0.005,"timeout_ms":1500},"description":"Refine lateral pose to align tool with push direction."},
    {"id":"SetTCPYaw","type":"Action","ports":{"yaw_deg":90},"description":"Rotate tool yaw to match the planned push orientation."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":0.02,"force_threshold":10,"timeout_ms":1200},"description":"Descend slowly until contact is detected."},
    {"id":"Push","type":"Action","ports":{"target":"cloth","distance":0.1,"direction_deg":180,"timeout_ms":1200},"description":"Execute a straight push to form the fold."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":800},"description":"Back off to a safe distance after the push."},
    {"id":"Wait","type":"Action","ports":{"timeout_ms":400},"description":"Brief pause to let the cloth settle."}
  ],
  "tree_stats": {"nodes_total": 12, "actions": 9, "conditions": 1, "depth": 3},
  "failure_modes": [
    "Cloth not detected due to glare or motion blur",
    "Contact not registered; tool too high",
    "Push direction too oblique causing slip",
    "Push distance too short to create a fold",
    "Cloth drifts off the intended area"
  ],
  "recovery_strategy": [
    "Re-run ScanForTarget then DetectObject",
    "Repeat ApproachAndAlign and LowerUntilContact",
    "Perform a second Push after re-contact with same parameters"
  ],
  "assumptions": [
    "Folding is achieved via a surface push rather than a pinch grasp (consistent with frames).",
    "Push direction assumed leftward (180°) from the camera viewpoint.",
    "Tool yaw of 90° aligns the end-effector for a lateral push along the cloth edge."
  ],
  "evaluation_notes": {
    "expected_success_criteria": [
      "Clear crease visible in the cloth after push",
      "Stable cloth pose with minimal drift",
      "Robot returns to a safe, non-contact state"
    ],
    "test_scenarios": ["happy path", "object_missing", "grasp_fail", "perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"IsObjectVisible","attrs":{"target":"cloth"}},
      "active_path_ids": ["Sequence","Fallback","IsObjectVisible"]
    },
    {
      "frame": "frame_1",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"cloth","timeout_ms":1200}},
      "active_path_ids": ["Sequence","DetectObject"]
    },
    {
      "frame": "frame_2",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"cloth","offset_z":0.02,"timeout_ms":1200}},
      "active_path_ids": ["Sequence","MoveAbove"]
    },
    {
      "frame": "frame_3",
      "phase": "approach",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"cloth","tolerance":0.005,"timeout_ms":1500}},
      "active_path_ids": ["Sequence","ApproachAndAlign"]
    },
    {
      "frame": "frame_4",
      "phase": "verify",
      "active_leaf": {"id":"LowerUntilContact","attrs":{"speed":"slow","max_depth":0.02,"force_threshold":10,"timeout_ms":1200}},
      "active_path_ids": ["Sequence","LowerUntilContact"]
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"Push","attrs":{"target":"cloth","distance":0.1,"direction_deg":180,"timeout_ms":1200}},
      "active_path_ids": ["Sequence","Push"]
    },
    {
      "frame": "frame_6",
      "phase": "place",
      "active_leaf": {"id":"Wait","attrs":{"timeout_ms":400}},
      "active_path_ids": ["Sequence","Wait"]
    },
    {
      "frame": "frame_7",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": ["Sequence","Retreat"]
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": ["Sequence","Retreat"]
    }
  ]
}
