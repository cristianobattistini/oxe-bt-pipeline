{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_169",
  "task_summary": "Perceive a grape, approach, grasp with a pinch, and (as seen in frames) place it onto the plate, then retreat.",
  "task_long_description": {
    "overview": "A PR2-style gripper interacts on a tabletop with a bunch of grapes and a small plate. The robot first ensures the grape target is visible, approaches from above for a precise pinch grasp, lifts, moves over the plate, places the grape(s) onto the plate, and retreats. Timing and tolerances are moderate; grasp stability is briefly verified before transfer. The contact sheet shows initial perception, approach to grapes, grasp near the bunch, motion over the plate, placement, and arm retraction.",
    "preconditions": ["Workspace clear around plate and grapes", "Robot homed and gripper operational", "Camera view of tabletop available", "Plate positioned on table"],
    "stepwise_plan": ["Detect or scan for grape target", "Open gripper", "Move above grape at safe offset", "Compute pinch grasp pose", "Approach and align within tight tolerance", "Execute pick using computed grasp", "Verify grape in gripper", "Move above plate", "Place at plate pose and release", "Retreat to a safe distance"],
    "success_criteria": ["Grape securely grasped", "Grape deposited on plate area", "No collisions with plate or table", "Robot ends in safe pose with open gripper"],
    "failure_and_recovery": ["Target not detected → perform spiral scan", "Misalignment during approach → retry approach/align", "Grasp fails or slips → recompute grasp and re-pick", "Placement drift → re-center above plate and place again"],
    "termination": "Terminate when the grape is on the plate and the robot has retreated to a safe distance."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0","frame_8"],
    "scores": {
      "frame_0": 0.12,
      "frame_1": 0.34,
      "frame_2": 0.56,
      "frame_3": 0.92,
      "frame_4": 0.28,
      "frame_5": 0.80,
      "frame_6": 0.49,
      "frame_7": 0.18,
      "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "first stable contact and alignment cue visible",
        "predicts_next": "push actuation expected; confirms goal direction",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "picking a grape",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7","frame_8"],
  "objects": ["grape", "plate", "table", "robot_gripper"],
  "objects_from_instruction": ["grape"],
  "blackboard_keys": ["grasp_grape", "on_plate"],
  "node_specs": [
    {"id":"DetectObject","type":"Action","ports":{"target":"grape","timeout_ms":800},"description":"Detect grape using perception."},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"grape","pattern":"spiral","max_attempts":3,"timeout_ms":1500},"description":"Fallback scan if initial detection fails."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.06,"timeout_ms":500},"description":"Prepare for grasp."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"grape","offset_z":0.02,"timeout_ms":1200},"description":"Pregrasp approach above grapes."},
    {"id":"ComputeGraspPose","type":"Action","ports":{"target":"grape","strategy":"pinch","result_key":"grasp_grape"},"description":"Compute pinch grasp pose for a grape."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"grape","tolerance":0.005,"timeout_ms":1200},"description":"Align end-effector precisely to grasp pose."},
    {"id":"Pick","type":"Action","ports":{"grasp_key":"grasp_grape","timeout_ms":1200},"description":"Execute pick according to computed grasp."},
    {"id":"ObjectInGripper","type":"Condition","ports":{"target":"grape"},"description":"Verify the grape is held."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"plate","offset_z":0.02,"timeout_ms":1200},"description":"Transfer above the plate."},
    {"id":"PlaceAt","type":"Action","ports":{"pose_key":"on_plate","yaw_deg":0,"press_force":10,"timeout_ms":1200},"description":"Place grape onto the plate."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.06,"timeout_ms":500},"description":"Release grape."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":800},"description":"Back off to a safe pose."}
  ],
  "tree_stats": {"nodes_total": 14, "actions": 11, "conditions": 1, "depth": 3},
  "failure_modes": ["Grape not detected", "Misalignment during approach", "Grape slips after grasp", "Collision with plate rim", "Placement off target"],
  "recovery_strategy": ["Use spiral ScanForTarget", "Recompute grasp and re-approach", "Repeat Pick after opening gripper", "Reposition over plate and re-place"],
  "assumptions": ["Although the instruction says 'picking a grape', frames clearly show pick-and-place onto a plate; tree includes placement to match evidence.", "Target is a single grape or small cluster approachable with a pinch grasp."],
  "evaluation_notes": {
    "expected_success_criteria": ["Grape detected", "Pick succeeds (ObjectInGripper true)", "Grape placed on plate", "Robot retreats safely"],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"grape","timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"grape","offset_z":0.02,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "approach",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"grape","tolerance":0.005,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "grasp",
      "active_leaf": {"id":"Pick","attrs":{"grasp_key":"grasp_grape","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "transfer",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"plate","offset_z":0.02,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"plate","offset_z":0.02,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "place",
      "active_leaf": {"id":"PlaceAt","attrs":{"pose_key":"on_plate","yaw_deg":0,"press_force":10,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    }
  ]
}
