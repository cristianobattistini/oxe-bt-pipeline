{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_049",
  "task_summary": "Fold the pink cloth by pushing its right edge toward the center to create a single crease, then press the fold and retract.",
  "task_long_description": {
    "overview": "A PR2 arm operates over a wooden table with a pink square cloth centered in view. The goal is to fold the cloth once by using the gripper’s side to push the right edge leftward, creating a neat crease. The robot first perceives the cloth, approaches above it, aligns to the right edge, sets a lateral yaw, makes gentle contact with the surface, executes a leftward push to flip half the cloth, briefly re-presses to set the crease, and finally retracts. No grasping is required; folding is achieved by contact and pushing.",
    "preconditions": [
      "Cloth placed flat on table within reachable workspace",
      "Robot arm homed and gripper unobstructed",
      "Camera view unobstructed; lighting adequate",
      "Table surface has sufficient friction to hold cloth after fold"
    ],
    "stepwise_plan": [
      "Detect cloth; if not visible, scan the area.",
      "Move above the cloth to a safe approach height.",
      "Set tool yaw for lateral edge push and align to the right edge.",
      "Lower until contact with table to establish stable contact.",
      "Push the right edge leftward to create the fold.",
      "Briefly press again to set the crease.",
      "Retreat to a safe height and pause."
    ],
    "success_criteria": [
      "Cloth appears folded once with a visible crease",
      "Final cloth footprint roughly half original width",
      "No excessive cloth drift beyond central area",
      "Arm safely retracted at end"
    ],
    "failure_and_recovery": [
      "Perception failure: fall back to scanning and retry detection",
      "Misalignment: re-approach and realign edge before pushing",
      "Insufficient contact: perform another lower-until-contact step",
      "Cloth shift during push: repeat push with adjusted start pose"
    ],
    "termination": "Terminate after the retreat and brief wait once a single fold is formed and the arm is clear."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0","frame_8"],
    "scores": {
      "frame_0": 0.12,
      "frame_1": 0.34,
      "frame_2": 0.56,
      "frame_3": 0.92,
      "frame_4": 0.28,
      "frame_5": 0.80,
      "frame_6": 0.49,
      "frame_7": 0.18,
      "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "first stable contact and alignment cue visible",
        "predicts_next": "push actuation expected; confirms goal direction",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "folding a cloth",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7","frame_8"],
  "objects": ["cloth","table","robot_arm","gripper","cloth_edge_right"],
  "objects_from_instruction": ["cloth"],
  "blackboard_keys": [],
  "node_specs": [
    {"id":"DetectObject","type":"Action","ports":{"target":"cloth","timeout_ms":1200},"description":"Detect the cloth; used with fallback to scanning."},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"cloth","pattern":"raster","max_attempts":3,"timeout_ms":1500},"description":"Raster scan to find cloth if initial detection fails."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"cloth","offset_z":0.06,"timeout_ms":800},"description":"Stage above the cloth at a safe height."},
    {"id":"SetTCPYaw","type":"Action","ports":{"yaw_deg":90},"description":"Orient tool for lateral push along the table x-axis."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"cloth_edge_right","tolerance":0.01,"timeout_ms":1200},"description":"Align to the cloth’s right edge with precise tolerance."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":0.02,"force_threshold":10,"timeout_ms":1200},"description":"Lower to make gentle contact with table before pushing."},
    {"id":"Push","type":"Action","ports":{"target":"cloth_edge_right","distance":0.1,"direction_deg":180,"timeout_ms":1200},"description":"Push right edge leftward to create the fold."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":0.01,"force_threshold":10,"timeout_ms":800},"description":"Re-press to set the crease after folding."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":800},"description":"Back off to a safe distance."},
    {"id":"Wait","type":"Action","ports":{"timeout_ms":400},"description":"Short pause to stabilize the scene."}
  ],
  "tree_stats": {"nodes_total": 12, "actions": 10, "conditions": 0, "depth": 4},
  "failure_modes": [
    "Cloth not detected due to glare or motion blur",
    "Tool yaw misaligned causing diagonal push",
    "Insufficient contact leading to cloth slip",
    "Over-push causing fold to overshoot center"
  ],
  "recovery_strategy": [
    "Use scan fallback when detection fails",
    "Re-align using ApproachAndAlign then retry push",
    "Repeat lower-until-contact before repeating push",
    "Reduce push distance and repeat if overshoot observed"
  ],
  "assumptions": [
    "Folding is achieved by pushing (not grasping), consistent with frames.",
    "Single fold along a vertical line by moving right edge leftward.",
    "Table frame defines direction_deg=180 as leftward relative to camera view."
  ],
  "evaluation_notes": {
    "expected_success_criteria": [
      "Single, clean crease with cloth width roughly halved",
      "Minimal translation of folded stack",
      "Safe final arm posture with no contact"
    ],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"cloth","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"cloth","offset_z":0.06,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "approach",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"cloth_edge_right","tolerance":0.01,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "verify",
      "active_leaf": {"id":"LowerUntilContact","attrs":{"speed":"slow","max_depth":0.02,"force_threshold":10,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "transfer",
      "active_leaf": {"id":"Push","attrs":{"target":"cloth_edge_right","distance":0.1,"direction_deg":180,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"Push","attrs":{"target":"cloth_edge_right","distance":0.1,"direction_deg":180,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "place",
      "active_leaf": {"id":"LowerUntilContact","attrs":{"speed":"slow","max_depth":0.01,"force_threshold":10,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Wait","attrs":{"timeout_ms":400}},
      "active_path_ids": []
    }
  ]
}
