{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_035",
  "task_summary": "Perceive a pink cloth, align tool, press to make contact, and push diagonally to fold the cloth, then pause and retreat.",
  "task_long_description": {
    "overview": "A PR2 arm manipulates a small pink cloth on a wooden table. The goal is to fold the cloth by pushing one edge toward the center. The robot first verifies visibility, approaches above the cloth, aligns the tool yaw for a straight fold, opens the gripper to act as a pusher, and lowers until contact with the cloth/table. It then executes a controlled diagonal push to crease/fold the cloth, briefly stabilizes, and retreats to a safe height. No grasping is performed; folding is achieved via press-and-push.",
    "preconditions": ["Workspace is clear around the cloth", "Cloth is on the table within reachable zone", "Robot has free space to retreat after push", "Camera view available for detection"],
    "stepwise_plan": ["If cloth not visible, scan raster to find it", "Detect cloth and move above with safe offset", "Set tool yaw to align with desired fold axis", "Approach and refine alignment with tight tolerance", "Open gripper to use fingers as a flat pusher", "Lower until contact is detected", "Push diagonally across the cloth to fold", "Wait briefly to settle", "Retreat to a safe distance"],
    "success_criteria": ["Cloth edge is displaced across itself forming a visible fold", "No object slips from workspace", "Robot ends in safe, non-contact pose"],
    "failure_and_recovery": ["Perception fails → perform raster scan again", "Misalignment during approach → repeat align step", "Insufficient contact → lower and retry push", "Cloth bunches or rotates → shorten push distance and re-align"],
    "termination": "Terminate when push completes, cloth remains folded, and the robot has retreated to a safe pose."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0","frame_8"],
    "scores": {
      "frame_0": 0.12,
      "frame_1": 0.34,
      "frame_2": 0.56,
      "frame_3": 0.92,
      "frame_4": 0.28,
      "frame_5": 0.80,
      "frame_6": 0.49,
      "frame_7": 0.18,
      "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "first stable contact and alignment cue visible",
        "predicts_next": "push actuation expected; confirms goal direction",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "folding a cloth",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7","frame_8"],
  "objects": ["cloth", "table", "robot_gripper"],
  "objects_from_instruction": ["cloth"],
  "blackboard_keys": [],
  "node_specs": [
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"cloth"},"description":"Checks if the cloth is visible."},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"cloth","pattern":"raster","max_attempts":3,"timeout_ms":1200},"description":"Raster scan to locate cloth if not visible."},
    {"id":"DetectObject","type":"Action","ports":{"target":"cloth","timeout_ms":800},"description":"Run detector to localize cloth."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"cloth","offset_z":0.08,"timeout_ms":1500},"description":"Move to a pregrasp height above the cloth."},
    {"id":"SetTCPYaw","type":"Action","ports":{"yaw_deg":90},"description":"Rotate tool to align with fold axis."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"cloth","tolerance":0.005,"timeout_ms":1200},"description":"Refine lateral alignment before contact."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.09,"timeout_ms":500},"description":"Open gripper to use as flat pusher."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":0.03,"force_threshold":5.0,"timeout_ms":800},"description":"Lower until contact with cloth/table."},
    {"id":"Push","type":"Action","ports":{"target":"cloth","distance":0.1,"direction_deg":225,"timeout_ms":1200},"description":"Diagonal push to create the fold."},
    {"id":"Wait","type":"Action","ports":{"timeout_ms":400},"description":"Let the cloth settle after folding."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":800},"description":"Back away to a safe pose."}
  ],
  "tree_stats": {"nodes_total": 13, "actions": 10, "conditions": 1, "depth": 3},
  "failure_modes": ["Cloth not detected", "Yaw misaligned causing skewed fold", "Insufficient contact leading to no fold", "Over-push moving cloth off target area"],
  "recovery_strategy": ["Re-run scan when visibility is false", "Repeat alignment with tight tolerance", "Lower again to re-establish contact", "Reduce push distance and reattempt"],
  "assumptions": ["Folding achieved via push (no grasp) based on frames", "Push direction set to 225° (down-left) due to camera frame ambiguity", "Single fold only; no multi-step refolding"],
  "evaluation_notes": {
    "expected_success_criteria": ["Edge of cloth visibly overlaps another part after push", "Robot ends non-contact", "No objects displaced undesirably"],
    "test_scenarios": ["happy path", "object_missing", "grasp_fail", "perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"cloth","timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"cloth","offset_z":0.08,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "verify",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"cloth","tolerance":0.005,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "transfer",
      "active_leaf": {"id":"LowerUntilContact","attrs":{"speed":"slow","max_depth":0.03,"force_threshold":5.0,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "transfer",
      "active_leaf": {"id":"Push","attrs":{"target":"cloth","distance":0.1,"direction_deg":225,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"Push","attrs":{"target":"cloth","distance":0.1,"direction_deg":225,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "place",
      "active_leaf": {"id":"Wait","attrs":{"timeout_ms":400}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    }
  ]
}
