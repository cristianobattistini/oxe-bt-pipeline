{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_017",
  "task_summary": "Detect the bread, plan a pinch grasp, approach, grasp it, lift, and retreat.",
  "task_long_description": {
    "overview": "A PR2 end-effector operates on a tabletop with a white plate and a bread-like food item on a green cloth. The robot must pick the bread. The plan performs perception, computes a pinch grasp, opens the gripper, approaches from above with a small vertical offset, aligns precisely, executes the pick, verifies the object is secured, lifts slightly, and retreats to clear the workspace. The white plate is a nearby obstacle that influences approach and lift.",
    "preconditions": [
      "Robot is homed and reachable workspace includes the bread",
      "Gripper operational and able to open to 0.09 m",
      "Camera provides visibility of the bread",
      "Tabletop is static; plate position fixed during the episode"
    ],
    "stepwise_plan": [
      "Detect the bread on the table.",
      "Ensure a grasp pose is available; otherwise compute a pinch grasp.",
      "Open gripper and move above the bread with small vertical offset.",
      "Approach and align with tight tolerance.",
      "Execute pick using the computed grasp key.",
      "Verify bread is in the gripper.",
      "Lift along z by 0.1 m.",
      "Retreat by 0.1 m to clear the plate."
    ],
    "success_criteria": [
      "Bread detected and a valid grasp pose exists",
      "Object securely held after closing (verification passes)",
      "End-effector lifts bread clear of the surface and plate",
      "Robot retreats without collisions"
    ],
    "failure_and_recovery": [
      "Perception failure: retried detection up to three times",
      "No grasp pose: compute grasp pose via pinch strategy",
      "Misalignment: reattempt approach and align with tight tolerance",
      "Slippage: if verification fails, reopen and recompute grasp"
    ],
    "termination": "Terminate when ObjectInGripper is true and the arm has lifted and retreated successfully."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0","frame_8"],
    "scores": {
      "frame_0": 0.12,
      "frame_1": 0.34,
      "frame_2": 0.56,
      "frame_3": 0.92,
      "frame_4": 0.28,
      "frame_5": 0.80,
      "frame_6": 0.49,
      "frame_7": 0.18,
      "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "Gripper is tightly aligned near the bread, suggesting imminent grasp.",
        "predicts_next": "Closing and lift are expected next; verifies the intended direction.",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "picking a bread",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7","frame_8"],
  "objects": ["bread", "white_plate", "table", "pr2_gripper"],
  "objects_from_instruction": ["bread"],
  "blackboard_keys": ["bread_grasp"],
  "node_specs": [
    {"id":"DetectObject","type":"Action","ports":{"target":"bread","timeout_ms":1200},"description":"Detect bread on the table; wrapped in retry."},
    {"id":"PoseAvailable","type":"Condition","ports":{"key":"bread_grasp"},"description":"Checks if a grasp pose key already exists."},
    {"id":"ComputeGraspPose","type":"Action","ports":{"target":"bread","strategy":"pinch","result_key":"bread_grasp"},"description":"Computes a pinch grasp for the bread and stores it."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.09,"timeout_ms":800},"description":"Prepare the gripper for grasping."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"bread","offset_z":0.05,"timeout_ms":1200},"description":"Move to a pregrasp above the bread."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"bread","tolerance":0.005,"timeout_ms":1500},"description":"Refine alignment before grasp."},
    {"id":"Pick","type":"Action","ports":{"grasp_key":"bread_grasp","timeout_ms":1500},"description":"Execute grasp using the computed pose."},
    {"id":"ObjectInGripper","type":"Condition","ports":{"target":"bread"},"description":"Verify that the bread is secured."},
    {"id":"MoveDelta","type":"Action","ports":{"axis":"z","dist":0.1,"timeout_ms":1200},"description":"Lift the grasped bread upward."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":1200},"description":"Retreat to clear surrounding objects."}
  ],
  "tree_stats": {"nodes_total": 13, "actions": 8, "conditions": 2, "depth": 3},
  "failure_modes": [
    "Bread not detected due to glare or occlusion",
    "Computed grasp collides with plate rim",
    "Insufficient closure leading to object slip",
    "Retreat path obstructed by the plate"
  ],
  "recovery_strategy": [
    "Retry detection (3 attempts)",
    "Recompute grasp with same key if pose missing",
    "Reopen gripper and realign before reattempting pick",
    "Abort retreat and lift further if near-collision detected"
  ],
  "assumptions": [
    "The orange item is the 'bread' referred to by the instruction.",
    "Task requires only picking, not placing; frames show lift above the plate.",
    "Approach is top-down to avoid the plate."
  ],
  "evaluation_notes": {
    "expected_success_criteria": [
      "ObjectInGripper becomes true after Pick",
      "Lift and retreat complete without contact with the plate"
    ],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"bread","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"bread","offset_z":0.05,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "approach",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"bread","tolerance":0.005,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "approach",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"bread","tolerance":0.005,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "grasp",
      "active_leaf": {"id":"Pick","attrs":{"grasp_key":"bread_grasp","timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "verify",
      "active_leaf": {"id":"ObjectInGripper","attrs":{"target":"bread"}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "transfer",
      "active_leaf": {"id":"MoveDelta","attrs":{"axis":"z","dist":0.1,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":1200}},
      "active_path_ids": []
    }
  ]
}
