{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_075",
  "task_summary": "Detect the pink cloth, approach and press to establish contact, push its edge to fold it over, then lift, pause to settle, and retreat.",
  "task_long_description": {
    "overview": "A PR2-like manipulator folds a pink cloth on a tabletop. The robot first localizes the cloth, approaches from above with a safe offset, aligns yaw to match the desired fold direction, makes gentle contact, and pushes along the edge to produce a single clean fold. After the push, the arm lifts slightly, allows the cloth to settle, and retreats out of the workspace. The sequence favors contact-based folding rather than grasping, suitable for flat fabrics where pinching may be unreliable.",
    "preconditions": ["Workspace is clear except for one pink cloth on the table", "Robot has free motion above the table", "Gripper able to press and slide on fabric", "Camera view of the cloth is available"],
    "stepwise_plan": [
      "Detect the cloth in the scene.",
      "Move above the cloth with a small vertical offset.",
      "Set end-effector yaw to align with fold direction.",
      "Lower until contact with the tabletop/cloth is detected.",
      "Fine-align to the cloth edge.",
      "Push the cloth edge leftward to create the fold.",
      "Lift back above the cloth.",
      "Wait briefly to let fabric settle.",
      "Retreat from the workspace."
    ],
    "success_criteria": ["Cloth appears folded into a compact shape", "No large wrinkles near the fold line", "Robot ends clear of the cloth"],
    "failure_and_recovery": [
      "Detection fails → retry detection up to three times.",
      "Contact not established → lower again or increase max depth slightly.",
      "Push slips or bunches cloth → re-align and repeat push.",
      "Unexpected obstacle → abort push and retreat."
    ],
    "termination": "Terminate after the retreat step once the cloth is folded and the arm is clear."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0", "frame_8"],
    "scores": {
      "frame_0": 0.12,
      "frame_1": 0.34,
      "frame_2": 0.56,
      "frame_3": 0.92,
      "frame_4": 0.28,
      "frame_5": 0.80,
      "frame_6": 0.49,
      "frame_7": 0.18,
      "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "first stable contact and alignment cue visible",
        "predicts_next": "push actuation expected; confirms goal direction",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "folding a cloth",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7", "frame_8"],
  "objects": ["pink_cloth", "table_top", "pr2_gripper"],
  "objects_from_instruction": ["cloth"],
  "blackboard_keys": [],
  "node_specs": [
    {"id":"DetectObject","type":"Action","ports":{"target":"cloth","timeout_ms":1200},"description":"Find the cloth before acting."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"cloth","offset_z":0.08,"timeout_ms":1200},"description":"Pre-grasp approach from above with a safe offset."},
    {"id":"SetTCPYaw","type":"Action","ports":{"yaw_deg":90},"description":"Orient end-effector to align with intended fold direction."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":0.05,"force_threshold":5.0,"timeout_ms":1500},"description":"Gently descend to make contact with the cloth/table."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"cloth_edge","tolerance":0.005,"timeout_ms":1200},"description":"Fine alignment to the fold edge."},
    {"id":"Push","type":"Action","ports":{"target":"cloth_edge","distance":0.1,"direction_deg":180,"timeout_ms":1200},"description":"Push leftward to create the fold."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"cloth","offset_z":0.10,"timeout_ms":1200},"description":"Lift away from fabric after push."},
    {"id":"Wait","type":"Action","ports":{"timeout_ms":400},"description":"Allow cloth to settle."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":800},"description":"Back off to clear the workspace."}
  ],
  "tree_stats": {"nodes_total": 11, "actions": 9, "conditions": 0, "depth": 3},
  "failure_modes": ["Object not detected", "No contact due to height misestimate", "Cloth bunching during push", "Yaw misalignment causing skewed fold"],
  "recovery_strategy": ["Retry detection (decorator)", "Re-align and reattempt push", "Increase approach depth slightly", "Abort and retreat if resistance spikes"],
  "assumptions": ["Frames show push-based folding; no grasping used", "Fold direction chosen leftward (180°) based on arm entering from right", "Single-fold objective inferred from final tidy square"],
  "evaluation_notes": {
    "expected_success_criteria": ["Cloth folded with clear edge and reduced footprint", "Robot ends at a safe standoff"],
    "test_scenarios": ["happy path", "object_missing", "grasp_fail", "perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"cloth","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"cloth","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"cloth","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "approach",
      "active_leaf": {"id":"SetTCPYaw","attrs":{"yaw_deg":90}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "verify",
      "active_leaf": {"id":"LowerUntilContact","attrs":{"speed":"slow","timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"Push","attrs":{"target":"cloth_edge","distance":0.1,"direction_deg":180,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "transfer",
      "active_leaf": {"id":"Push","attrs":{"target":"cloth_edge","distance":0.1,"direction_deg":180,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "place",
      "active_leaf": {"id":"Wait","attrs":{"timeout_ms":400}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    }
  ]
}
