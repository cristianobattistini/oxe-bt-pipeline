{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_068",
  "task_summary": "Perceive and grasp a grape cluster from the tabletop, then transport and release it onto the plate, finishing with a safe retreat.",
  "task_long_description": {
    "overview": "A PR2 arm interacts with a grape cluster on a wooden tabletop next to a white plate. The robot must locate the grapes, approach with an open gripper, compute a precise pinch grasp, and pick the cluster. After confirming grasp stability, it lifts, moves above the plate, and places the grapes at the plate center before releasing and retreating. The plan emphasizes gentle handling, short timeouts, and small alignment tolerance to avoid crushing the grapes and to keep motion efficient and safe near the plate.",
    "preconditions": ["Robot powered and homed", "Workspace clear of obstacles", "Gripper functional and calibrated", "Plate present on table", "Grapes visible or discoverable by scan"],
    "stepwise_plan": [
      "Check/obtain visibility of the grapes; scan if needed.",
      "Move above grapes and open gripper.",
      "Compute pinch grasp and align to target.",
      "Pick grapes and verify grasp stability.",
      "Lift and retreat to a safe height.",
      "Move above plate center and place.",
      "Open gripper to release; retreat."
    ],
    "success_criteria": ["Grapes end on plate center area", "No dropping during transfer", "No collision with plate or table", "Robot retreats to a safe pose"],
    "failure_and_recovery": ["Object not found → raster scan then detect", "Grasp slips → retry compute grasp and pick", "Collision/contact early → retreat and re-approach", "Placement misaligned → re-center above plate and place again"],
    "termination": "Terminate after successful release on plate and final retreat."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0","frame_8"],
    "scores": {
      "frame_0": 0.12,
      "frame_1": 0.34,
      "frame_2": 0.56,
      "frame_3": 0.92,
      "frame_4": 0.28,
      "frame_5": 0.80,
      "frame_6": 0.49,
      "frame_7": 0.18,
      "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "first stable contact and alignment cue visible",
        "predicts_next": "push actuation expected; confirms goal direction",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "picking a grape",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7","frame_8"],
  "objects": ["grape", "plate", "table", "robot_gripper"],
  "objects_from_instruction": ["grape"],
  "blackboard_keys": ["grasp_grape", "plate_center"],
  "node_specs": [
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"grape"},"description":"Checks if the grape is currently visible."},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"grape","pattern":"raster","max_attempts":3,"timeout_ms":1200},"description":"Raster scan to locate grapes if not visible."},
    {"id":"DetectObject","type":"Action","ports":{"target":"grape","timeout_ms":1200},"description":"Run detection to localize grape."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"grape","offset_z":0.05,"timeout_ms":1200},"description":"Move to pre-grasp position above grapes."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.06,"timeout_ms":500},"description":"Prepare gripper for grasp."},
    {"id":"ComputeGraspPose","type":"Action","ports":{"target":"grape","strategy":"pinch","result_key":"grasp_grape"},"description":"Plan pinch grasp for grapes."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"grape","tolerance":0.01,"timeout_ms":1200},"description":"Approach grapes and align to tolerance."},
    {"id":"Pick","type":"Action","ports":{"grasp_key":"grasp_grape","timeout_ms":1200},"description":"Execute the grasp and lift slightly."},
    {"id":"IsGraspStable","type":"Condition","ports":{},"description":"Confirm object is held securely."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":800},"description":"Lift/retreat to safe height."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"plate","offset_z":0.05,"timeout_ms":1200},"description":"Move above plate center."},
    {"id":"PlaceAt","type":"Action","ports":{"pose_key":"plate_center","yaw_deg":0,"press_force":10,"timeout_ms":1200},"description":"Place grapes at plate center."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.06,"timeout_ms":500},"description":"Release grapes onto plate."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":800},"description":"Final retreat from the plate."}
  ],
  "tree_stats": {"nodes_total": 17, "actions": 12, "conditions": 2, "depth": 4},
  "failure_modes": ["Object not detected", "Alignment fails causing missed grasp", "Grasp slips during lift", "Placement off-center or colliding with plate"],
  "recovery_strategy": ["Fallback scan then detect", "Recompute grasp and re-approach", "If unstable, open and retry pick", "Re-position above plate and re-place"],
  "assumptions": ["Although the instruction says 'picking a grape', the frames show transfer to a plate; the BT includes a place stage to match the visual evidence."],
  "evaluation_notes": {
    "expected_success_criteria": ["Grapes end on plate; no drop; clean retreat"],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"IsObjectVisible","attrs":{"target":"grape"}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"grape","offset_z":0.05,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "verify",
      "active_leaf": {"id":"ComputeGraspPose","attrs":{"target":"grape","strategy":"pinch","result_key":"grasp_grape"}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "grasp",
      "active_leaf": {"id":"Pick","attrs":{"grasp_key":"grasp_grape","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "transfer",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "place",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"plate","offset_z":0.05,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "place",
      "active_leaf": {"id":"PlaceAt","attrs":{"pose_key":"plate_center","yaw_deg":0,"press_force":10,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "place",
      "active_leaf": {"id":"OpenGripper","attrs":{"width":0.06,"timeout_ms":500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    }
  ]
}
