{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_158",
  "task_summary": "Fold the pink cloth by pushing one edge toward its center after aligning the end-effector, then pause to let the fabric settle and retreat.",
  "task_long_description": {
    "overview": "A PR2-style arm manipulates a pink cloth on a wooden tabletop. The goal is to create a fold by contacting an edge and pushing it toward the cloth’s interior. The robot first perceives the cloth, aligns the tool yaw with the cloth diagonal, approaches above an edge, verifies visibility, gently establishes contact, performs a short push to create the fold, allows the fabric to settle, and finally retreats. Movements are short and deliberate to avoid dragging the entire cloth or slipping.",
    "preconditions": ["Cloth lies flat on the table within reachable workspace", "Camera provides top-down view; object is detectable", "No other objects obstruct motion", "Gripper clear of previous items"],
    "stepwise_plan": [
      "Detect the cloth on the table",
      "Set tool yaw to align with the cloth’s diagonal",
      "Move above the target edge",
      "Verify the cloth is still visible",
      "Lower until gentle contact is detected",
      "Push along the edge to fold it inward",
      "Wait briefly to let fabric settle",
      "Retreat to a safe height/distance"
    ],
    "success_criteria": ["A visible crease/overlap indicating a fold", "Cloth remains on table and approximately in place", "End-effector safely clears the workspace at the end"],
    "failure_and_recovery": ["If detection fails, rescan the area", "If contact is not achieved, repeat approach with small offset", "If push slips, re-approach and push with adjusted yaw or distance"],
    "termination": "Terminate when the push completes and the robot retreats to a safe pose."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0", "frame_8"],
    "scores": {
      "frame_0": 0.12, "frame_1": 0.34, "frame_2": 0.56, "frame_3": 0.92,
      "frame_4": 0.28, "frame_5": 0.80, "frame_6": 0.49, "frame_7": 0.18, "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "First clear, near-contact alignment over the cloth edge is visible.",
        "predicts_next": "Indicates an imminent push action to create the fold.",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "folding a cloth",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7", "frame_8"],
  "objects": ["cloth", "cloth_edge", "cloth_corner", "table"],
  "objects_from_instruction": ["cloth"],
  "blackboard_keys": [],
  "node_specs": [
    {"id":"DetectObject","type":"Action","ports":{"target":"cloth","timeout_ms":1500},"description":"Detect the cloth on the table."},
    {"id":"SetTCPYaw","type":"Action","ports":{"yaw_deg":45},"description":"Align end-effector yaw with cloth diagonal."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"cloth_edge","offset_z":0.03,"timeout_ms":1200},"description":"Move above the target edge with a small height offset."},
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"cloth"},"description":"Verify the cloth is still in view."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":0.05,"force_threshold":5.0,"timeout_ms":1500},"description":"Descend gently until contact with the cloth surface."},
    {"id":"Push","type":"Action","ports":{"target":"cloth_edge","distance":0.1,"direction_deg":135,"timeout_ms":1200},"description":"Push the edge inward to create a fold."},
    {"id":"Wait","type":"Action","ports":{"timeout_ms":400},"description":"Let the fabric settle after the push."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":1200},"description":"Back away to a safe distance."}
  ],
  "tree_stats": {"nodes_total": 9, "actions": 7, "conditions": 1, "depth": 2},
  "failure_modes": ["Object not detected", "Contact not achieved due to height error", "Push causes cloth to slip entirely", "Yaw misalignment leads to off-direction push"],
  "recovery_strategy": ["Rescan/Detect again", "Re-approach with adjusted offset_z", "Repeat push with shorter distance or different direction_deg", "Realign yaw and try again"],
  "assumptions": ["Folding is achieved via pushing rather than grasping, consistent with frames", "Exact push direction (135°) approximates observed motion; table frame alignment is assumed."],
  "evaluation_notes": {
    "expected_success_criteria": ["Clearly visible crease/overlap", "Tool retreats safely", "Cloth remains on tabletop"],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"cloth","timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"cloth_edge","offset_z":0.03,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "approach",
      "active_leaf": {"id":"LowerUntilContact","attrs":{"speed":"slow","max_depth":0.05,"force_threshold":5.0,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "verify",
      "active_leaf": {"id":"IsObjectVisible","attrs":{"target":"cloth"}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "transfer",
      "active_leaf": {"id":"Push","attrs":{"target":"cloth_edge","distance":0.1,"direction_deg":135,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"Push","attrs":{"target":"cloth_edge","distance":0.1,"direction_deg":135,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "place",
      "active_leaf": {"id":"Wait","attrs":{"timeout_ms":400}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":1200}},
      "active_path_ids": []
    }
  ]
}
