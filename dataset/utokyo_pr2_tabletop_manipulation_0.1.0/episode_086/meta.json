{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_086",
  "task_summary": "Detect the pink cloth, approach with open gripper, make gentle contact, and push along an edge to fold it over, then pause and retreat.",
  "task_long_description": {
    "overview": "A PR2 arm manipulates a pink cloth on a wooden tabletop. The goal is to execute a single-hand fold using a push motion rather than a pinch grasp. The robot first perceives the cloth, approaches above with a set yaw, opens the gripper to present a flat contact surface, aligns precisely, lowers until contact is detected, and then pushes along a straight line to fold the cloth onto itself. After the push, the robot briefly waits to let the cloth settle and then retreats to clear the workspace. Timing and tolerances are conservative to avoid slipping.",
    "preconditions": [
      "Workspace clear except for the target cloth",
      "Cloth visible to the camera",
      "Gripper operational and able to stay open at width 0.09"
    ],
    "stepwise_plan": [
      "Detect and verify visibility of the cloth.",
      "Move above the cloth and set tool yaw to align with fold direction.",
      "Open gripper and align precisely over the fold edge.",
      "Lower until contact is detected.",
      "Push along the edge to fold the cloth.",
      "Wait briefly for cloth to settle.",
      "Retreat to a safe distance."
    ],
    "success_criteria": [
      "Cloth visibly folded along intended edge/axis",
      "No object collisions or loss of contact during push",
      "Arm ends in a safe, retracted pose"
    ],
    "failure_and_recovery": [
      "If cloth not detected: rescan before approaching.",
      "If contact not detected: lower again with smaller offset.",
      "If push stalls or slips: retreat slightly and re-align, then push again."
    ],
    "termination": "Terminate after retreat when the cloth is folded and the area is clear."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0","frame_8"],
    "scores": {
      "frame_0": 0.12,
      "frame_1": 0.34,
      "frame_2": 0.56,
      "frame_3": 0.92,
      "frame_4": 0.28,
      "frame_5": 0.80,
      "frame_6": 0.49,
      "frame_7": 0.18,
      "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "first stable contact and alignment cue visible",
        "predicts_next": "push actuation expected; confirms goal direction",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "folding a cloth",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": 0.01,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7","frame_8"],
  "objects": ["pink_cloth", "table", "pr2_gripper"],
  "objects_from_instruction": ["cloth"],
  "blackboard_keys": [],
  "node_specs": [
    {"id":"DetectObject","type":"Action","ports":{"target":"cloth","timeout_ms":1200},"description":"Detect the cloth in the scene."},
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"cloth"},"description":"Verify that the cloth is visible before approaching."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"cloth","offset_z":0.05,"timeout_ms":1500},"description":"Move above the cloth to a safe pre-contact height."},
    {"id":"SetTCPYaw","type":"Action","ports":{"yaw_deg":90},"description":"Align end-effector yaw with fold direction."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.09,"timeout_ms":500},"description":"Present a flat surface for pushing the cloth."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"cloth","tolerance":0.01,"timeout_ms":1200},"description":"Fine alignment over intended fold edge."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":0.03,"force_threshold":10.0,"timeout_ms":1200},"description":"Lower until contact is detected."},
    {"id":"ContactDetected","type":"Condition","ports":{"force_threshold":10.0},"description":"Confirm contact before pushing."},
    {"id":"Push","type":"Action","ports":{"target":"cloth_edge","distance":0.1,"direction_deg":180,"timeout_ms":1500},"description":"Push along a straight line to fold the cloth."},
    {"id":"Wait","type":"Action","ports":{"timeout_ms":400},"description":"Let the cloth settle after the fold."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":800},"description":"Back away to a safe distance."}
  ],
  "tree_stats": {"nodes_total": 12, "actions": 9, "conditions": 2, "depth": 2},
  "failure_modes": [
    "Cloth not detected due to lighting or pose",
    "Misalignment causes off-axis push",
    "Insufficient contact leading to slip",
    "Push distance too short to complete fold"
  ],
  "recovery_strategy": [
    "Rescan and redetect the cloth; re-enter approach.",
    "Adjust yaw and re-align with ApproachAndAlign.",
    "Re-lower to regain contact then retry Push.",
    "Increase push distance within allowed range if fold incomplete."
  ],
  "assumptions": [
    "Frames show a push-based fold with the gripper open; no pinch grasp required.",
    "Fold axis assumed to align with yaw=90 and push direction 180; exact world axes are inferred from table orientation.",
    "Single pass push completes the fold; no multi-pass needed."
  ],
  "evaluation_notes": {
    "expected_success_criteria": [
      "Final image shows cloth area halved with visible overlap",
      "No collision with table edges or robot body",
      "Contact condition triggers before Push"
    ],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"cloth","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"cloth","offset_z":0.05,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "approach",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"cloth","tolerance":0.01,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "verify",
      "active_leaf": {"id":"ContactDetected","attrs":{"force_threshold":10.0}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "transfer",
      "active_leaf": {"id":"Push","attrs":{"target":"cloth_edge","distance":0.1,"direction_deg":180,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"Push","attrs":{"target":"cloth_edge","distance":0.1,"direction_deg":180,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "transfer",
      "active_leaf": {"id":"Push","attrs":{"target":"cloth_edge","distance":0.1,"direction_deg":180,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "place",
      "active_leaf": {"id":"Wait","attrs":{"timeout_ms":400}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    }
  ]
}
