{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_127",
  "task_summary": "Perceive a grape on a plate, approach with a top pinch grasp, close gently, lift slightly, verify hold, and retreat to a safe height.",
  "task_long_description": {
    "overview": "A PR2 gripper must pick a single grape from a small cluster resting on a plate atop a wooden table. The robot first ensures the grape is visible, then moves above it and computes a pinch grasp. It aligns precisely, lowers until contact is detected, closes the gripper with low force to avoid crushing, lifts slightly to clear the plate, verifies the object is secured, and retreats. The contact sheet shows the gripper moving in from the right, hovering over the plate, engaging near the grapes, then moving away.",
    "preconditions": [
      "Grapes present on plate within reachable workspace",
      "Camera extrinsics calibrated; detection functioning",
      "Gripper operational and cleared of objects",
      "No obstacles between robot and plate"
    ],
    "stepwise_plan": [
      "Open gripper and detect the grape target.",
      "If not immediately visible, retry detection.",
      "Move to a pre-grasp pose above the grape.",
      "Compute a pinch grasp and confirm pose availability.",
      "Approach and align with tight tolerance.",
      "Lower until contact with the plate/grape is sensed.",
      "Close gripper with low force and lift slightly.",
      "Verify the object is in the gripper and retreat to safety."
    ],
    "success_criteria": [
      "ObjectInGripper condition becomes true",
      "No collisions or sliding of nearby objects",
      "Retreat executed to a safe standoff"
    ],
    "failure_and_recovery": [
      "Perception failure: retry DetectObject up to 3 times",
      "Misalignment: re-approach using ApproachAndAlign",
      "Slippage after close: reopen, recompute grasp, and retry",
      "Excess contact force: reduce max_depth and reattempt"
    ],
    "termination": "Tree succeeds when the grape is detected, grasped, verified in gripper, and the robot retreats; it fails if retries are exhausted or grasp verification fails."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0", "frame_8"],
    "scores": {
      "frame_0": 0.12,
      "frame_1": 0.34,
      "frame_2": 0.56,
      "frame_3": 0.92,
      "frame_4": 0.28,
      "frame_5": 0.80,
      "frame_6": 0.49,
      "frame_7": 0.18,
      "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "first stable contact and alignment cue visible",
        "predicts_next": "push actuation expected; confirms goal direction",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "picking a grape",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7", "frame_8"],
  "objects": ["grape", "plate", "table", "pr2_gripper"],
  "objects_from_instruction": ["grape"],
  "blackboard_keys": ["grasp_grape"],
  "node_specs": [
    {"id":"OpenGripper","type":"Action","ports":{"width":0.06,"timeout_ms":800},"description":"Open gripper to minimal width for delicate grape picking."},
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"grape"},"description":"Quick visibility gate to skip redundant detection."},
    {"id":"DetectObject","type":"Action","ports":{"target":"grape","timeout_ms":800},"description":"Run detector for the grape target."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"grape","offset_z":0.05,"timeout_ms":1200},"description":"Pre-grasp hover above the grape."},
    {"id":"ComputeGraspPose","type":"Action","ports":{"target":"grape","strategy":"pinch","result_key":"grasp_grape"},"description":"Compute pinch grasp pose and store to blackboard."},
    {"id":"PoseAvailable","type":"Condition","ports":{"key":"grasp_grape"},"description":"Check that grasp pose is available."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"grasp_grape","tolerance":0.01,"timeout_ms":1500},"description":"Approach along the computed vector with tight tolerance."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":0.02,"force_threshold":10.0,"timeout_ms":1200},"description":"Descend gently until contact is sensed."},
    {"id":"CloseGripper","type":"Action","ports":{"force":10,"timeout_ms":800},"description":"Close with minimal force to avoid crushing."},
    {"id":"MoveDelta","type":"Action","ports":{"axis":"z","dist":0.05,"timeout_ms":800},"description":"Lift the object slightly to clear the plate."},
    {"id":"ObjectInGripper","type":"Condition","ports":{"target":"grape"},"description":"Verify successful pick."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":800},"description":"Back off to a safe pose."}
  ],
  "tree_stats": {"nodes_total": 15, "actions": 9, "conditions": 3, "depth": 5},
  "failure_modes": ["object not detected", "grasp pose invalid", "slip after close", "collision with plate", "excessive contact force"],
  "recovery_strategy": ["retry detection", "recompute grasp and realign", "reopen and reattempt with reduced force", "increase hover offset and approach again"],
  "assumptions": [
    "Instruction targets a single grape; frames show a small cluster on a plate. We treat 'grape' as a single-grape grasp from the cluster.",
    "Contact sheet does not clearly show lift-off; annotations assume a brief lift and retreat consistent with the final frames."
  ],
  "evaluation_notes": {
    "expected_success_criteria": ["ObjectInGripper true after CloseGripper and MoveDelta", "no displacement of plate", "successful retreat"],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"grape","timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"grape","offset_z":0.05,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "approach",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"grasp_grape","tolerance":0.01,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "verify",
      "active_leaf": {"id":"PoseAvailable","attrs":{"key":"grasp_grape"}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "grasp",
      "active_leaf": {"id":"LowerUntilContact","attrs":{"speed":"slow","max_depth":0.02,"force_threshold":10.0,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "grasp",
      "active_leaf": {"id":"CloseGripper","attrs":{"force":10,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "transfer",
      "active_leaf": {"id":"MoveDelta","attrs":{"axis":"z","dist":0.05,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    }
  ]
}
