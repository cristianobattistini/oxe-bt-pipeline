{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_106",
  "task_summary": "Detect and grasp a grape bunch, then place it onto the plate and retreat.",
  "task_long_description": {
    "overview": "The PR2 end-effector approaches a grape bunch on a tabletop near a white plate. The robot first opens the gripper, detects the grapes, moves to a safe pre-grasp height, aligns, lowers until contact, and grasps with low force to avoid squashing. After confirming a stable grasp, it lifts, moves over the plate, places the grapes at the plate center, opens the gripper to release, and retreats to a safe distance. Timing uses conservative bins; precision alignment is moderate.",
    "preconditions": [
      "Workspace clear with visible plate and grape bunch",
      "Robot homed; gripper operational and empty",
      "Camera provides view of target"
    ],
    "stepwise_plan": [
      "Open gripper and detect grape bunch",
      "Move above grapes and align",
      "Lower until contact and close gripper gently",
      "Verify grasp stability and lift",
      "Move to plate center and place grapes",
      "Open gripper and retreat"
    ],
    "success_criteria": [
      "Grapes securely grasped without damage",
      "Grapes released on the plate surface",
      "Robot ends in a safe, non-contact pose"
    ],
    "failure_and_recovery": [
      "Detection fails: retry detection up to three times",
      "Unstable grasp: reopen, re-approach, and retry",
      "Premature contact: retreat slightly and realign"
    ],
    "termination": "End when grapes are released on plate and the arm retreats to a safe offset."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0", "frame_8"],
    "scores": {
      "frame_0": 0.12, "frame_1": 0.34, "frame_2": 0.56, "frame_3": 0.92,
      "frame_4": 0.28, "frame_5": 0.80, "frame_6": 0.49, "frame_7": 0.18, "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "End-effector aligned above target near plate; initial contact imminent.",
        "predicts_next": "Lowering and gripper closure expected next.",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "picking a grape",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7", "frame_8"],
  "objects": ["grape_bunch","plate","table","robot_arm","gripper"],
  "objects_from_instruction": ["grape"],
  "blackboard_keys": [],
  "node_specs": [
    {"id":"OpenGripper","type":"Action","ports":{"width":"0.09","timeout_ms":"800"},"description":"Prepare for grasping by opening the gripper."},
    {"id":"DetectObject","type":"Action","ports":{"target":"grape","timeout_ms":"800"},"description":"Perception to localize the grape bunch."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"grape","offset_z":"0.05","timeout_ms":"1200"},"description":"Move to a pre-grasp height above grapes."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"grape","tolerance":"0.01","timeout_ms":"1200"},"description":"Align end-effector with target for grasp."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":"0.05","force_threshold":"10","timeout_ms":"1200"},"description":"Controlled lowering until contact feedback."},
    {"id":"CloseGripper","type":"Action","ports":{"force":"10","timeout_ms":"800"},"description":"Close gently to grasp grapes."},
    {"id":"IsGraspStable","type":"Condition","ports":{},"description":"Check if grasp is stable."},
    {"id":"Retreat","type":"Action","ports":{"distance":"0.1","timeout_ms":"800"},"description":"Lift/retreat after grasp."},
    {"id":"MoveTo","type":"Action","ports":{"target":"plate_center","timeout_ms":"1500"},"description":"Translate to the plate center."},
    {"id":"PlaceAt","type":"Action","ports":{"pose_key":"plate_center","yaw_deg":"0","press_force":"10","timeout_ms":"1200"},"description":"Place grapes onto the plate."},
    {"id":"OpenGripper","type":"Action","ports":{"width":"0.09","timeout_ms":"800"},"description":"Release grapes."},
    {"id":"Retreat","type":"Action","ports":{"distance":"0.1","timeout_ms":"800"},"description":"Back off to a safe pose."},
    {"id":"RetryUntilSuccessful","type":"Decorator","ports":{"num_attempts":"3"},"description":"Retry detection to handle transient perception failures."}
  ],
  "tree_stats": {"nodes_total": 13, "actions": 10, "conditions": 1, "depth": 4},
  "failure_modes": [
    "Object occluded or out of view",
    "Slip after closure leading to drop",
    "Collision with plate rim during approach"
  ],
  "recovery_strategy": [
    "Re-run detection (decorator) and re-approach",
    "Open gripper, increase alignment precision, retry",
    "Retreat slightly and re-align before lowering"
  ],
  "assumptions": [
    "Frames indicate pick-and-place onto a plate rather than only 'picking a grape'; BT follows frames and adds a place step.",
    "Target is a grape bunch; gentle force chosen to avoid crushing."
  ],
  "evaluation_notes": {
    "expected_success_criteria": [
      "Stable grasp confirmed before transfer",
      "Object released within plate boundary",
      "No collisions during retreat"
    ],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"grape","timeout_ms":800}},
      "active_path_ids": ["Sequence","RetryUntilSuccessful","DetectObject"]
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"grape","offset_z":0.05,"timeout_ms":1200}},
      "active_path_ids": ["Sequence","MoveAbove"]
    },
    {
      "frame": "frame_2",
      "phase": "approach",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"grape","tolerance":0.01,"timeout_ms":1200}},
      "active_path_ids": ["Sequence","ApproachAndAlign"]
    },
    {
      "frame": "frame_3",
      "phase": "verify",
      "active_leaf": {"id":"LowerUntilContact","attrs":{"speed":"slow","max_depth":0.05,"force_threshold":10,"timeout_ms":1200}},
      "active_path_ids": ["Sequence","LowerUntilContact"]
    },
    {
      "frame": "frame_4",
      "phase": "grasp",
      "active_leaf": {"id":"CloseGripper","attrs":{"force":10,"timeout_ms":800}},
      "active_path_ids": ["Sequence","CloseGripper"]
    },
    {
      "frame": "frame_5",
      "phase": "grasp",
      "active_leaf": {"id":"IsGraspStable","attrs":{}},
      "active_path_ids": ["Sequence","IsGraspStable"]
    },
    {
      "frame": "frame_6",
      "phase": "transfer",
      "active_leaf": {"id":"MoveTo","attrs":{"target":"plate_center","timeout_ms":1500}},
      "active_path_ids": ["Sequence","MoveTo"]
    },
    {
      "frame": "frame_7",
      "phase": "place",
      "active_leaf": {"id":"PlaceAt","attrs":{"pose_key":"plate_center","yaw_deg":0,"press_force":10,"timeout_ms":1200}},
      "active_path_ids": ["Sequence","PlaceAt"]
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": ["Sequence","Retreat"]
    }
  ]
}
