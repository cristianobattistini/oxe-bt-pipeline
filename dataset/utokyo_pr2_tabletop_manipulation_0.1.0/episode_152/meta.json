{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_152",
  "task_summary": "Detect the grape, approach and align, compute a pinch grasp, pick it gently, verify the grasp, and retreat from the plate area.",
  "task_long_description": {
    "overview": "A PR2-style gripper works over a table with a plate and a vertical cluster of grapes. The goal is to pick one grape from the cluster. The robot must first perceive the grape, move to a safe pre-grasp above the target, orient the tool, align precisely, compute a pinch grasp, close to pick, verify that the object is held, and retreat without disturbing the plate. Movements should be precise due to the small, delicate target and nearby dish.",
    "preconditions": ["Workspace clear of obstacles except plate and grape cluster", "Robot is homed and gripper operational", "Camera provides view of target area", "Plate is fixed on table"],
    "stepwise_plan": [
      "Open the gripper to a moderate width.",
      "Detect the grape target; retry up to three times if needed.",
      "Move to a pre-grasp above the grape.",
      "Set tool yaw and finely align to target.",
      "Compute a pinch grasp pose for the grape.",
      "Execute the pick using the computed grasp key.",
      "Verify the object is in the gripper.",
      "Retreat upward/back to clear the plate."
    ],
    "success_criteria": ["Grape is securely held in gripper", "No collision with plate or table", "Retreat to a safe clearance pose"],
    "failure_and_recovery": ["Perception failure → retry detection (decorator)", "Misalignment → repeat alignment step", "Weak grasp/slip → reopen and recompute grasp, then reattempt pick", "Unexpected contact with plate → retreat and realign"],
    "termination": "Tree completes after a verified grasp followed by a retreat motion."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0","frame_8"],
    "scores": {
      "frame_0": 0.12,
      "frame_1": 0.34,
      "frame_2": 0.56,
      "frame_3": 0.92,
      "frame_4": 0.28,
      "frame_5": 0.80,
      "frame_6": 0.49,
      "frame_7": 0.18,
      "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "first stable contact and alignment cue visible",
        "predicts_next": "push actuation expected; confirms goal direction",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "picking a grape",
  "instruction_to_ports": {
    "force": 10,
    "timeout_ms": 1200,
    "tolerance": 0.005,
    "retry_attempts": 3
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7","frame_8"],
  "objects": ["grape","plate","table","pr2_gripper"],
  "objects_from_instruction": ["grape"],
  "blackboard_keys": ["grasp_grape"],
  "node_specs": [
    {"id":"OpenGripper","type":"Action","ports":{"width":0.08,"timeout_ms":800},"description":"Open the gripper to prepare for grasp."},
    {"id":"DetectObject","type":"Action","ports":{"target":"grape","timeout_ms":1200},"description":"Perceive the grape in the workspace."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"grape","offset_z":0.05,"timeout_ms":1200},"description":"Move to a pre-grasp pose above the grape."},
    {"id":"SetTCPYaw","type":"Action","ports":{"yaw_deg":0},"description":"Orient the end-effector yaw for the grasp."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"grape","tolerance":0.005,"timeout_ms":1200},"description":"Precisely approach and center over the grape."},
    {"id":"ComputeGraspPose","type":"Action","ports":{"target":"grape","strategy":"pinch","result_key":"grasp_grape"},"description":"Compute a pinch grasp pose and save key."},
    {"id":"Pick","type":"Action","ports":{"grasp_key":"grasp_grape","timeout_ms":1500},"description":"Execute the grasp using the computed key."},
    {"id":"ObjectInGripper","type":"Condition","ports":{"target":"grape"},"description":"Check if the grape is held."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":800},"description":"Clear the plate by retreating."}
  ],
  "tree_stats": {"nodes_total": 11, "actions": 8, "conditions": 1, "depth": 4},
  "failure_modes": ["Grape not detected due to glare", "Collision with plate during approach", "Insufficient closing force leading to slip", "Pose estimation error causing missed grasp"],
  "recovery_strategy": ["Retry detection up to 3 times", "Re-align with tighter tolerance", "Reopen, recompute grasp, and re-pick", "Retreat and re-approach from a higher pre-grasp"],
  "assumptions": ["Frames show a grape cluster on a plate; the BT treats the target as a single grape.", "No placement after pick is depicted; task ends after verified grasp and retreat.", "Lighting reflections on the plate may affect detection."],
  "evaluation_notes": {
    "expected_success_criteria": ["Stable pinch grasp on a single grape", "No plate disturbance", "Successful retreat after grasp"],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "approach",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"tolerance":0.005,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "verify",
      "active_leaf": {"id":"SetTCPYaw","attrs":{"yaw_deg":0}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "grasp",
      "active_leaf": {"id":"ComputeGraspPose","attrs":{"strategy":"pinch"}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "grasp",
      "active_leaf": {"id":"Pick","attrs":{"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "transfer",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    }
  ]
}
