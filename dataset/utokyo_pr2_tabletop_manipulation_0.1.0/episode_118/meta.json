{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_118",
  "task_summary": "Perceive, grasp, lift, and place a bread item onto the plate, then retreat.",
  "task_long_description": {
    "overview": "A PR2 end-effector must pick a bread-like food item from a table mat and place it on a nearby small plate. The scene includes a plate, the bread, and a parallel-jaw gripper approaching from the right. The robot first verifies visual contact with the target, computes a pinch grasp, aligns precisely, closes the gripper, lifts the item, moves above the plate, gently lowers until contact, releases, and retreats. Timing and force parameters are conservative to avoid crushing or dropping food.",
    "preconditions": ["Workspace is clear around the bread and plate", "Camera provides view of bread and plate", "Gripper operational and calibrated", "Plate is stable on the mat"],
    "stepwise_plan": [
      "Open gripper and visually confirm bread; scan if not visible",
      "Detect bread and compute pinch grasp pose",
      "Move above and align to bread with tight tolerance",
      "Close gripper to grasp and verify stability",
      "Lift slightly and navigate above plate",
      "Lower until contact with plate surface",
      "Open gripper to release bread",
      "Retreat to a safe distance"
    ],
    "success_criteria": ["Bread securely grasped without deformation", "Bread placed resting on plate", "Gripper retreats without disturbing placement"],
    "failure_and_recovery": [
      "If bread not visible: execute spiral scan and retry detection",
      "If grasp unstable: reopen, realign, and recompute grasp",
      "If contact not detected on plate: reattempt lowering with limited depth"
    ],
    "termination": "Behavior ends after successful release on plate and retreat, or after action failure bubbles up."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0","frame_8"],
    "scores": {
      "frame_0": 0.12,
      "frame_1": 0.34,
      "frame_2": 0.56,
      "frame_3": 0.92,
      "frame_4": 0.28,
      "frame_5": 0.80,
      "frame_6": 0.49,
      "frame_7": 0.18,
      "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "First clear grasp moment: gripper encloses bread near plate edge.",
        "predicts_next": "Lift and transition above plate are expected immediately after closure.",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "picking a bread",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7","frame_8"],
  "objects": ["bread", "plate", "robot_gripper", "table_mat"],
  "objects_from_instruction": ["bread"],
  "blackboard_keys": ["bread_grasp"],
  "node_specs": [
    {"id":"OpenGripper","type":"Action","ports":{"width":0.09,"timeout_ms":800},"description":"Open jaws to a safe width before approach and for release."},
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"bread"},"description":"Check if bread is currently visible."},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"bread","pattern":"spiral","max_attempts":3,"timeout_ms":1500},"description":"Active scan to localize bread if not visible."},
    {"id":"DetectObject","type":"Action","ports":{"target":"bread","timeout_ms":1200},"description":"Run detector to get updated bread pose."},
    {"id":"ComputeGraspPose","type":"Action","ports":{"target":"bread","strategy":"pinch","result_key":"bread_grasp"},"description":"Compute pinch grasp pose and store to blackboard."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"bread","offset_z":0.03,"timeout_ms":1500},"description":"Move to pre-grasp height above the bread."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"bread","tolerance":0.005,"timeout_ms":1500},"description":"Refine alignment before grasp."},
    {"id":"CloseGripper","type":"Action","ports":{"force":20,"timeout_ms":1200},"description":"Close gripper to grasp bread."},
    {"id":"IsGraspStable","type":"Condition","ports":{},"description":"Verify grasp stability before lifting."},
    {"id":"MoveDelta","type":"Action","ports":{"axis":"z","dist":0.05,"timeout_ms":1200},"description":"Lift bread after grasp."},
    {"id":"DetectObject","type":"Action","ports":{"target":"plate","timeout_ms":1200},"description":"Detect plate pose for placement."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"plate","offset_z":0.05,"timeout_ms":1500},"description":"Move above plate to prepare for placement."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":0.1,"force_threshold":10,"timeout_ms":1500},"description":"Lower gently until contact with plate detected."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.09,"timeout_ms":800},"description":"Release bread onto plate."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":1200},"description":"Back away to a safe pose."}
  ],
  "tree_stats": {"nodes_total": 17, "actions": 13, "conditions": 2, "depth": 3},
  "failure_modes": ["Target not detected", "Poor alignment causes missed grasp", "Slippage during lift/transfer", "No contact detected on plate within max depth"],
  "recovery_strategy": ["Spiral scan then re-detect", "Re-open, recompute grasp, and realign", "Lower force, regrip with tighter alignment", "Retry lowering with smaller steps or re-target plate"],
  "assumptions": ["Instruction says 'picking a bread' but frames show pick-and-place to plate; BT follows frames, prioritizing placement after grasp."],
  "evaluation_notes": {
    "expected_success_criteria": ["Bread ends on plate, stationary", "No collisions with plate during release", "Gripper retreats cleanly"],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"bread","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"bread","offset_z":0.03,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "approach",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"bread","tolerance":0.005,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "grasp",
      "active_leaf": {"id":"CloseGripper","attrs":{"force":20,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "transfer",
      "active_leaf": {"id":"MoveDelta","attrs":{"axis":"z","dist":0.05,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"plate","offset_z":0.05,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "place",
      "active_leaf": {"id":"LowerUntilContact","attrs":{"speed":"slow","max_depth":0.1,"force_threshold":10,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "place",
      "active_leaf": {"id":"OpenGripper","attrs":{"width":0.09,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":1200}},
      "active_path_ids": []
    }
  ]
}
