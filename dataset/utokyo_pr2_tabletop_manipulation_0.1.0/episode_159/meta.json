{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_159",
  "task_summary": "Perceive a pink cloth, approach and align, make gentle contact, then push twice to fold the cloth over itself, and retreat to a safe height.",
  "task_long_description": {
    "overview": "A PR2 end-effector operates over a wooden tabletop with a pink cloth. The robot first perceives and localizes the cloth, approaches from above, aligns yaw to push along the fold direction, then lowers until contact is detected. A pair of pushing motions folds the cloth, after which the robot retreats upward and pauses. Movements are time-binned and distances are discrete where required by the node library. No grasping is used; folding is achieved via contact pushing.",
    "preconditions": [
      "Workspace clear except for the cloth",
      "Camera view of the cloth is unobstructed",
      "Controller can regulate contact force on the table surface",
      "Cloth lies approximately planar on the table"
    ],
    "stepwise_plan": [
      "Open the gripper and detect the cloth.",
      "Move above and align to the cloth with appropriate yaw.",
      "Lower until table contact; verify contact.",
      "Execute two push strokes to fold the cloth.",
      "Retreat and hover above the folded cloth; short wait."
    ],
    "success_criteria": [
      "Cloth appears folded (reduced footprint, visible crease)",
      "Robot ends at a safe clearance height",
      "No object slips or collisions outside intended contact"
    ],
    "failure_and_recovery": [
      "Perception failure: retry detection up to two times.",
      "Insufficient fold: repeat push cycle if crease not formed (operator-triggered extension).",
      "Unexpected slip or high force: abort push and retreat."
    ],
    "termination": "Terminate after retreat and wait once push cycles complete successfully."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0","frame_8"],
    "scores": {
      "frame_0": 0.12,
      "frame_1": 0.34,
      "frame_2": 0.56,
      "frame_3": 0.92,
      "frame_4": 0.28,
      "frame_5": 0.80,
      "frame_6": 0.49,
      "frame_7": 0.18,
      "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "Tool is aligned at the cloth edge with first solid contact visible.",
        "predicts_next": "Push actuation likely to begin from this pose to generate the fold.",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "folding a cloth",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": 2
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7","frame_8"],
  "objects": ["pink_cloth", "wood_table", "pr2_end_effector"],
  "objects_from_instruction": ["cloth"],
  "blackboard_keys": [],
  "node_specs": [
    {"id":"OpenGripper","type":"Action","ports":{"width":0.09,"timeout_ms":800},"description":"Ensure gripper is open before approach."},
    {"id":"DetectObject","type":"Action","ports":{"target":"cloth","timeout_ms":1200},"description":"Detect and localize the cloth on the table."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"cloth","offset_z":0.05,"timeout_ms":1200},"description":"Move above the cloth at safe height."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"cloth","tolerance":0.01,"timeout_ms":1200},"description":"Laterally align to the cloth edge."},
    {"id":"SetTCPYaw","type":"Action","ports":{"yaw_deg":90},"description":"Orient tool to push perpendicular to the fold line."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":0.03,"force_threshold":3.0,"timeout_ms":800},"description":"Lower until contact with table/cloth."},
    {"id":"ContactDetected","type":"Condition","ports":{"force_threshold":3.0},"description":"Verify contact before pushing."},
    {"id":"Push","type":"Action","ports":{"target":"cloth","distance":0.1,"direction_deg":180,"timeout_ms":1500},"description":"Push across the cloth to create the fold; repeated twice."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":800},"description":"Back off from the cloth after folding."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"cloth","offset_z":0.08,"timeout_ms":1200},"description":"Rise to a safe hover above the folded cloth."},
    {"id":"Wait","type":"Action","ports":{"timeout_ms":400},"description":"Brief settle after folding."}
  ],
  "tree_stats": {"nodes_total": 14, "actions": 10, "conditions": 1, "depth": 3},
  "failure_modes": [
    "Cloth not detected or mislocalized",
    "Tool not aligned causing slip",
    "Insufficient fold after first push",
    "Excess force leading to cloth drag without fold"
  ],
  "recovery_strategy": [
    "Retry perception (built-in).",
    "Re-align yaw and re-approach.",
    "Repeat push cycle if fold insufficient.",
    "Abort and retreat on abnormal force."
  ],
  "assumptions": [
    "Folding is achieved by pushing rather than grasping; frames show no grasp.",
    "Direction_deg=180 approximates leftward push relative to camera; exact frame convention is assumed.",
    "Single fold is the goal; no multi-step crease placement is required."
  ],
  "evaluation_notes": {
    "expected_success_criteria": [
      "Visible crease and reduced cloth footprint after two pushes",
      "End-effector safely above the table at termination"
    ],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"cloth","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"cloth","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"cloth","offset_z":0.05,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "approach",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"cloth","tolerance":0.01,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "verify",
      "active_leaf": {"id":"ContactDetected","attrs":{"force_threshold":3.0}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"Push","attrs":{"target":"cloth","distance":0.1,"direction_deg":180,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "transfer",
      "active_leaf": {"id":"Push","attrs":{"target":"cloth","distance":0.1,"direction_deg":180,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"cloth","offset_z":0.08,"timeout_ms":1200}},
      "active_path_ids": []
    }
  ]
}
