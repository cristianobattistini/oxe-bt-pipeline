{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_039",
  "task_summary": "Perceive, grasp a grape cluster gently, move above the plate, place it on the plate, release, and retreat.",
  "task_long_description": {
    "overview": "A PR2-style gripper operates on a tabletop with a grape cluster and a round plate. The robot must localize the grape, approach from above with an open gripper, compute a pinch grasp, and close with minimal force to avoid crushing. After confirming a stable grasp, it navigates above the plate and places the grape onto it, releases, and retreats. Visual alignment and gentle contact are emphasized due to the soft, irregular object. Timeouts and simple retries are used for robust perception.",
    "preconditions": ["Workspace is clear and reachable", "Camera provides view of table", "Plate present on table", "Grape is present", "Gripper functional and calibrated"],
    "stepwise_plan": ["Check or scan for grape visibility", "Detect grape precisely", "Open gripper", "Move above grape at small offset", "Compute pinch grasp and align", "Lower until contact and close gently", "Verify stable grasp", "Confirm plate visibility", "Move above plate and place", "Open gripper to release", "Retreat and wait briefly"],
    "success_criteria": ["Grape ends resting on the plate", "No visible crushing or dropping", "Gripper empty at end", "Robot safely retreated from workspace"],
    "failure_and_recovery": ["If grape not visible: raster scan with retries", "If contact not detected: lower again within limits", "If grasp unstable: reopen and reattempt compute+grasp", "If plate occluded: detect again before place"],
    "termination": "After release on plate and retreat completes without active faults."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0","frame_8"],
    "scores": {
      "frame_0": 0.12,
      "frame_1": 0.34,
      "frame_2": 0.56,
      "frame_3": 0.92,
      "frame_4": 0.28,
      "frame_5": 0.80,
      "frame_6": 0.49,
      "frame_7": 0.18,
      "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "First clear contact and alignment near the grape before closure.",
        "predicts_next": "Gripper closure and lift/transfer toward the plate are expected.",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "picking a grape",
  "instruction_to_ports": {
    "force": 10,
    "timeout_ms": 1200,
    "tolerance": 0.005,
    "retry_attempts": 3
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7","frame_8"],
  "objects": ["grape", "plate", "table", "pr2_gripper"],
  "objects_from_instruction": ["grape"],
  "blackboard_keys": ["grasp_grape", "plate_center"],
  "node_specs": [
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"grape"},"description":"Checks visibility of grape before scanning."},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"grape","pattern":"raster","max_attempts":3,"timeout_ms":1200},"description":"Raster scan to find grape."},
    {"id":"DetectObject","type":"Action","ports":{"target":"grape","timeout_ms":800},"description":"Detect precise pose of grape."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.06,"timeout_ms":500},"description":"Open gripper to a narrow aperture for small object."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"grape","offset_z":0.05,"timeout_ms":1500},"description":"Position above grape for top-down grasp."},
    {"id":"ComputeGraspPose","type":"Action","ports":{"target":"grape","strategy":"pinch","result_key":"grasp_grape"},"description":"Compute pinch grasp pose; store key."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"grape","tolerance":0.005,"timeout_ms":1500},"description":"Fine alignment before contact."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":0.03,"force_threshold":5.0,"timeout_ms":1200},"description":"Lower gently until tactile contact."},
    {"id":"CloseGripper","type":"Action","ports":{"force":10,"timeout_ms":800},"description":"Close with minimal force to avoid crushing."},
    {"id":"IsGraspStable","type":"Condition","ports":{},"description":"Verify object retained after closure."},
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"plate"},"description":"Confirm plate is visible before place."},
    {"id":"DetectObject","type":"Action","ports":{"target":"plate","timeout_ms":800},"description":"Detect plate pose if not visible."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"plate","offset_z":0.10,"timeout_ms":1500},"description":"Move above the plate for placement."},
    {"id":"PlaceAt","type":"Action","ports":{"pose_key":"plate_center","yaw_deg":0,"press_force":10.0,"timeout_ms":1200},"description":"Place grape onto plate center."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.08,"timeout_ms":500},"description":"Release object."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":1200},"description":"Back away from the plate."},
    {"id":"Wait","type":"Action","ports":{"timeout_ms":500},"description":"Short stabilization wait."}
  ],
  "tree_stats": {"nodes_total": 21, "actions": 14, "conditions": 3, "depth": 4},
  "failure_modes": ["Grape not detected/occluded", "Misalignment leading to miss-grasp", "Grape slips during transfer", "Plate not detected for placement", "Timeouts due to slow motion"],
  "recovery_strategy": ["Retry scan up to 3 times", "Reopen and recompute grasp", "Lower again with slow speed and minimal force", "Redetect plate then reattempt place", "Fallback to safe retreat on repeated failure"],
  "assumptions": ["Frames show a pick-and-place to the plate; instruction mentions only picking. We prioritize visual evidence and include the placement phase.", "Pinch grasp is appropriate; orientation yaw 0 suffices.", "Plate center is available as 'plate_center' pose key."],
  "evaluation_notes": {
    "expected_success_criteria": ["Object placed on plate; gripper empty; robot retreated; no drops/crushing"],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"grape","timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"grape","offset_z":0.05,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "verify",
      "active_leaf": {"id":"ComputeGraspPose","attrs":{"target":"grape","strategy":"pinch","result_key":"grasp_grape"}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "grasp",
      "active_leaf": {"id":"LowerUntilContact","attrs":{"speed":"slow","max_depth":0.03,"force_threshold":5.0,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "grasp",
      "active_leaf": {"id":"CloseGripper","attrs":{"force":10,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"plate","offset_z":0.10,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "place",
      "active_leaf": {"id":"PlaceAt","attrs":{"pose_key":"plate_center","yaw_deg":0,"press_force":10.0,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "place",
      "active_leaf": {"id":"OpenGripper","attrs":{"width":0.08,"timeout_ms":500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":1200}},
      "active_path_ids": []
    }
  ]
}
