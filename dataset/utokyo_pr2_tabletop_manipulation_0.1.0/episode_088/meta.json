{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_088",
  "task_summary": "Pick a grape (grape bunch) from the tabletop and place it onto the dish, then retreat.",
  "task_long_description": {
    "overview": "A PR2-style parallel gripper approaches a bunch of grapes situated on a wooden tabletop next to a white dish. The robot must visually locate the grapes, approach from above, align precisely, grasp using a gentle pinch, lift the grasped grapes, move above the dish, place them at its center, release, and retreat. The dish remains stationary throughout. Timing is moderate, with precise alignment near the grasp and above the dish to avoid collisions.",
    "preconditions": ["Workspace clear except dish and grapes", "Gripper operational and homed", "Camera view provides top-down visibility of grapes and dish", "Dish is reachable within arm workspace"],
    "stepwise_plan": ["Verify or scan for grapes", "Detect grapes and compute grasp pose (pinch)", "Open gripper and move above grapes", "Align and execute pick", "Verify grasp stability", "Move above dish", "Place at dish center and open gripper", "Retreat from workspace"],
    "success_criteria": ["Grapes end up on the dish center area", "No collisions with dish during placement", "Object no longer in gripper after release", "Arm returns to a safe height/pose"],
    "failure_and_recovery": ["Perception fails → spiral scan then re-detect", "Misalignment or slip → retry pick after re-align", "Placement collision risk → approach from above and keep offset_z", "Grasp unstable → re-open and recompute grasp"],
    "termination": "Terminate after successful release on dish and retreat executed."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0","frame_8"],
    "scores": {
      "frame_0": 0.12,
      "frame_1": 0.34,
      "frame_2": 0.56,
      "frame_3": 0.92,
      "frame_4": 0.28,
      "frame_5": 0.80,
      "frame_6": 0.49,
      "frame_7": 0.18,
      "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "Arm has lifted grapes and is translating toward the dish; alignment above the dish begins.",
        "predicts_next": "Approach to dish center followed by placement and release.",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "picking a grape",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7","frame_8"],
  "objects": ["grape_bunch", "dish", "tabletop", "robot_gripper"],
  "objects_from_instruction": ["grape"],
  "blackboard_keys": ["grasp_grape", "plate_center"],
  "node_specs": [
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"grape"},"description":"Checks if the grape target is currently visible."},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"grape","pattern":"spiral","max_attempts":3,"timeout_ms":1500},"description":"Actively scans the scene to locate grapes if not immediately visible."},
    {"id":"DetectObject","type":"Action","ports":{"target":"grape","timeout_ms":1200},"description":"Runs detection to localize the grape target."},
    {"id":"ComputeGraspPose","type":"Action","ports":{"target":"grape","strategy":"pinch","result_key":"grasp_grape"},"description":"Computes a pinch grasp pose and stores it to the blackboard."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.09,"timeout_ms":500},"description":"Opens gripper for approach or release."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"grape","offset_z":0.02,"timeout_ms":1200},"description":"Moves to a safe pregrasp above the grapes."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"grape","tolerance":0.005,"timeout_ms":1200},"description":"Precise approach and alignment before grasp."},
    {"id":"Pick","type":"Action","ports":{"grasp_key":"grasp_grape","timeout_ms":1200},"description":"Executes grasp using the computed grasp pose."},
    {"id":"IsGraspStable","type":"Condition","ports":{},"description":"Verifies that the grasp is stable before transfer."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"plate","offset_z":0.02,"timeout_ms":1500},"description":"Transfers the grasped object to a pre-place above the dish."},
    {"id":"PlaceAt","type":"Action","ports":{"pose_key":"plate_center","yaw_deg":0,"press_force":10.0,"timeout_ms":1200},"description":"Places object onto the dish center."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":800},"description":"Backs off to a safe pose after release."}
  ],
  "tree_stats": {"nodes_total": 15, "actions": 11, "conditions": 2, "depth": 3},
  "failure_modes": ["Grapes not detected", "Approach misaligned causes slip", "Object collides with dish rim", "Release incomplete leaving grapes in gripper"],
  "recovery_strategy": ["Spiral scan then re-detect", "Re-open, re-approach with tighter tolerance", "Increase offset_z then lower carefully", "Reopen gripper and lightly shake via micro-moves"],
  "assumptions": ["Frames show a grape bunch rather than a single grape; instruction says 'a grape'. We assume picking up part of the bunch and placing on the dish as seen in frames. Targets 'grape' and 'plate' are symbolic handles mapped to the visible objects."],
  "evaluation_notes": {
    "expected_success_criteria": ["Object visible on dish at end", "No object in gripper after OpenGripper", "No collisions observed"],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"grape","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"grape","offset_z":0.02,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "verify",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"grape","tolerance":0.005,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "grasp",
      "active_leaf": {"id":"Pick","attrs":{"grasp_key":"grasp_grape","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "transfer",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"plate","offset_z":0.02,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "place",
      "active_leaf": {"id":"PlaceAt","attrs":{"pose_key":"plate_center","yaw_deg":0,"press_force":10.0,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "place",
      "active_leaf": {"id":"OpenGripper","attrs":{"width":0.09,"timeout_ms":500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    }
  ]
}
