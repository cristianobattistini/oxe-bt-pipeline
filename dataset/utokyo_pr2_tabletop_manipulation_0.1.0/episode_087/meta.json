{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_087",
  "task_summary": "Perceive, approach, and grasp a single grape with a parallel gripper, then lift and retreat from the plate area.",
  "task_long_description": {
    "overview": "A PR2 arm must pick a single grape from a small cluster near a white plate on a wooden tabletop. The robot first ensures the grape is visible, scanning if necessary, then computes a pinch grasp. It moves to a pre-grasp above the grape, aligns precisely, lowers until contact, and closes the gripper with low force to avoid crushing. After confirming stability, it lifts the grape and retreats away from the plate, leaving the scene safe and collision-free.",
    "preconditions": ["Workspace clear except for plate and grape(s)", "Arm reachable to target", "Gripper operational and initially open", "Camera provides view of tabletop"],
    "stepwise_plan": [
      "Open gripper and localize the grape; scan if not visible.",
      "Compute a pinch grasp pose for the grape.",
      "Move above the grape and align to the grasp pose.",
      "Lower until contact and close gripper with gentle force.",
      "Verify stability, lift vertically, and retreat."
    ],
    "success_criteria": ["A single grape is securely held in the gripper", "No collision with plate or table", "Robot retreats to a safe pose"],
    "failure_and_recovery": ["If target not visible: scan again up to bounded retries", "If contact not detected: repeat approachâ€“lower", "If grasp unstable: reopen and reattempt with recomputed pose"],
    "termination": "Terminate when the grape is grasped (stable) and the arm has retreated to a safe distance."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0", "frame_8"],
    "scores": {
      "frame_0": 0.12,
      "frame_1": 0.34,
      "frame_2": 0.56,
      "frame_3": 0.92,
      "frame_4": 0.28,
      "frame_5": 0.80,
      "frame_6": 0.49,
      "frame_7": 0.18,
      "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "first stable contact and alignment cue visible",
        "predicts_next": "push actuation expected; confirms goal direction",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "picking a grape",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7", "frame_8"],
  "objects": ["grape", "grape_cluster", "plate", "robot_gripper", "table"],
  "objects_from_instruction": ["grape"],
  "blackboard_keys": ["grasp_grape"],
  "node_specs": [
    {"id":"OpenGripper","type":"Action","ports":{"width":"0.09","timeout_ms":"500"},"description":"Prepare gripper by opening to safe width."},
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"grape"},"description":"Checks if the grape is visible."},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"grape","pattern":"raster","max_attempts":"3","timeout_ms":"800"},"description":"Active scan to locate grape if not immediately visible."},
    {"id":"DetectObject","type":"Action","ports":{"target":"grape","timeout_ms":"800"},"description":"Refined detection/localization of the grape."},
    {"id":"ComputeGraspPose","type":"Action","ports":{"target":"grape","strategy":"pinch","result_key":"grasp_grape"},"description":"Compute pinch grasp pose and store on blackboard."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"grape","offset_z":"0.02","timeout_ms":"1200"},"description":"Pre-grasp positioning above the grape."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"grasp_grape","tolerance":"0.005","timeout_ms":"1200"},"description":"Align TCP to the grasp pose with tight tolerance."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":"0.02","force_threshold":"10","timeout_ms":"800"},"description":"Controlled descent to contact with the grape."},
    {"id":"CloseGripper","type":"Action","ports":{"force":"10","timeout_ms":"800"},"description":"Close with low force to avoid crushing."},
    {"id":"IsGraspStable","type":"Condition","ports":{},"description":"Checks for stable grasp after closure."},
    {"id":"MoveDelta","type":"Action","ports":{"axis":"z","dist":"0.1","timeout_ms":"800"},"description":"Lift the grape vertically."},
    {"id":"Retreat","type":"Action","ports":{"distance":"0.1","timeout_ms":"1200"},"description":"Retreat to a safe distance from the plate."}
  ],
  "tree_stats": {"nodes_total": 15, "actions": 10, "conditions": 2, "depth": 4},
  "failure_modes": ["Target not detected", "Misalignment leading to missed grasp", "Insufficient closure force causing drop", "Collision with plate during approach"],
  "recovery_strategy": ["Retry scan within bounded attempts", "Recompute grasp pose and re-approach", "Adjust force within safe bounds and retry", "Retreat and re-plan approach above plate rim"],
  "assumptions": ["Frames suggest a single grape is grasped from near a plate; instruction aligns with visual evidence. Plate is a passive obstacle; no explicit placement is required."],
  "evaluation_notes": {
    "expected_success_criteria": ["Grape held after lift", "No collisions with plate", "Arm reaches retreat pose"],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"grape","timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "perceive",
      "active_leaf": {"id":"ScanForTarget","attrs":{"target":"grape","pattern":"raster","max_attempts":3,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"grape","offset_z":0.02,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "approach",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"grasp_grape","tolerance":0.005,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "verify",
      "active_leaf": {"id":"LowerUntilContact","attrs":{"speed":"slow","max_depth":0.02,"force_threshold":10,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "grasp",
      "active_leaf": {"id":"CloseGripper","attrs":{"force":10,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "transfer",
      "active_leaf": {"id":"MoveDelta","attrs":{"axis":"z","dist":0.1,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "transfer",
      "active_leaf": {"id":"MoveDelta","attrs":{"axis":"z","dist":0.1,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":1200}},
      "active_path_ids": []
    }
  ]
}
