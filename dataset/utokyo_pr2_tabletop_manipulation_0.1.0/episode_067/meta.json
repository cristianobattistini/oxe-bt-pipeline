{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_067",
  "task_summary": "Detect the cloth, approach and align at its edge, pinch lightly, push to fold it over itself, release, and retreat.",
  "task_long_description": {
    "overview": "A PR2-style manipulator folds a pink cloth lying on a wooden tabletop. The robot first verifies visibility and localizes the cloth, then approaches above it and orients the gripper at 90Â° to align with an edge. It gently pinches the edge, performs a short push motion to create a fold, releases the cloth once the crease is formed, and retreats to a safe height. Precise positioning and light gripping help avoid wrinkling or dragging the cloth excessively.",
    "preconditions": [
      "Cloth is on a flat table within reachable workspace",
      "Camera provides a clear view of the cloth",
      "Gripper operational and unobstructed"
    ],
    "stepwise_plan": [
      "Verify visibility or scan to find the cloth.",
      "Detect and localize the cloth.",
      "Move above the cloth and set gripper yaw to align with the fold direction.",
      "Approach and align precisely to the target edge.",
      "Open gripper, lower until contact, then close lightly to pinch the edge.",
      "Push along the intended direction to fold the cloth.",
      "Open gripper to release the folded cloth.",
      "Retreat and wait briefly."
    ],
    "success_criteria": [
      "Cloth appears folded with a visible crease",
      "Robot releases cloth and retreats without disturbance",
      "No object slippage or excessive drag observed"
    ],
    "failure_and_recovery": [
      "Perception fail: trigger raster scan and re-detect",
      "Grasp slip: reopen, re-approach and regrasp",
      "Push misalignment: adjust yaw and re-align before retrying"
    ],
    "termination": "End after release, retreat, and a short wait with the cloth in a folded configuration."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0", "frame_8"],
    "scores": {
      "frame_0": 0.12, "frame_1": 0.34, "frame_2": 0.56, "frame_3": 0.92,
      "frame_4": 0.28, "frame_5": 0.80, "frame_6": 0.49, "frame_7": 0.18, "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "first stable contact and alignment cue visible",
        "predicts_next": "push actuation expected; confirms goal direction",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "folding a cloth",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7", "frame_8"],
  "objects": ["cloth", "table", "robot_arm", "gripper"],
  "objects_from_instruction": ["cloth"],
  "blackboard_keys": [],
  "node_specs": [
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"cloth"},"description":"Quick check if the cloth is already visible."},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"cloth","pattern":"raster","max_attempts":3,"timeout_ms":1500},"description":"Raster scan to locate the cloth if not visible."},
    {"id":"DetectObject","type":"Action","ports":{"target":"cloth","timeout_ms":800},"description":"Run detection to localize cloth pose."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"cloth","offset_z":0.05,"timeout_ms":1200},"description":"Move to a safe pre-grasp height above the cloth."},
    {"id":"SetTCPYaw","type":"Action","ports":{"yaw_deg":90},"description":"Orient gripper to align with intended fold direction."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"cloth_edge","tolerance":0.01,"timeout_ms":1200},"description":"Refine position to the cloth edge for a precise pinch."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.06,"timeout_ms":500},"description":"Open gripper to a narrow width for a pinch grasp."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":0.02,"force_threshold":5.0,"timeout_ms":1200},"description":"Lower gently until contact with the cloth edge."},
    {"id":"CloseGripper","type":"Action","ports":{"force":10,"timeout_ms":800},"description":"Close lightly to pinch the cloth without slipping."},
    {"id":"Push","type":"Action","ports":{"target":"cloth_edge","distance":0.1,"direction_deg":180,"timeout_ms":1200},"description":"Push the pinched edge to create a fold."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.08,"timeout_ms":500},"description":"Release the cloth after folding."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":800},"description":"Back away to a safe distance."},
    {"id":"Wait","type":"Action","ports":{"timeout_ms":400},"description":"Short pause to let the cloth settle."}
  ],
  "tree_stats": {"nodes_total": 15, "actions": 12, "conditions": 1, "depth": 3},
  "failure_modes": [
    "Cloth not detected due to lighting or occlusion",
    "Pinch grasp slips on fabric",
    "Push direction too shallow causing drag instead of fold"
  ],
  "recovery_strategy": [
    "Invoke ScanForTarget and re-detect",
    "Re-open, re-align, and re-close with corrected contact",
    "Adjust yaw and re-run alignment before pushing again"
  ],
  "assumptions": [
    "Folding is achieved via a short push after a light pinch; frames suggest push-based folding.",
    "Target edge is reachable and table is unobstructed.",
    "No explicit speed/force adjectives in the instruction; default bins selected accordingly."
  ],
  "evaluation_notes": {
    "expected_success_criteria": [
      "Folded cloth footprint roughly half of original area",
      "Gripper released and robot retreated without disturbing fold"
    ],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"cloth","timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"cloth","offset_z":0.05,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "approach",
      "active_leaf": {"id":"SetTCPYaw","attrs":{"yaw_deg":90}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "verify",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"cloth_edge","tolerance":0.01,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "grasp",
      "active_leaf": {"id":"CloseGripper","attrs":{"force":10,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"Push","attrs":{"target":"cloth_edge","distance":0.1,"direction_deg":180,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "transfer",
      "active_leaf": {"id":"Push","attrs":{"target":"cloth_edge","distance":0.1,"direction_deg":180,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "place",
      "active_leaf": {"id":"OpenGripper","attrs":{"width":0.08,"timeout_ms":500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    }
  ]
}
