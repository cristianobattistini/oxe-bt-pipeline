{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_190",
  "task_summary": "Fold the pink cloth on the tabletop by grasping an edge, transporting it across the midline, placing and releasing to create a neat fold.",
  "task_long_description": {
    "overview": "A PR2 arm manipulates a pink cloth on a wooden tabletop. The goal is to achieve a single neat fold by pinching an accessible edge, lifting slightly, transporting the grasped edge over the midline, pressing to crease, releasing, and retreating. Perception first localizes the cloth and computes a grasp along an edge. Motions are top‑down with careful approach and contact detection. Constraints include limited timeouts, gentle gripping force, and precise alignment to avoid dragging or wrinkling excessively.",
    "preconditions": ["Cloth is visible in the camera view", "Workspace is clear and reachable", "Gripper is open and functional", "Robot has a valid motion plan above the table"],
    "stepwise_plan": ["Scan and detect the cloth on the table", "Compute an edge grasp and move above it", "Align and descend until contact", "Close gripper and verify grasp stability", "Lift slightly and move toward the fold target along the midline", "Place the grasped edge at the target and press to crease", "Open the gripper to release the cloth", "Retreat to a safe standoff"],
    "success_criteria": ["Cloth appears folded into a smaller rectangle", "Released with no cloth in gripper", "End effector retreats to a safe pose"],
    "failure_and_recovery": ["If detection fails, rescan with raster pattern", "If grasp is unstable or slips, reopen and recompute grasp", "If misaligned during approach, realign and retry approach", "If placement misses target, reattempt placement then release"],
    "termination": "Terminate after successful release and retreat, or upon repeated failures that exceed built‑in action timeouts."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0","frame_8"],
    "scores": {
      "frame_0": 0.12,
      "frame_1": 0.34,
      "frame_2": 0.56,
      "frame_3": 0.92,
      "frame_4": 0.28,
      "frame_5": 0.80,
      "frame_6": 0.49,
      "frame_7": 0.18,
      "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "first stable contact and alignment cue visible",
        "predicts_next": "push actuation expected; confirms goal direction",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "folding a cloth",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7","frame_8"],
  "objects": ["pink_cloth", "table_top", "pr2_arm", "parallel_gripper"],
  "objects_from_instruction": ["cloth"],
  "blackboard_keys": ["grasp_edge", "fold_target"],
  "node_specs": [
    {"id":"OpenGripper","type":"Action","ports":{"width":"0.09","timeout_ms":"800"},"description":"Open fingers to a safe width before grasp and to release after placement."},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"cloth","pattern":"raster","max_attempts":"3","timeout_ms":"1500"},"description":"Actively scan the workspace to localize the cloth."},
    {"id":"DetectObject","type":"Action","ports":{"target":"cloth","timeout_ms":"1200"},"description":"Detect the cloth pose after scanning."},
    {"id":"ComputeGraspPose","type":"Action","ports":{"target":"cloth_edge","strategy":"pinch","result_key":"grasp_edge"},"description":"Compute an edge pinch grasp and store it."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"grasp_edge","offset_z":"0.05","timeout_ms":"1200"},"description":"Move to a pregrasp above the computed edge pose."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"grasp_edge","tolerance":"0.005","timeout_ms":"1200"},"description":"Refine alignment before contact."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":"0.02","force_threshold":"5.0","timeout_ms":"1200"},"description":"Descend until contact with the cloth is detected."},
    {"id":"CloseGripper","type":"Action","ports":{"force":"10","timeout_ms":"800"},"description":"Pinch the cloth edge gently."},
    {"id":"IsGraspStable","type":"Condition","ports":{},"description":"Verify that the grasp is stable."},
    {"id":"Pick","type":"Action","ports":{"grasp_key":"grasp_edge","timeout_ms":"1200"},"description":"Execute the pickup using the computed grasp."},
    {"id":"MoveDelta","type":"Action","ports":{"axis":"z","dist":"0.1","timeout_ms":"1200"},"description":"Lift slightly to avoid dragging."},
    {"id":"SetBlackboard","type":"Action","ports":{"key":"fold_target","value":"cloth_midline_pose"},"description":"Define the target pose for folding along the midline."},
    {"id":"MoveTo","type":"Action","ports":{"target":"fold_target","timeout_ms":"1500"},"description":"Transport the grasped edge to the fold target."},
    {"id":"PlaceAt","type":"Action","ports":{"pose_key":"fold_target","yaw_deg":"0","press_force":"10.0"},"description":"Place and press to crease the fold."},
    {"id":"Retreat","type":"Action","ports":{"distance":"0.1","timeout_ms":"1200"},"description":"Retreat to a safe standoff after release."},
    {"id":"Wait","type":"Action","ports":{"timeout_ms":"500"},"description":"Brief pause to stabilize after retreat."}
  ],
  "tree_stats": {"nodes_total": 18, "actions": 16, "conditions": 1, "depth": 2},
  "failure_modes": ["Cloth not detected due to lighting or occlusion", "Grasp captures multiple layers causing slip", "Approach misalignment causing cloth drag", "Placement offset resulting in poor crease"],
  "recovery_strategy": ["Repeat scan and detection", "Reopen gripper and recompute grasp on a different edge", "Realign using ApproachAndAlign and reattempt contact", "Re-place and press again before release"],
  "assumptions": ["Frames show a single-arm edge pinch and transport leading to a single fold; no bimanual manipulation is available", "Fold target is approximated as the cloth midline pose stored in the blackboard", "Pressing is brief and gentle; exact force control beyond press_force is abstracted"],
  "evaluation_notes": {
    "expected_success_criteria": ["Final frames show a smaller, neatly folded rectangle", "No object remains in the gripper", "Arm retreats clear of the cloth"],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"ScanForTarget","attrs":{"target":"cloth","pattern":"raster","max_attempts":3,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"grasp_edge","offset_z":0.05,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "verify",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"grasp_edge","tolerance":0.005,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "grasp",
      "active_leaf": {"id":"CloseGripper","attrs":{"force":10,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "grasp",
      "active_leaf": {"id":"Pick","attrs":{"grasp_key":"grasp_edge","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"MoveTo","attrs":{"target":"fold_target","timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "place",
      "active_leaf": {"id":"PlaceAt","attrs":{"pose_key":"fold_target","yaw_deg":0,"press_force":10.0}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "place",
      "active_leaf": {"id":"OpenGripper","attrs":{"width":0.09,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":1200}},
      "active_path_ids": []
    }
  ]
}
