{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_058",
  "task_summary": "Detect the pink cloth, approach with correct yaw, gently pinch one edge, lift and move it to fold over itself, release, and retreat.",
  "task_long_description": {
    "overview": "A single-arm PR2 manipulates a pink cloth on a wooden tabletop. The robot must first perceive the cloth, align the gripper with a suitable edge, make gentle contact, secure the grasp, and then execute a lift-and-translate motion to fold the cloth over itself. The scene shows progressive approach, contact, brief lift, lateral motion, and release. Constraints include delicate handling (low force), accurate alignment, and short motion distances to avoid dragging or wrinkling the cloth excessively.",
    "preconditions": ["Robot is homed and within workspace limits", "Cloth is on the table and visible to the camera", "Gripper operational and free of objects", "No obstacles near the cloth"],
    "stepwise_plan": [
      "Open gripper and localize the cloth.",
      "Move above the cloth and set end-effector yaw for edge alignment.",
      "Compute a pinch grasp and align precisely.",
      "Lower until contact and close the gripper with low force; verify stability.",
      "Lift slightly, translate along the fold direction, lower, and release to complete the fold.",
      "Retreat to a safe pose."
    ],
    "success_criteria": ["Cloth appears folded once over along intended axis", "No object dropped mid-motion", "End-effector retreats safely with gripper open"],
    "failure_and_recovery": [
      "Cloth not detected → spiral scan then re-detect",
      "Unstable grasp → retry close-and-check sequence",
      "Slip during transfer → lower, regrasp with improved alignment",
      "Excess drag on table → reduce lateral distance or increase lift height"
    ],
    "termination": "Terminate when the cloth is released in a folded configuration and the arm retreats."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0", "frame_8"],
    "scores": {
      "frame_0": 0.12, "frame_1": 0.34, "frame_2": 0.56, "frame_3": 0.92,
      "frame_4": 0.28, "frame_5": 0.80, "frame_6": 0.49, "frame_7": 0.18, "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "first stable contact and alignment cue visible",
        "predicts_next": "push actuation expected; confirms goal direction",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "folding a cloth",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7", "frame_8"],
  "objects": ["cloth", "table", "robot_arm", "gripper"],
  "objects_from_instruction": ["cloth"],
  "blackboard_keys": ["cloth_grasp"],
  "node_specs": [
    {"id":"OpenGripper","type":"Action","ports":{"width":"0.09","timeout_ms":"500"},"description":"Prepare gripper for approach."},
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"cloth"},"description":"Checks if cloth is already visible."},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"cloth","pattern":"spiral","max_attempts":"3","timeout_ms":"1500"},"description":"Spiral scan to locate the cloth if not visible."},
    {"id":"DetectObject","type":"Action","ports":{"target":"cloth","timeout_ms":"800"},"description":"Detect cloth pose precisely."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"cloth","offset_z":"0.05","timeout_ms":"1200"},"description":"Position above cloth with small clearance."},
    {"id":"SetTCPYaw","type":"Action","ports":{"yaw_deg":"90"},"description":"Align gripper yaw with cloth edge."},
    {"id":"ComputeGraspPose","type":"Action","ports":{"target":"cloth","strategy":"pinch","result_key":"cloth_grasp"},"description":"Compute pinch grasp on a cloth edge."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"cloth","tolerance":"0.005","timeout_ms":"1200"},"description":"Precise approach to the grasp point."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":"0.02","force_threshold":"10","timeout_ms":"800"},"description":"Lower until contact sensed to avoid pushing cloth away."},
    {"id":"CloseGripper","type":"Action","ports":{"force":"10","timeout_ms":"800"},"description":"Gently pinch the cloth."},
    {"id":"IsGraspStable","type":"Condition","ports":{},"description":"Verify grasp stability before moving."},
    {"id":"MoveDelta","type":"Action","ports":{"axis":"z","dist":"0.05","timeout_ms":"1200"},"description":"Lift slightly to avoid drag."},
    {"id":"MoveDelta","type":"Action","ports":{"axis":"y","dist":"0.1","timeout_ms":"1500"},"description":"Translate to fold the cloth over itself."},
    {"id":"MoveDelta","type":"Action","ports":{"axis":"z","dist":"0.05","timeout_ms":"1200"},"description":"Lower the folded layer."},
    {"id":"OpenGripper","type":"Action","ports":{"width":"0.09","timeout_ms":"800"},"description":"Release the cloth."},
    {"id":"Retreat","type":"Action","ports":{"distance":"0.1","timeout_ms":"1200"},"description":"Retreat to a safe distance."}
  ],
  "tree_stats": {"nodes_total": 20, "actions": 14, "conditions": 2, "depth": 4},
  "failure_modes": ["Cloth not detected", "Misalignment causing drag", "Grasp slips during transfer", "Insufficient lift leading to snagging"],
  "recovery_strategy": ["Spiral scan then re-detect", "Retry close-and-stability check", "Increase lift height before lateral motion", "Recompute grasp and adjust yaw"],
  "assumptions": [
    "Single-arm fold is achieved by lift-then-translate along +y direction as suggested by frames.",
    "Yaw 90° aligns gripper with a cloth edge; exact fold axis inferred from approach direction.",
    "Frames show contact/press then slight lift and lateral motion; treated as a single-fold maneuver."
  ],
  "evaluation_notes": {
    "expected_success_criteria": ["Cloth ends in visibly folded state", "No tearing or excessive displacement", "Robot ends clear of the cloth"],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"cloth","timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"cloth","offset_z":0.05,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "verify",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"cloth","tolerance":0.005,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "grasp",
      "active_leaf": {"id":"LowerUntilContact","attrs":{"speed":"slow","max_depth":0.02,"force_threshold":10,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "grasp",
      "active_leaf": {"id":"CloseGripper","attrs":{"force":10,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"MoveDelta","attrs":{"axis":"z","dist":0.05,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "transfer",
      "active_leaf": {"id":"MoveDelta","attrs":{"axis":"y","dist":0.1,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "place",
      "active_leaf": {"id":"OpenGripper","attrs":{"width":0.09,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":1200}},
      "active_path_ids": []
    }
  ]
}
