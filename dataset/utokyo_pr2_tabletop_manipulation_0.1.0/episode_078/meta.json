{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_078",
  "task_summary": "Detect the bread, grasp it with a pinch grasp, transfer above the plate, lower until contact, release on the plate, and retreat.",
  "task_long_description": {
    "overview": "A PR2-style gripper interacts with a small piece of bread on a tabletop covered by a green mat. A white plate is positioned to the left. The robot must perceive the bread, approach precisely, compute a pinch grasp, pick it, move over the plate, gently lower until contact, release the bread onto the plate, and retreat clear of the scene. The sequence prioritizes reliable perception with retry and careful alignment to avoid sliding the bread or knocking the plate.",
    "preconditions": [
      "Workcell clear with bread and plate on table",
      "Robot reachable workspace includes bread and plate",
      "Gripper operational and initially able to open"
    ],
    "stepwise_plan": [
      "Check/obtain bread visibility; retry detection if needed",
      "Open gripper and move above bread",
      "Approach and align with tight tolerance",
      "Compute pinch grasp and execute pick",
      "Verify grasp stability",
      "Move above the plate",
      "Lower until contact with plate detected",
      "Open gripper to release bread",
      "Retreat to a safe height and pause"
    ],
    "success_criteria": [
      "Bread ends resting on the plate center area",
      "No collision or displacement of the plate",
      "Robot ends in a safe, non-contact pose"
    ],
    "failure_and_recovery": [
      "Perception failure: retry up to three detections",
      "Misalignment: re-run ApproachAndAlign via tree re-tick",
      "Unstable grasp: pick fails and the sequence can be reattempted from perception"
    ],
    "termination": "Terminate after successful release and retreat or after unrecoverable action failure."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0","frame_8"],
    "scores": {
      "frame_0": 0.12,
      "frame_1": 0.34,
      "frame_2": 0.56,
      "frame_3": 0.92,
      "frame_4": 0.28,
      "frame_5": 0.80,
      "frame_6": 0.49,
      "frame_7": 0.18,
      "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "first stable contact and alignment cue visible",
        "predicts_next": "push actuation expected; confirms goal direction",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "picking a bread",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7","frame_8"],
  "objects": ["bread","plate","robot_gripper","table_mat"],
  "objects_from_instruction": ["bread"],
  "blackboard_keys": ["bread_grasp"],
  "node_specs": [
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"bread"},"description":"Checks if the bread is currently visible."},
    {"id":"DetectObject","type":"Action","ports":{"target":"bread","timeout_ms":1200},"description":"Runs detection to localize the bread if not already visible."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.09,"timeout_ms":800},"description":"Open the gripper for approach and for release at the end."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"bread","offset_z":0.05,"timeout_ms":1500},"description":"Move to a pregrasp pose above the bread."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"bread","tolerance":0.005,"timeout_ms":1500},"description":"Refine pose and alignment with tight tolerance."},
    {"id":"ComputeGraspPose","type":"Action","ports":{"target":"bread","strategy":"pinch","result_key":"bread_grasp"},"description":"Compute a pinch grasp and store it on the blackboard."},
    {"id":"Pick","type":"Action","ports":{"grasp_key":"bread_grasp","timeout_ms":1200},"description":"Execute the planned grasp to pick the bread."},
    {"id":"IsGraspStable","type":"Condition","ports":{},"description":"Confirm a stable grasp after picking."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"plate","offset_z":0.05,"timeout_ms":1500},"description":"Carry the bread above the plate."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":0.05,"force_threshold":10,"timeout_ms":1200},"description":"Lower gently until contact with plate is detected."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.09,"timeout_ms":800},"description":"Release the bread onto the plate."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":1200},"description":"Back away to a safe position."},
    {"id":"Wait","type":"Action","ports":{"timeout_ms":400},"description":"Short pause to ensure settling."}
  ],
  "tree_stats": {"nodes_total": 16, "actions": 11, "conditions": 2, "depth": 4},
  "failure_modes": [
    "Bread slips during lift",
    "Gripper collides with plate edge",
    "Perception loses track of bread mid-approach"
  ],
  "recovery_strategy": [
    "If pick fails, re-open gripper and retry from detection",
    "If contact too early, retreat and re-align",
    "If plate occludes view, move slightly and re-detect"
  ],
  "assumptions": [
    "Instruction says 'picking a bread' but frames show pick-and-place onto a plate; tree follows the frames.",
    "Bread is graspable with a pinch strategy; offsets (0.05 m) chosen to clear the surface.",
    "Force threshold and depths are nominal since exact sensor scales are unknown."
  ],
  "evaluation_notes": {
    "expected_success_criteria": [
      "Bread is visible on plate in final frame and gripper is clear",
      "No toppling of plate or sweeping of bread"
    ],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"bread","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"bread","offset_z":0.05,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "verify",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"bread","tolerance":0.005,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "grasp",
      "active_leaf": {"id":"Pick","attrs":{"grasp_key":"bread_grasp","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "transfer",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"plate","offset_z":0.05,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"plate","offset_z":0.05,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "place",
      "active_leaf": {"id":"LowerUntilContact","attrs":{"speed":"slow","max_depth":0.05,"force_threshold":10,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "place",
      "active_leaf": {"id":"OpenGripper","attrs":{"width":0.09,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":1200}},
      "active_path_ids": []
    }
  ]
}
