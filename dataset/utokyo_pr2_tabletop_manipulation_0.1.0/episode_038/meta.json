{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_038",
  "task_summary": "Detect, approach, and pinch-grasp a grape, then lift and retreat from the plate area.",
  "task_long_description": {
    "overview": "The PR2 gripper approaches a small cluster of grapes positioned near a white plate on a tabletop. The objective is to pick a grape (or small cluster) using a gentle pinch grasp to avoid crushing. The tree first detects and confirms visibility, computes a pinch grasp, approaches from above, aligns precisely, opens the gripper, lowers until contact, then closes with low force. After verifying the grasp, the robot lifts vertically to clear the plate and retreats away from the workspace, ensuring safe clearance from the plate and table edges.",
    "preconditions": [
      "Workspace clear except for plate and grapes",
      "Robot positioned with reachable workspace over the table",
      "Gripper functional and calibrated",
      "Camera provides view of the grapes"
    ],
    "stepwise_plan": [
      "Perceive grapes and confirm visibility.",
      "Compute a pinch grasp pose.",
      "Move above target and align precisely.",
      "Open gripper, descend until contact.",
      "Close gripper gently to grasp.",
      "Verify grasp stability.",
      "Lift vertically and retreat from the plate."
    ],
    "success_criteria": [
      "Grape securely in gripper (ObjectInGripper implied)",
      "No visible slippage during lift",
      "Tool cleared away from plate without collisions"
    ],
    "failure_and_recovery": [
      "If detection fails, re-perceive and scan again.",
      "If contact occurs without grasp, reopen and retry alignment.",
      "If grasp unstable, lower again and re-close with correct alignment."
    ],
    "termination": "Terminate when the grape is grasped and the end-effector has retreated to a safe pose."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0", "frame_8"],
    "scores": {
      "frame_0": 0.12,
      "frame_1": 0.34,
      "frame_2": 0.56,
      "frame_3": 0.92,
      "frame_4": 0.28,
      "frame_5": 0.80,
      "frame_6": 0.49,
      "frame_7": 0.18,
      "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "first stable contact and alignment cue visible",
        "predicts_next": "push actuation expected; confirms goal direction",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "picking a grape",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7", "frame_8"],
  "objects": ["grape","plate","table","pr2_gripper"],
  "objects_from_instruction": ["grape"],
  "blackboard_keys": ["grasp_grape"],
  "node_specs": [
    {"id":"DetectObject","type":"Action","ports":{"target":"grape","timeout_ms":1200},"description":"Detect the grape target."},
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"grape"},"description":"Verify the grape is visible before approaching."},
    {"id":"ComputeGraspPose","type":"Action","ports":{"target":"grape","strategy":"pinch","result_key":"grasp_grape"},"description":"Compute a pinch grasp pose and store it."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"grape","offset_z":0.05,"timeout_ms":1200},"description":"Move above target with clearance."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"grape","tolerance":0.005,"timeout_ms":1500},"description":"Align precisely to grasp pose."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.06,"timeout_ms":500},"description":"Open gripper to small width for pinch."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":0.03,"force_threshold":10.0,"timeout_ms":1500},"description":"Descend gently until contact is sensed."},
    {"id":"CloseGripper","type":"Action","ports":{"force":10,"timeout_ms":800},"description":"Close with low force to avoid crushing."},
    {"id":"IsGraspStable","type":"Condition","ports":{},"description":"Check grasp stability."},
    {"id":"MoveDelta","type":"Action","ports":{"axis":"z","dist":0.1,"timeout_ms":800},"description":"Lift the object vertically."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":1200},"description":"Back off to a safe pose."}
  ],
  "tree_stats": {"nodes_total": 12, "actions": 9, "conditions": 2, "depth": 2},
  "failure_modes": ["Target not detected", "Misalignment leading to missed grasp", "Object slips after closure", "Collision with plate during lift"],
  "recovery_strategy": ["Re-run detection", "Re-align and lower again", "Reopen and retry pinch", "Increase vertical clearance before retreat"],
  "assumptions": [
    "Frames show a small grape cluster near a plate; instruction says 'picking a grape'â€”we assume grasping one grape or a small cluster is acceptable.",
    "Approach appears top-down; thus a pinch strategy is selected."
  ],
  "evaluation_notes": {
    "expected_success_criteria": ["Grape secured, lifted, and arm retreats without contact with plate/table"],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"grape","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"grape","offset_z":0.05,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "approach",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"grape","tolerance":0.005,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "approach",
      "active_leaf": {"id":"LowerUntilContact","attrs":{"speed":"slow","max_depth":0.03,"force_threshold":10.0,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "verify",
      "active_leaf": {"id":"IsObjectVisible","attrs":{"target":"grape"}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "grasp",
      "active_leaf": {"id":"CloseGripper","attrs":{"force":10,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "transfer",
      "active_leaf": {"id":"MoveDelta","attrs":{"axis":"z","dist":0.1,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "transfer",
      "active_leaf": {"id":"MoveDelta","attrs":{"axis":"z","dist":0.1,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":1200}},
      "active_path_ids": []
    }
  ]
}
