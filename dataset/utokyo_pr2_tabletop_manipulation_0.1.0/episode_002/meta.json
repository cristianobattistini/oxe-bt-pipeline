{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_002",
  "task_summary": "Approach the pink cloth, establish gentle contact, and fold it by pushing along its edge, then retreat.",
  "task_long_description": {
    "overview": "A PR2 manipulator folds a pink cloth lying on a wooden tabletop. The robot first verifies the cloth’s visibility, opens the gripper, and approaches from above. After aligning its yaw with the fold edge, it descends slowly until contact is sensed. The fold is created by executing two pushing strokes along a straight direction, using the flat fingers as a pusher rather than grasping. Finally, the robot retreats and pauses to stabilize the cloth. The sequence emphasizes reliable perception, careful approach, contact verification, and controlled planar pushing.",
    "preconditions": ["Tabletop is clear except for the cloth", "Camera view provides the cloth pose", "Workspace calibrated; safe approach from the right side", "Gripper operational"],
    "stepwise_plan": ["Verify/scan for the cloth", "Open gripper and move above target", "Set yaw for fold direction and align", "Lower until contact is detected", "Push along the planned direction twice to form the fold", "Retreat and wait briefly"],
    "success_criteria": ["Cloth corner/edge is pushed over itself forming a visible fold", "No unintended displacement off the workspace", "Robot ends safely away from the cloth"],
    "failure_and_recovery": ["Perception failure → raster scan and re-detect", "No contact sensed → re-approach and lower again", "Insufficient fold → repeat push cycle", "Excess slip → adjust yaw and retry pushing"],
    "termination": "Terminate after successful push cycles and retreat, or after recovery attempts are exhausted."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0", "frame_8"],
    "scores": {
      "frame_0": 0.12, "frame_1": 0.34, "frame_2": 0.56, "frame_3": 0.92,
      "frame_4": 0.28, "frame_5": 0.80, "frame_6": 0.49, "frame_7": 0.18, "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "first stable contact and alignment cue visible",
        "predicts_next": "push actuation expected; confirms goal direction",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "folding a cloth",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7", "frame_8"],
  "objects": ["pink_cloth","cloth_edge","table","pr2_gripper"],
  "objects_from_instruction": ["cloth"],
  "blackboard_keys": [],
  "node_specs": [
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"cloth"},"description":"Checks if the cloth is visible."},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"cloth","pattern":"raster","max_attempts":3,"timeout_ms":1500},"description":"Raster scan to locate cloth if not initially visible."},
    {"id":"DetectObject","type":"Action","ports":{"target":"cloth","timeout_ms":800},"description":"Detect and localize the cloth."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.09,"timeout_ms":500},"description":"Open gripper to avoid pinching the cloth."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"cloth","offset_z":0.05,"timeout_ms":1200},"description":"Move to a pre-approach pose above the cloth."},
    {"id":"SetTCPYaw","type":"Action","ports":{"yaw_deg":90},"description":"Align tool yaw with planned fold axis."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"cloth","tolerance":0.01,"timeout_ms":1500},"description":"Refine position relative to cloth before contact."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":0.02,"force_threshold":10,"timeout_ms":1200},"description":"Descend gently until contact is detected."},
    {"id":"Push","type":"Action","ports":{"target":"cloth_edge","distance":0.1,"direction_deg":180,"timeout_ms":1200},"description":"Planar push along edge to create the fold; repeated twice."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":800},"description":"Back off from the cloth."},
    {"id":"Wait","type":"Action","ports":{"timeout_ms":400},"description":"Brief pause to let the cloth settle."}
  ],
  "tree_stats": {"nodes_total": 14, "actions": 10, "conditions": 1, "depth": 3},
  "failure_modes": ["Cloth not detected", "Contact not achieved due to height error", "Insufficient fold from short push", "Cloth slips away during pushing"],
  "recovery_strategy": ["Raster scan and re-detect", "Re-approach and lower again", "Repeat push cycle", "Adjust yaw and retry pushing"],
  "assumptions": ["Frames show pushing-based folding (not pinch grasp). The push direction is assumed leftward (180°) relative to camera.", "Exact cloth dimensions are unknown; generic distances used."],
  "evaluation_notes": {
    "expected_success_criteria": ["A clear crease appears and the cloth's edge overlaps itself after two pushes", "Robot ends in a safe pose"],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"IsObjectVisible","attrs":{"target":"cloth"}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"cloth","offset_z":0.05,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "approach",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"cloth","tolerance":0.01,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "verify",
      "active_leaf": {"id":"LowerUntilContact","attrs":{"speed":"slow","max_depth":0.02,"force_threshold":10,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "transfer",
      "active_leaf": {"id":"Push","attrs":{"target":"cloth_edge","distance":0.1,"direction_deg":180,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"Push","attrs":{"target":"cloth_edge","distance":0.1,"direction_deg":180,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "retreat",
      "active_leaf": {"id":"Wait","attrs":{"timeout_ms":400}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Wait","attrs":{"timeout_ms":400}},
      "active_path_ids": []
    }
  ]
}
