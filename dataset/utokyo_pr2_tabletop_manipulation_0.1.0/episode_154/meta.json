{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_154",
  "task_summary": "Detect the bread, grasp it with a pinch grasp, lift and transfer it above the plate, then release it and retreat.",
  "task_long_description": {
    "overview": "A PR2 arm must pick a single bread-like item from a table mat and place it onto a small plate. The scene shows a plate to the left and the bread to its right. The gripper approaches from the right, aligns, closes to grasp, lifts, moves over the plate, lowers, releases, and retreats. Visual perception ensures the bread is located; contact sensing confirms touchdown before grasp and before placing. Motions are conservative and precise to avoid knocking the plate or sliding the bread.",
    "preconditions": ["Robot has free workspace above table mat", "Bread and plate are on the table within reachable workspace", "Gripper starts empty and open", "Camera provides view of bread"],
    "stepwise_plan": ["Open gripper and locate bread (scan if not visible)", "Compute pinch grasp pose", "Move above bread and align precisely", "Lower until contact and confirm", "Execute grasp and verify stability", "Lift (retreat) and move above plate", "Lower toward plate, release bread", "Retreat to a safe pose"],
    "success_criteria": ["Bread is securely grasped then released onto the plate", "No collision with plate or table", "Final state shows bread stably on plate and gripper empty"],
    "failure_and_recovery": ["If bread not visible → raster scan then re-detect", "If no contact detected → re-approach and lower again", "If grasp unstable → reopen, recompute grasp, retry", "If object dropped en route → re-detect and repeat pick-and-place"],
    "termination": "After releasing the bread over the plate and performing the final retreat."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0", "frame_8"],
    "scores": {
      "frame_0": 0.12, "frame_1": 0.34, "frame_2": 0.56, "frame_3": 0.92,
      "frame_4": 0.28, "frame_5": 0.80, "frame_6": 0.49, "frame_7": 0.18, "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "first stable contact and alignment cue visible",
        "predicts_next": "push actuation expected; confirms goal direction",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "picking a bread",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7", "frame_8"],
  "objects": ["bread", "plate", "table_mat", "gripper"],
  "objects_from_instruction": ["bread"],
  "blackboard_keys": ["bread_grasp"],
  "node_specs": [
    {"id":"OpenGripper","type":"Action","ports":{"width":"0.09","timeout_ms":"800"},"description":"Prepare gripper for grasping."},
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"bread"},"description":"Quick check if bread is currently visible."},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"bread","pattern":"raster","max_attempts":"3","timeout_ms":"1200"},"description":"Search pattern if not visible."},
    {"id":"DetectObject","type":"Action","ports":{"target":"bread","timeout_ms":"1200"},"description":"Localize bread precisely."},
    {"id":"ComputeGraspPose","type":"Action","ports":{"target":"bread","strategy":"pinch","result_key":"bread_grasp"},"description":"Plan grasp and store key."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"bread","offset_z":"0.05","timeout_ms":"1500"},"description":"Move to pregrasp height over bread."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"bread","tolerance":"0.005","timeout_ms":"1500"},"description":"Fine alignment before grasp."},
    {"id":"SetTCPYaw","type":"Action","ports":{"yaw_deg":"90"},"description":"Orient gripper for lateral pinch."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":"0.03","force_threshold":"10","timeout_ms":"1200"},"description":"Descend to gentle contact."},
    {"id":"ContactDetected","type":"Condition","ports":{"force_threshold":"10"},"description":"Verify contact occurred."},
    {"id":"Pick","type":"Action","ports":{"grasp_key":"bread_grasp","timeout_ms":"1200"},"description":"Close and lift to seize bread."},
    {"id":"IsGraspStable","type":"Condition","ports":{},"description":"Confirm object secured."},
    {"id":"Retreat","type":"Action","ports":{"distance":"0.1","timeout_ms":"800"},"description":"Lift away from table."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"plate","offset_z":"0.05","timeout_ms":"1500"},"description":"Move above plate for placement."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":"0.03","force_threshold":"10","timeout_ms":"1200"},"description":"Lower toward plate prior to release."},
    {"id":"OpenGripper","type":"Action","ports":{"width":"0.09","timeout_ms":"800"},"description":"Release bread onto plate."},
    {"id":"Retreat","type":"Action","ports":{"distance":"0.1","timeout_ms":"800"},"description":"Back off to safe pose."}
  ],
  "tree_stats": {"nodes_total": 19, "actions": 14, "conditions": 3, "depth": 4},
  "failure_modes": ["Bread not detected due to glare/pose", "No contact sensed when lowering", "Grasp slips after lift", "Collision with plate during placement"],
  "recovery_strategy": ["Raster scan and re-detect", "Re-align and lower again with small offset", "Re-open, recompute grasp, and retry", "Raise height and re-approach centrally"],
  "assumptions": ["Although instruction says 'picking a bread', frames show a full pick-and-place onto a plate; the BT follows the visual evidence.", "LowerUntilContact is target-agnostic in the library; used generically for both approach and placement.", "Chosen yaw=90 is inferred from bread orientation in images."],
  "evaluation_notes": {
    "expected_success_criteria": ["Bread ends on plate; gripper empty; no object motion after release"],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"bread","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"bread","tolerance":0.005,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "approach",
      "active_leaf": {"id":"SetTCPYaw","attrs":{"yaw_deg":90}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "verify",
      "active_leaf": {"id":"ContactDetected","attrs":{"force_threshold":10}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "grasp",
      "active_leaf": {"id":"Pick","attrs":{"grasp_key":"bread_grasp","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "transfer",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"plate","offset_z":0.05,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "place",
      "active_leaf": {"id":"LowerUntilContact","attrs":{"speed":"slow","max_depth":0.03,"force_threshold":10,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    }
  ]
}
