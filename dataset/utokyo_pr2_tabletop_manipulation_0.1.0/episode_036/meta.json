{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_036",
  "task_summary": "Perceive the pink cloth, approach and align at the right edge, press to make contact, push left to fold, then retreat and hover.",
  "task_long_description": {
    "overview": "A single-arm robot manipulates a pink cloth on a wooden tabletop. The goal is to fold the cloth once by pushing its right edge toward the left after establishing gentle contact. The robot first ensures the cloth is perceived, approaches from above, aligns yaw with the fold direction, lowers until contact, executes a leftward push to create a fold, pauses to settle the fabric, retreats to clear the workspace, and finishes hovering above the folded cloth. Precision during alignment and controlled contact are key to avoid dragging or slipping.",
    "preconditions": [
      "Workspace is clear with a visible cloth on the table",
      "Robot has free space to approach from above on the cloth’s right edge",
      "Gripper is open and free of objects"
    ],
    "stepwise_plan": [
      "Open gripper and (re)detect the cloth; scan if not immediately visible.",
      "Move above the cloth and set tool yaw to align with fold direction.",
      "Approach the right edge; align within tight tolerance.",
      "Lower until contact is detected against the cloth/table.",
      "Push the right edge leftward to create a single fold; briefly wait.",
      "Retreat to a safe distance and hover."
    ],
    "success_criteria": [
      "Cloth area appears approximately halved and stacked (folded) compared to start",
      "No unintended displacement off the table",
      "Robot ends clear of the cloth with no collisions"
    ],
    "failure_and_recovery": [
      "If cloth not visible, perform raster scan then detect again",
      "If contact not sensed, re-approach and lower again",
      "If push slips or unfolds, re-align and repeat the push"
    ],
    "termination": "Terminate once the push completes, the robot retreats, and the cloth remains in a folded configuration."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0", "frame_8"],
    "scores": {
      "frame_0": 0.12, "frame_1": 0.34, "frame_2": 0.56, "frame_3": 0.92,
      "frame_4": 0.28, "frame_5": 0.80, "frame_6": 0.49, "frame_7": 0.18, "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "Gripper is at the edge making first stable contact with the cloth.",
        "predicts_next": "A leftward push is expected to start folding.",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "folding a cloth",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7", "frame_8"],
  "objects": ["cloth", "table_surface", "robot_gripper"],
  "objects_from_instruction": ["cloth"],
  "blackboard_keys": [],
  "node_specs": [
    {"id":"OpenGripper","type":"Action","ports":{"width":0.09,"timeout_ms":800},"description":"Ensure gripper is open prior to contact-based folding."},
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"cloth"},"description":"Quick check that the cloth is currently visible."},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"cloth","pattern":"raster","max_attempts":3,"timeout_ms":1500},"description":"Raster scan to localize the cloth if not visible."},
    {"id":"DetectObject","type":"Action","ports":{"target":"cloth","timeout_ms":1200},"description":"Confirm cloth pose after scanning."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"cloth","offset_z":0.05,"timeout_ms":1200},"description":"Hover above cloth before approach; also used to end hovering."},
    {"id":"SetTCPYaw","type":"Action","ports":{"yaw_deg":90},"description":"Align tool yaw with fold direction (left-right)."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"cloth_edge_right","tolerance":0.005,"timeout_ms":1500},"description":"Refine approach to the right edge with tight tolerance."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":0.02,"force_threshold":10.0,"timeout_ms":1200},"description":"Descend gently until contact is sensed."},
    {"id":"Push","type":"Action","ports":{"target":"cloth_edge_right","distance":0.1,"direction_deg":180,"timeout_ms":1500},"description":"Leftward push to fold the cloth over itself."},
    {"id":"Wait","type":"Action","ports":{"timeout_ms":400},"description":"Brief pause to let fabric settle after folding."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":1200},"description":"Back off to a safe distance after the fold."}
  ],
  "tree_stats": {"nodes_total": 15, "actions": 11, "conditions": 1, "depth": 4},
  "failure_modes": [
    "Cloth not detected due to lighting or texture",
    "Contact not achieved (stops above surface)",
    "Push slips, dragging cloth instead of folding",
    "Over-push causing misalignment or unfolding"
  ],
  "recovery_strategy": [
    "Fallback to scan then detect",
    "Re-approach and lower again if contact missing",
    "Re-align yaw and repeat push with same distance",
    "End safely by retreating if repeated failures occur"
  ],
  "assumptions": [
    "Visual evidence shows push-based folding rather than lift-and-place; tree reflects push folding.",
    "Right-edge approach inferred from gripper position on the cloth’s right side.",
    "Single fold suffices; no explicit crease-press step is available in library."
  ],
  "evaluation_notes": {
    "expected_success_criteria": [
      "Final frame(s) show reduced footprint consistent with a single fold",
      "Robot ends clear of the cloth without collisions"
    ],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"cloth","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"cloth","offset_z":0.05,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "approach",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"cloth_edge_right","tolerance":0.005,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "verify",
      "active_leaf": {"id":"LowerUntilContact","attrs":{"speed":"slow","max_depth":0.02,"force_threshold":10.0,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "transfer",
      "active_leaf": {"id":"Push","attrs":{"target":"cloth_edge_right","distance":0.1,"direction_deg":180,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"Push","attrs":{"target":"cloth_edge_right","distance":0.1,"direction_deg":180,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "transfer",
      "active_leaf": {"id":"Wait","attrs":{"timeout_ms":400}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":1200}},
      "active_path_ids": []
    }
  ]
}
