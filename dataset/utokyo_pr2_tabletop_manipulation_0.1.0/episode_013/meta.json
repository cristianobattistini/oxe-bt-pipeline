{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_013",
  "task_summary": "Perceive, grasp a grape from the bunch, move above the plate, place it, and retreat.",
  "task_long_description": {
    "overview": "A PR2-style gripper interacts on a wooden tabletop containing a white plate and a grape bunch. The goal is to pick a grape from the cluster and place it into the plate. The behavior emphasizes reliable perception, gentle grasping, minimal lift, and accurate placement over the plate. The sequence progresses from detection and approach to grasp, transfer, release, and retreat, matching the visual evidence where the gripper approaches the bunch and grapes end up in the plate while the arm withdraws to a safe pose.",
    "preconditions": ["Robot is powered and homed", "Workspace clear except plate and grape bunch", "Gripper calibrated and operational", "Camera view of scene available"],
    "stepwise_plan": ["Open gripper", "Detect grape bunch", "Move above the bunch to pregrasp height", "Compute pinch grasp and align", "Close gripper to grasp", "Verify stability", "Move above the plate", "Lower until contact with plate rim/base", "Open gripper to release grape", "Retreat to safe distance"],
    "success_criteria": ["At least one grape released inside the plate", "No collision with plate rim beyond allowed contact", "Object no longer in gripper after release", "Arm retreats to safe pose"],
    "failure_and_recovery": ["Perception failure → re-detect and slightly change view", "Grasp slip → reopen, recompute grasp, retry", "Contact too early/late → adjust approach height and repeat place", "Obstruction → retreat and re-approach"],
    "termination": "Terminate after successful release and retreat or after exceeding internal retries/timeouts."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0", "frame_8"],
    "scores": {
      "frame_0": 0.12, "frame_1": 0.34, "frame_2": 0.56, "frame_3": 0.92,
      "frame_4": 0.28, "frame_5": 0.80, "frame_6": 0.49, "frame_7": 0.18, "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "first stable contact and alignment cue visible",
        "predicts_next": "push actuation expected; confirms goal direction",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "picking a grape",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7", "frame_8"],
  "objects": ["grape_bunch", "single_grape", "white_plate", "tabletop", "robot_gripper"],
  "objects_from_instruction": ["grape"],
  "blackboard_keys": ["grasp_grape"],
  "node_specs": [
    {"id":"OpenGripper","type":"Action","ports":{"width":"float","timeout_ms":"int"},"description":"Opens gripper to requested width for approach or release."},
    {"id":"DetectObject","type":"Action","ports":{"target":"string","timeout_ms":"int"},"description":"Vision detection of target object."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"string","offset_z":"float","timeout_ms":"int"},"description":"Move to a pose above target by offset_z."},
    {"id":"ComputeGraspPose","type":"Action","ports":{"target":"string","strategy":"string","result_key":"string"},"description":"Compute grasp pose and store key on blackboard."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"string","tolerance":"float","timeout_ms":"int"},"description":"Refine pose and align to grasp within tolerance."},
    {"id":"CloseGripper","type":"Action","ports":{"force":"float","timeout_ms":"int"},"description":"Close gripper with given force to grasp."},
    {"id":"IsGraspStable","type":"Condition","ports":{},"description":"Checks if grasp is secure."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"string","max_depth":"float","force_threshold":"float","timeout_ms":"int"},"description":"Lower tool until contact is detected."},
    {"id":"Retreat","type":"Action","ports":{"distance":"float","timeout_ms":"int"},"description":"Back away from current location for safety."}
  ],
  "tree_stats": {"nodes_total": 12, "actions": 10, "conditions": 1, "depth": 2},
  "failure_modes": ["Object not detected", "Grasp fails or slips", "Collision with plate rim", "Release outside plate", "Excessive contact force"],
  "recovery_strategy": ["Re-run detection", "Recompute grasp and retry", "Adjust approach height and tolerance", "Reposition above plate and repeat place", "Abort and retreat if unsafe"],
  "assumptions": ["Frames indicate placing into the plate after grasp; instruction only says 'picking a grape' so we assume pick-and-place to plate.", "Object labeled generically as 'grape' though visually a bunch is present; grasp likely targets a single grape or small cluster."],
  "evaluation_notes": {
    "expected_success_criteria": ["Grape ends inside plate", "No grape in gripper after release", "Arm clear of workspace at end"],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"grape","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"grape","offset_z":0.02,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "approach",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"grape","tolerance":0.01,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "grasp",
      "active_leaf": {"id":"CloseGripper","attrs":{"force":10,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "transfer",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"plate","offset_z":0.02,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"plate","offset_z":0.02,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "place",
      "active_leaf": {"id":"LowerUntilContact","attrs":{"speed":"slow","max_depth":0.03,"force_threshold":10.0,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "place",
      "active_leaf": {"id":"OpenGripper","attrs":{"width":0.06,"timeout_ms":500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    }
  ]
}
