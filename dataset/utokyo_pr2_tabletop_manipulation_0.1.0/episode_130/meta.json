{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_130",
  "task_summary": "Detect the grape bunch, approach with a pinch grasp, close the gripper to pick it, then move over the plate, release, and retreat.",
  "task_long_description": {
    "overview": "A PR2 arm manipulates on a tabletop with a white plate and a grape bunch. The goal is to pick the grapes and, per visual evidence, place them on the plate. The behavior first ensures perception of the target, computes a pinch grasp, aligns precisely, grasps with moderate force, lifts, moves above the plate, opens the gripper to release, and finally retreats to clear the workspace. Timeouts and tolerances are chosen from allowed bins to ensure reliability.",
    "preconditions": ["Robot and table are static and collision-free", "Grape bunch is on the table and visible to the camera", "Plate is reachable and its symbolic pose 'plate_center' is known", "Gripper is operational"],
    "stepwise_plan": [
      "Open gripper.",
      "Perceive grapes; if not visible, scan then verify visibility.",
      "Compute grasp pose using pinch strategy.",
      "Approach and align with tight tolerance.",
      "Close gripper to grasp and verify stability.",
      "Retreat slightly to lift from table.",
      "Move to plate center.",
      "Open gripper to release onto plate.",
      "Retreat from the placement area."
    ],
    "success_criteria": ["Grapes successfully grasped (ObjectInGripper/IsGraspStable true)", "Grapes released and resting on plate area", "End effector safely clear after placement"],
    "failure_and_recovery": ["If target not visible: scan then re-check visibility", "If grasp fails: perception repeats and re-approach", "If contact instability detected: retreat and recompute grasp"],
    "termination": "Terminate after retreating from the plate following a successful release or after unrecoverable failure."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0", "frame_8"],
    "scores": {
      "frame_0": 0.12, "frame_1": 0.34, "frame_2": 0.56, "frame_3": 0.92,
      "frame_4": 0.28, "frame_5": 0.80, "frame_6": 0.49, "frame_7": 0.18, "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "arm moving away from the table area after grasp, indicating lift/transfer onset",
        "predicts_next": "movement toward the plate is expected after retreat",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "picking a grape",
  "instruction_to_ports": {
    "force": 20,
    "timeout_ms": 1200,
    "tolerance": 0.01,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7", "frame_8"],
  "objects": ["grape", "plate", "table", "robot_gripper"],
  "objects_from_instruction": ["grape"],
  "blackboard_keys": ["grasp_grape"],
  "node_specs": [
    {"id":"OpenGripper","type":"Action","ports":{"width":0.09,"timeout_ms":500},"description":"Open gripper to the specified width before grasping and to release object."},
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"grape"},"description":"Checks if the grape is visible."},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"grape","pattern":"raster","max_attempts":3,"timeout_ms":1200},"description":"Actively scan to locate the grapes if not initially visible."},
    {"id":"ComputeGraspPose","type":"Action","ports":{"target":"grape","strategy":"pinch","result_key":"grasp_grape"},"description":"Compute grasp pose and store on blackboard."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"grasp_grape","tolerance":0.01,"timeout_ms":1200},"description":"Approach computed grasp and align tightly."},
    {"id":"CloseGripper","type":"Action","ports":{"force":20,"timeout_ms":800},"description":"Close gripper with moderate force to grasp grapes."},
    {"id":"IsGraspStable","type":"Condition","ports":{},"description":"Confirms a stable grasp."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":800},"description":"Lift/retreat to clear the table or plate."},
    {"id":"MoveTo","type":"Action","ports":{"target":"plate_center","timeout_ms":1200},"description":"Move above the plate center for placement."}
  ],
  "tree_stats": {"nodes_total": 17, "actions": 9, "conditions": 3, "depth": 4},
  "failure_modes": ["Target not detected due to occlusion", "Grasp slip from smooth grape skin", "Collision with plate rim during approach", "Drop during transfer"],
  "recovery_strategy": ["Fallback to scanning when not visible", "Recompute grasp and re-approach after instability", "Use retreat before re-approach to avoid collisions"],
  "assumptions": ["Although the instruction says 'picking a grape' (singular), frames show pick-and-place of a grape bunch onto a plate; tree includes placement to match frames."],
  "evaluation_notes": {
    "expected_success_criteria": ["Grapes are picked and released onto the plate", "No collisions with table or plate", "Robot ends safely away from objects"],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"IsObjectVisible","attrs":{"target":"grape"}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"grasp_grape","tolerance":0.01,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "grasp",
      "active_leaf": {"id":"CloseGripper","attrs":{"force":20,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "transfer",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "transfer",
      "active_leaf": {"id":"MoveTo","attrs":{"target":"plate_center","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"MoveTo","attrs":{"target":"plate_center","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "place",
      "active_leaf": {"id":"OpenGripper","attrs":{"width":0.09,"timeout_ms":500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "place",
      "active_leaf": {"id":"OpenGripper","attrs":{"width":0.09,"timeout_ms":500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    }
  ]
}
