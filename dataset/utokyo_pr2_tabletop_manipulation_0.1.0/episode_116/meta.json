{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_116",
  "task_summary": "Fold the pink cloth by pressing to establish contact and pushing it to create a visible overlap, then retreat.",
  "task_long_description": {
    "overview": "A PR2 arm interacts with a pink cloth on a wooden tabletop. The goal is to fold the cloth by approaching above it, aligning the end-effector, establishing gentle contact, and pushing the cloth edge to create a fold. The gripper remains open to act as a pusher. The sequence prioritizes robust perception with fallback scanning, careful approach with small tolerance, a slow downward motion until contact, and a leftward push to form the fold before retreating.",
    "preconditions": ["Workspace clear around cloth", "Robot reachable workspace over cloth", "Gripper operational and able to open", "Camera provides view of cloth"],
    "stepwise_plan": [
      "Detect or scan for the cloth.",
      "Move above the cloth with safe vertical offset and open the gripper.",
      "Approach and align to the cloth with tight tolerance.",
      "Lower until contact at slow speed with low force threshold.",
      "Push leftward to fold the cloth.",
      "Retreat slightly and mark fold complete.",
      "Wait briefly to settle."
    ],
    "success_criteria": ["Cloth shows a clear overlapped fold", "No object slippage off table", "End-effector retreats to a safe height/offset"],
    "failure_and_recovery": [
      "If cloth not detected, perform raster scan and retry.",
      "If contact not detected, re-approach and lower again.",
      "If push misaligns, re-align and repeat push."
    ],
    "termination": "Terminate when fold state is set and the arm has retreated after a short wait."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0", "frame_8"],
    "scores": {
      "frame_0": 0.12,
      "frame_1": 0.34,
      "frame_2": 0.56,
      "frame_3": 0.92,
      "frame_4": 0.28,
      "frame_5": 0.80,
      "frame_6": 0.49,
      "frame_7": 0.18,
      "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "first stable contact and alignment cue visible",
        "predicts_next": "push actuation expected; confirms goal direction",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "folding a cloth",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7", "frame_8"],
  "objects": ["cloth", "table", "robot_arm", "gripper"],
  "objects_from_instruction": ["cloth"],
  "blackboard_keys": ["fold_state"],
  "node_specs": [
    {"id":"DetectObject","type":"Action","ports":{"target":"cloth","timeout_ms":1200},"description":"Vision detection of the cloth."},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"cloth","pattern":"raster","max_attempts":3,"timeout_ms":1500},"description":"Fallback raster scan for the cloth."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"cloth","offset_z":0.05,"timeout_ms":1500},"description":"Pre-grasp approach above the cloth."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.09,"timeout_ms":400},"description":"Open gripper to act as a pusher."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"cloth","tolerance":0.01,"timeout_ms":1200},"description":"Align end-effector to push direction."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":0.02,"force_threshold":10,"timeout_ms":1500},"description":"Establish gentle contact with the cloth."},
    {"id":"Push","type":"Action","ports":{"target":"cloth","distance":0.1,"direction_deg":180,"timeout_ms":1500},"description":"Leftward push to fold the cloth."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.05,"timeout_ms":800},"description":"Retreat after folding."},
    {"id":"SetBlackboard","type":"Action","ports":{"key":"fold_state","value":"first_fold_done"},"description":"Mark task progress on blackboard."},
    {"id":"Wait","type":"Action","ports":{"timeout_ms":400},"description":"Short settle time after fold."}
  ],
  "tree_stats": {"nodes_total": 13, "actions": 10, "conditions": 0, "depth": 4},
  "failure_modes": ["Cloth not detected", "Alignment off leading to skewed fold", "No contact registered when lowering", "Push direction too short/long"],
  "recovery_strategy": ["Fallback scan and retry detection", "Re-align and repeat lower-contact", "Repeat push with adjusted distance"],
  "assumptions": ["Fold is achieved via push with open gripper (no grasp). Direction inferred right-to-left from frames. No second fold required."],
  "evaluation_notes": {
    "expected_success_criteria": ["Visible overlap of cloth layers", "Arm ends in safe pose without disturbing fold"],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"cloth","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"cloth","offset_z":0.05,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "verify",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"cloth","tolerance":0.01,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "verify",
      "active_leaf": {"id":"LowerUntilContact","attrs":{"speed":"slow","max_depth":0.02,"force_threshold":10,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "transfer",
      "active_leaf": {"id":"Push","attrs":{"target":"cloth","distance":0.1,"direction_deg":180,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"Push","attrs":{"target":"cloth","distance":0.1,"direction_deg":180,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "transfer",
      "active_leaf": {"id":"Push","attrs":{"target":"cloth","distance":0.1,"direction_deg":180,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "place",
      "active_leaf": {"id":"Wait","attrs":{"timeout_ms":400}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.05,"timeout_ms":800}},
      "active_path_ids": []
    }
  ]
}
