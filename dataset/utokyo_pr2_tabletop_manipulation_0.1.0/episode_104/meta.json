{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_104",
  "task_summary": "Detect the bread, grasp it with a pinch grasp, transfer above the plate, lower until contact, release onto the plate, and retreat.",
  "task_long_description": {
    "overview": "A PR2 end-effector approaches a small bread roll on a cloth-covered table next to a white plate. The robot must perceive the bread, prepare the gripper, align and grasp securely, then move toward the plate. It lowers the grasped bread until contact with the plate surface is detected and releases it, leaving the bread on the plate. Finally, the arm retreats to a safe height. The sequence prioritizes reliable perception and stable grasping with precise alignment around the bread’s long axis.",
    "preconditions": ["Workspace clear with a bread roll and a plate present", "Gripper functional and initially empty", "Perception pipeline able to localize 'bread' and 'plate'", "Robot within reach of both objects"],
    "stepwise_plan": ["Check/Detect bread", "Open gripper and move above bread to pregrasp", "Compute pinch grasp and set yaw 90°", "Approach and align to grasp pose", "Pick and verify grasp stability", "Translate above plate", "Check/Detect plate location", "Lower until contact sensed", "Open gripper to release on plate", "Retreat to a safe distance"],
    "success_criteria": ["Bread is released stably on the plate surface", "No collision with plate rim or table", "Gripper ends in a safe, retracted pose"],
    "failure_and_recovery": ["Perception failure → fall back to DetectObject", "Unstable grasp → reopen, re-approach, and re-Pick", "Early contact while lowering → retreat slightly and retry lowering", "Object slip during transfer → re-detect and re-grasp if visible"],
    "termination": "After releasing the bread on the plate and executing the Retreat action."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0","frame_8"],
    "scores": {
      "frame_0": 0.12,
      "frame_1": 0.34,
      "frame_2": 0.56,
      "frame_3": 0.92,
      "frame_4": 0.28,
      "frame_5": 0.80,
      "frame_6": 0.49,
      "frame_7": 0.18,
      "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "First clear grasp engagement near the bread with aligned gripper jaws.",
        "predicts_next": "Lift/transfer motion likely to follow toward the plate.",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "picking a bread",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7","frame_8"],
  "objects": ["bread", "plate", "table_mat", "robot_gripper"],
  "objects_from_instruction": ["bread"],
  "blackboard_keys": ["bread_grasp"],
  "node_specs": [
    {"id":"DetectObject","type":"Action","ports":{"target":"bread|plate","timeout_ms":1200},"description":"Run perception to localize a target object if not already visible."},
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"bread|plate"},"description":"True if the given object is currently visible to the perception system."},
    {"id":"OpenGripper","type":"Action","ports":{"width":"0.09 or 0.06","timeout_ms":"800 or 400"},"description":"Set gripper opening; wide to prepare, narrow to release."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"bread|plate","offset_z":"0.05–0.06","timeout_ms":1200},"description":"Move to a position vertically above the target with a safe clearance."},
    {"id":"ComputeGraspPose","type":"Action","ports":{"target":"bread","strategy":"pinch","result_key":"bread_grasp"},"description":"Plan a pinch grasp for the bread and store it on the blackboard."},
    {"id":"SetTCPYaw","type":"Action","ports":{"yaw_deg":90},"description":"Rotate tool to align with the bread’s major axis."},
    {"id":"AtOrientation","type":"Condition","ports":{"yaw_deg":90},"description":"Verify the end-effector yaw orientation."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"bread","tolerance":0.005,"timeout_ms":1200},"description":"Refine pose to the computed grasp with tight tolerance."},
    {"id":"Pick","type":"Action","ports":{"grasp_key":"bread_grasp","timeout_ms":800},"description":"Execute the grasp using the planned pose."},
    {"id":"IsGraspStable","type":"Condition","ports":{},"description":"Confirm the object is securely held."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":0.05,"force_threshold":10.0,"timeout_ms":800},"description":"Lower the grasped bread until contact with the plate is detected."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":800},"description":"Back away to a safe standoff after release."}
  ],
  "tree_stats": {"nodes_total": 19, "actions": 12, "conditions": 4, "depth": 3},
  "failure_modes": ["Bread not detected", "Misalignment during grasp", "Grasp slip during transfer", "Premature contact while lowering", "Release failure over plate"],
  "recovery_strategy": ["Fallback to DetectObject when visibility checks fail", "Re-open and re-approach to reattempt Pick", "Slightly retreat and retry lowering if contact is detected too early", "If slip detected, re-detect and loop from MoveAbove(bread)"],
  "assumptions": ["Instruction says 'picking a bread' but frames show transfer and placement onto a plate; the BT follows the visual evidence.", "Yaw 90° chosen to match apparent bread orientation.", "Plate is a safe placement surface; exact plate pose is inferred from detection."],
  "evaluation_notes": {
    "expected_success_criteria": ["Bread ends stably on plate; no collisions; final retreat achieved"],
    "test_scenarios": ["happy path", "object_missing", "grasp_fail", "perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"IsObjectVisible","attrs":{"target":"bread"}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"bread","offset_z":0.05,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "verify",
      "active_leaf": {"id":"AtOrientation","attrs":{"yaw_deg":90}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "grasp",
      "active_leaf": {"id":"Pick","attrs":{"grasp_key":"bread_grasp","timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "transfer",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"plate","offset_z":0.06,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"plate","offset_z":0.06,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "place",
      "active_leaf": {"id":"LowerUntilContact","attrs":{"speed":"slow","max_depth":0.05,"force_threshold":10.0,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "place",
      "active_leaf": {"id":"OpenGripper","attrs":{"width":0.06,"timeout_ms":400}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    }
  ]
}
