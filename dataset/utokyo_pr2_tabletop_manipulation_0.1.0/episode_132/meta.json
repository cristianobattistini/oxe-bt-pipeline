{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_132",
  "task_summary": "Fold the pink cloth on the table by approaching, making gentle contact, and pushing the edge to create a fold, then retreating.",
  "task_long_description": {
    "overview": "A PR2-like robot arm manipulates a pink cloth on a wooden tabletop. The goal is to fold the cloth without lifting it. The arm first perceives the cloth, approaches from above with the gripper open and yaw aligned, verifies contact with the surface, and then executes a controlled push along the clothâ€™s edge to create a fold. After forming the crease, the robot pauses briefly to settle the fabric and retreats to a safe height. Constraints include avoiding excessive force, maintaining orientation during push, and ensuring the workspace remains unobstructed.",
    "preconditions": [
      "Cloth is present on the table within reachable workspace",
      "Vision system can localize the cloth area",
      "Gripper operational and initially open",
      "Table surface clear of other movable obstacles"
    ],
    "stepwise_plan": [
      "Check if the cloth is visible; if not, scan in a raster pattern.",
      "Move above the cloth and align gripper yaw.",
      "Approach and align to the cloth edge with tight tolerance.",
      "Open gripper and descend until contact is detected.",
      "Push the cloth edge to form a fold.",
      "Wait briefly to let fabric settle.",
      "Retreat to a safe distance."
    ],
    "success_criteria": [
      "A visible crease/fold is formed in the cloth",
      "No object collisions or excessive force events",
      "Robot ends in a safe, retracted pose"
    ],
    "failure_and_recovery": [
      "Cloth not detected: perform ScanForTarget and re-approach",
      "Contact not detected: re-approach and lower again",
      "Push slips or misaligns: re-align yaw and repeat push",
      "Unexpected obstacle: abort push and retreat"
    ],
    "termination": "Terminate after successful push-induced fold and retreat to a safe distance."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0","frame_8"],
    "scores": {
      "frame_0": 0.12,
      "frame_1": 0.34,
      "frame_2": 0.56,
      "frame_3": 0.92,
      "frame_4": 0.28,
      "frame_5": 0.80,
      "frame_6": 0.49,
      "frame_7": 0.18,
      "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "first stable contact and alignment cue visible",
        "predicts_next": "push actuation expected; confirms goal direction",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "folding a cloth",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7","frame_8"],
  "objects": ["cloth", "table", "robot_arm"],
  "objects_from_instruction": ["cloth"],
  "blackboard_keys": [],
  "node_specs": [
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"cloth"},"description":"Checks if the cloth is visible."},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"cloth","pattern":"raster","max_attempts":3,"timeout_ms":1200},"description":"Raster scan to localize cloth if not visible."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"cloth","offset_z":0.05,"timeout_ms":800},"description":"Move to a pre-grasp height above the cloth."},
    {"id":"SetTCPYaw","type":"Action","ports":{"yaw_deg":90},"description":"Align gripper yaw perpendicular to push direction."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"cloth_edge","tolerance":0.005,"timeout_ms":800},"description":"Refine approach to the cloth edge with tight tolerance."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.09,"timeout_ms":400},"description":"Open gripper wide to use palm/side for pushing."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":0.03,"force_threshold":10,"timeout_ms":800},"description":"Descend until gentle contact with table/cloth is detected."},
    {"id":"Push","type":"Action","ports":{"target":"cloth_edge","distance":0.1,"direction_deg":180,"timeout_ms":1200},"description":"Push along the edge to create a fold."},
    {"id":"Wait","type":"Action","ports":{"timeout_ms":400},"description":"Brief pause to allow the fabric to settle."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":800},"description":"Back off to a safe distance after folding."}
  ],
  "tree_stats": {"nodes_total": 12, "actions": 9, "conditions": 1, "depth": 3},
  "failure_modes": [
    "Vision fails to localize cloth",
    "No contact detected during descent",
    "Push direction or distance incorrect",
    "Fabric snags causing unintended motion"
  ],
  "recovery_strategy": [
    "Use ScanForTarget fallback and re-approach",
    "Re-align yaw and repeat LowerUntilContact",
    "Adjust push parameters and retry",
    "Abort and retreat if unexpected resistance"
  ],
  "assumptions": [
    "Folding is achieved via a push instead of grasping/lifting, which matches the frames showing side contact.",
    "Single fold suffices; cloth edge is approximated as 'cloth_edge'."
  ],
  "evaluation_notes": {
    "expected_success_criteria": [
      "Visible crease after push",
      "No collision with table edges",
      "Robot returns to safe pose"
    ],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"IsObjectVisible","attrs":{"target":"cloth"}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"cloth","offset_z":0.05,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "approach",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"cloth_edge","tolerance":0.005,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "verify",
      "active_leaf": {"id":"LowerUntilContact","attrs":{"speed":"slow","max_depth":0.03,"force_threshold":10,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "transfer",
      "active_leaf": {"id":"Push","attrs":{"target":"cloth_edge","distance":0.1,"direction_deg":180,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"Push","attrs":{"target":"cloth_edge","distance":0.1,"direction_deg":180,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "place",
      "active_leaf": {"id":"Wait","attrs":{"timeout_ms":400}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    }
  ]
}
