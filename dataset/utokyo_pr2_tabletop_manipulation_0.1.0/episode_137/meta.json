{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_137",
  "task_summary": "Detect the grape, grasp it, lift, move above the plate, place it on the plate, release, and retreat.",
  "task_long_description": {
    "overview": "A PR2 arm manipulates a grape bunch on a tabletop with a plate to the left. The robot must perceive the grape, pre-grasp above it, compute a precise pinch grasp, pick it up, lift, and transfer over the plate. It then places the grape onto the plate, opens the gripper to release, and safely retreats. Motions are gentle and time-bounded; perception fallbacks handle initial object invisibility. The scene contains a light plate, a wooden tabletop, and the PR2 end-effector entering from the right.",
    "preconditions": ["Robot powered and homed", "Workspace clear except plate and grape", "Gripper operational and empty", "Camera providing views of tabletop"],
    "stepwise_plan": [
      "Search/confirm visibility of grape and plate.",
      "Open gripper and move above grape at a small offset.",
      "Compute pinch grasp and execute pick.",
      "Verify object in gripper and lift vertically.",
      "Move above plate at safe height.",
      "Place at plate center and release.",
      "Retreat to clear the plate."
    ],
    "success_criteria": ["Grape is placed stably on the plate", "No collisions with table or plate", "Gripper released item and arm retreated"],
    "failure_and_recovery": [
      "Perception failure: perform spiral scan then re-detect.",
      "Grasp failure: reopen, recompute grasp, and retry pick.",
      "Placement misalignment: re-center above plate and re-place."
    ],
    "termination": "Terminate when grape released on plate and retreat complete."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0","frame_8"],
    "scores": {
      "frame_0": 0.12,
      "frame_1": 0.34,
      "frame_2": 0.56,
      "frame_3": 0.92,
      "frame_4": 0.28,
      "frame_5": 0.80,
      "frame_6": 0.49,
      "frame_7": 0.18,
      "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "first stable contact and alignment cue visible",
        "predicts_next": "push actuation expected; confirms goal direction",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "picking a grape",
  "instruction_to_ports": {
    "force": 10,
    "timeout_ms": 1200,
    "tolerance": 0.005,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7","frame_8"],
  "objects": ["grape", "plate", "table", "robot_gripper"],
  "objects_from_instruction": ["grape"],
  "blackboard_keys": ["grape_grasp", "plate_center"],
  "node_specs": [
    {"id":"ScanForTarget","type":"Action","ports":{"target":"grape","pattern":"spiral","max_attempts":3,"timeout_ms":1500},"description":"Active scan to localize grape when not visible."},
    {"id":"DetectObject","type":"Action","ports":{"target":"grape","timeout_ms":1200},"description":"Detect the grape for pose estimation."},
    {"id":"DetectObject","type":"Action","ports":{"target":"plate","timeout_ms":1200},"description":"Detect the plate for placement."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.06,"timeout_ms":500},"description":"Prepare gripper for grasp."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"grape","offset_z":0.02,"timeout_ms":1500},"description":"Pre-grasp approach above grape."},
    {"id":"ComputeGraspPose","type":"Action","ports":{"target":"grape","strategy":"pinch","result_key":"grape_grasp"},"description":"Compute pinch grasp on grape."},
    {"id":"Pick","type":"Action","ports":{"grasp_key":"grape_grasp","timeout_ms":1200},"description":"Execute grasp using computed key."},
    {"id":"ObjectInGripper","type":"Condition","ports":{"target":"grape"},"description":"Verify grasp succeeded."},
    {"id":"MoveDelta","type":"Action","ports":{"axis":"z","dist":0.1,"timeout_ms":1200},"description":"Lift the object vertically."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"plate","offset_z":0.02,"timeout_ms":1500},"description":"Move above target plate."},
    {"id":"PlaceAt","type":"Action","ports":{"pose_key":"plate_center","yaw_deg":0,"press_force":10,"timeout_ms":1200},"description":"Place grape at plate center."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.09,"timeout_ms":500},"description":"Release grape."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":1200},"description":"Retreat to clear workspace."},
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"grape"},"description":"Check grape visibility."},
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"plate"},"description":"Check plate visibility."}
  ],
  "tree_stats": {"nodes_total": 19, "actions": 12, "conditions": 3, "depth": 4},
  "failure_modes": ["Grape not detected", "Occluded grasp approach", "Slippage after grasp", "Misplacement on plate"],
  "recovery_strategy": [
    "Re-scan with spiral pattern and re-detect.",
    "Reopen gripper, recompute grasp, and retry pick.",
    "If slippage detected, lower and re-grasp.",
    "If placement off-center, move above plate center and re-place."
  ],
  "assumptions": [
    "Frames indicate not only picking but also transferring and placing onto a plate; instruction says 'picking a grape'. We prioritized visual evidence and included a place step.",
    "Using symbolic keys 'grape_grasp' and 'plate_center' for blackboard storage."
  ],
  "evaluation_notes": {
    "expected_success_criteria": ["Grape ends on plate; arm retreats; no collisions"],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"grape","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"grape","offset_z":0.02,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "verify",
      "active_leaf": {"id":"ComputeGraspPose","attrs":{"target":"grape","strategy":"pinch","result_key":"grape_grasp"}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "grasp",
      "active_leaf": {"id":"Pick","attrs":{"grasp_key":"grape_grasp","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "transfer",
      "active_leaf": {"id":"MoveDelta","attrs":{"axis":"z","dist":0.1,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"plate","offset_z":0.02,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "place",
      "active_leaf": {"id":"PlaceAt","attrs":{"pose_key":"plate_center","yaw_deg":0,"press_force":10,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "place",
      "active_leaf": {"id":"OpenGripper","attrs":{"width":0.09,"timeout_ms":500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":1200}},
      "active_path_ids": []
    }
  ]
}
