{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_091",
  "task_summary": "Detect a grape, approach with precision, compute a pinch grasp, pick it up, and retreat.",
  "task_long_description": {
    "overview": "A PR2-style gripper interacts with a small grape (part of a cluster) on a plate placed on a tabletop. The robot must visually locate the grape, approach from above, align precisely, compute a pinch grasp, and pick it up. The scene shows a round plate, a grape cluster, and the robot arm moving in from the upper-right. The behavior emphasizes reliable perception with a scan fallback, tight alignment for small objects, and a safe retreat after grasp.",
    "preconditions": ["Workspace clear around plate", "Grape visible or discoverable via scan", "Gripper operational and initially open"],
    "stepwise_plan": ["Open gripper", "Detect the grape; if not immediately visible, scan", "Move above target with small vertical offset", "Approach and align with tight tolerance", "Compute pinch grasp pose", "Execute pick using computed pose", "Verify object is held", "Retreat upward/away"],
    "success_criteria": ["Grape securely held in gripper", "No collision with plate or table", "Arm safely retreats after grasp"],
    "failure_and_recovery": ["If detection fails, perform spiral scan", "If alignment times out, re-detect and re-approach", "If pick fails, reopen gripper and retry full sequence"],
    "termination": "Tree succeeds when the grape is detected, grasped, verified in gripper, and the arm has retreated."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0","frame_8"],
    "scores": {
      "frame_0": 0.12, "frame_1": 0.34, "frame_2": 0.56, "frame_3": 0.92,
      "frame_4": 0.28, "frame_5": 0.80, "frame_6": 0.49, "frame_7": 0.18, "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "End-effector centered over plate with alignment cues; close to contact.",
        "predicts_next": "Grasp execution should follow, confirming goal direction.",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "picking a grape",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7","frame_8"],
  "objects": ["grape", "grape_cluster", "plate", "table", "pr2_gripper"],
  "objects_from_instruction": ["grape"],
  "blackboard_keys": ["grasp_pose_grape"],
  "node_specs": [
    {"id":"OpenGripper","type":"Action","ports":{"width":0.06,"timeout_ms":800},"description":"Open fingers to minimum width for precise approach."},
    {"id":"DetectObject","type":"Action","ports":{"target":"grape","timeout_ms":1200},"description":"Try to detect the grape in the scene."},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"grape","pattern":"spiral","max_attempts":3,"timeout_ms":1500},"description":"Active scan fallback to locate grape if initial detection fails."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"grape","offset_z":0.02,"timeout_ms":1200},"description":"Move to a pregrasp pose slightly above the grape."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"grape","tolerance":0.0,"timeout_ms":1500},"description":"Refine alignment with tight tolerance before grasp."},
    {"id":"ComputeGraspPose","type":"Action","ports":{"target":"grape","strategy":"pinch","result_key":"grasp_pose_grape"},"description":"Compute a pinch grasp and store it on the blackboard."},
    {"id":"Pick","type":"Action","ports":{"grasp_key":"grasp_pose_grape","timeout_ms":1500},"description":"Execute the grasp using stored pose; closes gripper as needed."},
    {"id":"ObjectInGripper","type":"Condition","ports":{"target":"grape"},"description":"Verify grape is held after pick."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":800},"description":"Back off safely from the plate after grasp."}
  ],
  "tree_stats": {"nodes_total": 11, "actions": 8, "conditions": 1, "depth": 3},
  "failure_modes": ["Object not detected", "Misalignment with small target", "Slippage during grasp", "Collision with plate rim"],
  "recovery_strategy": ["Fallback scan for detection", "Re-approach with tight tolerance", "Recompute grasp and retry pick", "Abort and retreat on contact overload (external safety)"],
  "assumptions": ["Frames show a grape cluster on a plate; instruction mentions a single grape. We assume picking one grape from the cluster. The retreat motion represents lifting/withdrawing, not a placement."],
  "evaluation_notes": {
    "expected_success_criteria": ["ObjectInGripper returns success", "No timeouts on approach/grasp", "Final Retreat completes without contact"],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"grape","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "perceive",
      "active_leaf": {"id":"ScanForTarget","attrs":{"target":"grape","pattern":"spiral","max_attempts":3,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"grape","offset_z":0.02,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "verify",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"grape","tolerance":0.0,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "verify",
      "active_leaf": {"id":"ComputeGraspPose","attrs":{"target":"grape","strategy":"pinch","result_key":"grasp_pose_grape"}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "grasp",
      "active_leaf": {"id":"Pick","attrs":{"grasp_key":"grasp_pose_grape","timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "transfer",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    }
  ]
}
