{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_164",
  "task_summary": "Detect and grasp the bread, lift it, move above the plate, place it at the center, release, and retreat.",
  "task_long_description": {
    "overview": "A PR2 end-effector interacts with a small bread-like item and a white plate on a green mat. The goal is to locate the bread, grasp it with a gentle pinch, lift to a safe height, move above the plate, and place it at the plate center before retreating. Visual evidence suggests the bread ends on the plate with the gripper retracted. The tree includes a visibility fallback (check or scan) and verification of grasp stability before transfer.",
    "preconditions": [
      "Bread and plate are within reachable workspace",
      "Plate surface is unobstructed",
      "Camera provides view of bread",
      "Gripper initialized and homed"
    ],
    "stepwise_plan": [
      "Open gripper and confirm/scan visibility of bread",
      "Detect bread and move to a pregrasp height above it",
      "Compute grasp pose, align, lower until contact",
      "Execute pick and verify grasp stability",
      "Lift and move above plate",
      "Place at plate center, open gripper, and retreat"
    ],
    "success_criteria": [
      "Bread rests centered on plate",
      "No object in gripper after release",
      "Gripper safely retracted from plate area"
    ],
    "failure_and_recovery": [
      "If bread not visible, scan pattern to reacquire",
      "If grasp fails, reopen gripper and reattempt from pregrasp",
      "If contact too early with plate, raise and realign before placing"
    ],
    "termination": "Terminate after successful release on the plate and retreat movement completes."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0","frame_8"],
    "scores": {
      "frame_0": 0.12,
      "frame_1": 0.34,
      "frame_2": 0.56,
      "frame_3": 0.92,
      "frame_4": 0.28,
      "frame_5": 0.80,
      "frame_6": 0.49,
      "frame_7": 0.18,
      "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "Bread aligned near plate with gripper low, consistent with grasp/lift transition.",
        "predicts_next": "Upward motion then transfer over the plate.",
        "uncertainty_reduction": "high"
      },
      "frame_5": {
        "now_evidence": "Arm and bread are centered above plate, indicating transfer phase.",
        "predicts_next": "Lowering and placement."
      },
      "frame_2": {
        "now_evidence": "Approach and alignment above bread are visible.",
        "predicts_next": "Descent to contact and grasp."
      }
    }
  },
  "task_instruction": "picking a bread",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7","frame_8"],
  "objects": ["bread", "plate", "table_mat", "pr2_gripper"],
  "objects_from_instruction": ["bread"],
  "blackboard_keys": ["grasp_bread", "plate_center"],
  "node_specs": [
    {"id":"OpenGripper","type":"Action","ports":{"width":0.09,"timeout_ms":800},"description":"Prepare gripper for approach."},
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"bread"},"description":"Check if bread is currently visible."},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"bread","pattern":"raster","max_attempts":3,"timeout_ms":1500},"description":"Scan to reacquire bread if not visible."},
    {"id":"DetectObject","type":"Action","ports":{"target":"bread","timeout_ms":1200},"description":"Detect and localize bread."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"bread","offset_z":0.06,"timeout_ms":1200},"description":"Move to pregrasp height above bread."},
    {"id":"ComputeGraspPose","type":"Action","ports":{"target":"bread","strategy":"pinch","result_key":"grasp_bread"},"description":"Compute grasp parameters for bread."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"bread","tolerance":0.005,"timeout_ms":1500},"description":"Precisely align before descent."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":0.02,"force_threshold":10.0,"timeout_ms":1200},"description":"Lower until light contact is sensed."},
    {"id":"Pick","type":"Action","ports":{"grasp_key":"grasp_bread","timeout_ms":1200},"description":"Close and secure the grasp using computed key."},
    {"id":"IsGraspStable","type":"Condition","ports":{},"description":"Verify grasp stability before transport."},
    {"id":"MoveDelta","type":"Action","ports":{"axis":"z","dist":0.1,"timeout_ms":800},"description":"Lift the bread after grasp."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"plate","offset_z":0.08,"timeout_ms":1200},"description":"Move above the plate for placement."},
    {"id":"PlaceAt","type":"Action","ports":{"pose_key":"plate_center","yaw_deg":0,"press_force":10.0,"timeout_ms":1200},"description":"Place the bread on the plate center."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.08,"timeout_ms":800},"description":"Release the bread."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":800},"description":"Back away safely from the plate."}
  ],
  "tree_stats": {"nodes_total": 17, "actions": 13, "conditions": 2, "depth": 3},
  "failure_modes": [
    "Bread not detected due to occlusion or lighting",
    "Misalignment causes failed grasp",
    "Object slips during lift",
    "Collision with plate edge during placement"
  ],
  "recovery_strategy": [
    "Fallback scan when target not visible",
    "Reopen gripper, move above pregrasp, and retry pick",
    "If slip detected, lower and regrasp",
    "If collision risk, raise, re-center above plate, and place again"
  ],
  "assumptions": [
    "Frames show bread ending on the plate; instruction says 'picking a bread'. Tree covers pick-and-place to match visual evidence.",
    "Plate center is abstracted as pose_key 'plate_center'.",
    "Gentle forces assumed appropriate for soft food; low press_force used."
  ],
  "evaluation_notes": {
    "expected_success_criteria": [
      "Bread placed on plate and not in gripper",
      "No excessive force applied",
      "No collisions with plate or environment"
    ],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"bread","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"bread","offset_z":0.06,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "approach",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"bread","tolerance":0.005,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "grasp",
      "active_leaf": {"id":"Pick","attrs":{"grasp_key":"grasp_bread","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "transfer",
      "active_leaf": {"id":"MoveDelta","attrs":{"axis":"z","dist":0.1,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"plate","offset_z":0.08,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "place",
      "active_leaf": {"id":"PlaceAt","attrs":{"pose_key":"plate_center","yaw_deg":0,"press_force":10.0,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "place",
      "active_leaf": {"id":"OpenGripper","attrs":{"width":0.08,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    }
  ]
}
