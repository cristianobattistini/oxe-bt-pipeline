{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_055",
  "task_summary": "Detect, grasp, and move a grape, then release it over the plate and retreat.",
  "task_long_description": {
    "overview": "A PR2 end-effector approaches a small cluster of grapes on a tabletop beside a shiny plate. The robot must perceive the grape target, approach from above with a gentle pinch grasp, secure the item, and transfer it toward the plate area visible in the contact sheet. After positioning over the plate, it lowers until contact, releases, and safely retreats. The plan emphasizes reliable perception, careful grasping to avoid squashing soft fruit, and a clean hand-off to the plate as suggested by the later frames.",
    "preconditions": [
      "Workspace is clear with plate and grapes on table",
      "Gripper functional and calibrated",
      "Camera provides view of workspace",
      "Plate pose reachable"
    ],
    "stepwise_plan": [
      "If grapes are not immediately visible, perform a short spiral scan.",
      "Detect the grape target.",
      "Open the gripper and move above the grape with a small vertical offset.",
      "Compute a pinch grasp pose and execute the pick.",
      "Verify grasp stability.",
      "Move above the plate and lower until contact is sensed.",
      "Open gripper to release the grape onto the plate.",
      "Retreat to a safe height."
    ],
    "success_criteria": [
      "A grape is securely grasped without slippage",
      "Grape is released over the plate surface",
      "Arm ends in a safe, non-interfering pose"
    ],
    "failure_and_recovery": [
      "Perception failure: trigger spiral ScanForTarget and re-detect",
      "Grasp failure: reopen gripper, recompute grasp, and retry pick",
      "Object dropped mid-transfer: re-detect new grape location and re-plan",
      "Contact too early/late over plate: adjust approach and reattempt lower-until-contact"
    ],
    "termination": "Terminate after successful release onto the plate followed by a retreat motion, or after recovery attempts are exhausted."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0", "frame_8"],
    "scores": {
      "frame_0": 0.12, "frame_1": 0.34, "frame_2": 0.56, "frame_3": 0.92,
      "frame_4": 0.28, "frame_5": 0.80, "frame_6": 0.49, "frame_7": 0.18, "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "First clear engagement over the plate area with end-effector aligned, indicating post-grasp transition.",
        "predicts_next": "Lowering or releasing action expected directly after alignment.",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "picking a grape",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7", "frame_8"],
  "objects": ["grape", "plate", "table", "robot_gripper"],
  "objects_from_instruction": ["grape"],
  "blackboard_keys": ["grasp_grape"],
  "node_specs": [
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"grape"},"description":"Checks if the grape is visible."},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"grape","pattern":"spiral","max_attempts":3,"timeout_ms":1500},"description":"Active search when grapes are not visible."},
    {"id":"DetectObject","type":"Action","ports":{"target":"grape","timeout_ms":1200},"description":"Detect grape and update perception."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.09,"timeout_ms":800},"description":"Prepare gripper for grasp."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"grape","offset_z":0.05,"timeout_ms":1200},"description":"Pregrasp approach from above the grape."},
    {"id":"ComputeGraspPose","type":"Action","ports":{"target":"grape","strategy":"pinch","result_key":"grasp_grape"},"description":"Compute grasp pose for a delicate fruit."},
    {"id":"Pick","type":"Action","ports":{"grasp_key":"grasp_grape","timeout_ms":1500},"description":"Execute picking motion using computed grasp."},
    {"id":"IsGraspStable","type":"Condition","ports":{},"description":"Verify grasp stability before transfer."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"plate","offset_z":0.05,"timeout_ms":1200},"description":"Move above plate for placement."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":0.02,"force_threshold":10.0,"timeout_ms":1200},"description":"Lower gently to plate height."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.08,"timeout_ms":800},"description":"Release grape onto plate."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":800},"description":"Back off to a safe pose."}
  ],
  "tree_stats": {"nodes_total": 14, "actions": 10, "conditions": 2, "depth": 3},
  "failure_modes": [
    "Object not detected due to glare or occlusion",
    "Pinch grasp slips on smooth grape skin",
    "Collision with plate rim during lowering",
    "Premature release above table instead of plate"
  ],
  "recovery_strategy": [
    "Invoke spiral scan and re-detect",
    "Reopen gripper, recompute grasp, retry pick",
    "Raise slightly, re-align, and reattempt lowering",
    "Re-detect dropped grape and restart transfer"
  ],
  "assumptions": [
    "Frames suggest transfer to the plate after grasp; instruction only states 'picking a grape'. We prioritize visual evidence and model the deposit onto the plate.",
    "Target may be a small cluster; we treat it as a single 'grape' for symbolic naming."
  ],
  "evaluation_notes": {
    "expected_success_criteria": [
      "Grape grasped stably and released over plate with arm safely retreated"
    ],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"grape","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"grape","offset_z":0.05,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "verify",
      "active_leaf": {"id":"ComputeGraspPose","attrs":{"target":"grape","strategy":"pinch","result_key":"grasp_grape"}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "grasp",
      "active_leaf": {"id":"Pick","attrs":{"grasp_key":"grasp_grape","timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "transfer",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"plate","offset_z":0.05,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"LowerUntilContact","attrs":{"speed":"slow","max_depth":0.02,"force_threshold":10.0,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "place",
      "active_leaf": {"id":"OpenGripper","attrs":{"width":0.08,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    }
  ]
}
