{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_066",
  "task_summary": "Detect the grape bunch on the plate, approach from above with precise alignment, compute a pinch grasp, pick a grape, verify the grasp, and retreat.",
  "task_long_description": {
    "overview": "A PR2 arm must pick a grape from a bunch resting on a plate placed on a tabletop. The sequence begins with visual detection, then a safe approach from above to avoid collisions with the plate rim. The robot computes a pinch grasp suitable for a small, slippery object, executes the pick, verifies object retention, and retreats to a safe height. Movements emphasize precise alignment and short timeouts typical of tabletop manipulation with small objects.",
    "preconditions": ["Workspace is clear except for a plate with grapes", "Gripper operational and initially empty", "Camera provides view of the plate area", "Controller gains tuned for slow approach"],
    "stepwise_plan": ["Detect grape target", "Open gripper", "Move above target with safe vertical offset", "Approach and align precisely", "Compute pinch grasp and store key", "Execute pick", "Verify object in gripper and stability", "Retreat to safe distance"],
    "success_criteria": ["A grape is held securely in the gripper", "No collision with plate or table", "Robot retreats to a safe pose after grasp"],
    "failure_and_recovery": ["If detection fails, retry detection up to three times", "If alignment fails, re-approach from above", "If grasp slips, reopen and recompute grasp, then retry", "If contact forces rise unexpectedly, abort and lift"],
    "termination": "Terminate when a stable grasp is confirmed and the arm has retreated to a safe distance."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0", "frame_8"],
    "scores": {
      "frame_0": 0.12, "frame_1": 0.34, "frame_2": 0.56, "frame_3": 0.92,
      "frame_4": 0.28, "frame_5": 0.80, "frame_6": 0.49, "frame_7": 0.18, "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "arm closely aligned above plate edge indicating imminent grasp alignment over grapes",
        "predicts_next": "descent and grasp actuation are expected",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "picking a grape",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7", "frame_8"],
  "objects": ["grape_bunch", "single_grape", "plate", "tabletop", "robot_arm", "gripper"],
  "objects_from_instruction": ["grape"],
  "blackboard_keys": ["grasp_grape"],
  "node_specs": [
    {"id":"DetectObject","type":"Action","ports":{"target":"grape","timeout_ms":800},"description":"Vision detection of the grape target."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.08,"timeout_ms":400},"description":"Prepare gripper aperture for grasp."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"grape","offset_z":0.05,"timeout_ms":1200},"description":"Move to a pregrasp pose above the target."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"grape","tolerance":0.005,"timeout_ms":1200},"description":"Refine alignment before grasping."},
    {"id":"ComputeGraspPose","type":"Action","ports":{"target":"grape","strategy":"pinch","result_key":"grasp_grape"},"description":"Compute pinch grasp and write key to blackboard."},
    {"id":"Pick","type":"Action","ports":{"grasp_key":"grasp_grape","timeout_ms":1500},"description":"Execute the grasp using the computed pose."},
    {"id":"ObjectInGripper","type":"Condition","ports":{"target":"grape"},"description":"Check that a grape is detected in the gripper."},
    {"id":"IsGraspStable","type":"Condition","ports":{},"description":"Verify grasp stability (no slip)."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":800},"description":"Retreat to a safe height after grasp."}
  ],
  "tree_stats": {"nodes_total": 11, "actions": 7, "conditions": 2, "depth": 3},
  "failure_modes": ["Object not detected due to glare on plate", "Collision with plate rim during approach", "Pinch grasp slips on smooth grape skin", "Timeout before completing pick"],
  "recovery_strategy": ["Retry detection (decorator) and adjust view if needed", "Re-approach from higher offset_z and re-align", "Re-open, recompute grasp, and retry", "Abort and retreat if unexpected contact is detected"],
  "assumptions": ["Frames show a grape bunch on a plate; instruction asks for a single grape. We interpret the goal as picking one grape from the bunch.", "No explicit placement location is visible; task ends after retreat with a stable grasp."],
  "evaluation_notes": {
    "expected_success_criteria": ["Stable pinch grasp of one grape", "No visible disturbance to plate", "Retreat completed within timeout bins"],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"grape","timeout_ms":800}},
      "active_path_ids": ["Sequence","RetryUntilSuccessful","DetectObject"]
    },
    {
      "frame": "frame_1",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"grape","timeout_ms":800}},
      "active_path_ids": ["Sequence","RetryUntilSuccessful","DetectObject"]
    },
    {
      "frame": "frame_2",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"grape","offset_z":0.05,"timeout_ms":1200}},
      "active_path_ids": ["Sequence","MoveAbove"]
    },
    {
      "frame": "frame_3",
      "phase": "approach",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"grape","tolerance":0.005,"timeout_ms":1200}},
      "active_path_ids": ["Sequence","ApproachAndAlign"]
    },
    {
      "frame": "frame_4",
      "phase": "verify",
      "active_leaf": {"id":"ComputeGraspPose","attrs":{"target":"grape","strategy":"pinch","result_key":"grasp_grape"}},
      "active_path_ids": ["Sequence","ComputeGraspPose"]
    },
    {
      "frame": "frame_5",
      "phase": "grasp",
      "active_leaf": {"id":"Pick","attrs":{"grasp_key":"grasp_grape","timeout_ms":1500}},
      "active_path_ids": ["Sequence","Pick"]
    },
    {
      "frame": "frame_6",
      "phase": "transfer",
      "active_leaf": {"id":"ObjectInGripper","attrs":{"target":"grape"}},
      "active_path_ids": ["Sequence","ObjectInGripper"]
    },
    {
      "frame": "frame_7",
      "phase": "transfer",
      "active_leaf": {"id":"IsGraspStable","attrs":{}},
      "active_path_ids": ["Sequence","IsGraspStable"]
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": ["Sequence","Retreat"]
    }
  ]
}
