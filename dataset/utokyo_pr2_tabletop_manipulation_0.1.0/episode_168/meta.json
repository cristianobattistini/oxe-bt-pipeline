{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_168",
  "task_summary": "Detect the grapes on a small plate, approach from above, align, gently grasp with a pinch, verify stability, and retreat with the grapes.",
  "task_long_description": {
    "overview": "A PR2-style arm must pick grapes from a small white plate on a wooden tabletop. The contact sheet shows the end effector approaching from the right, descending over the plate, making contact with the grape cluster, and then lifting away. The plan emphasizes gentle force appropriate for delicate fruit, precise alignment, and a short stabilization pause before retreating. The robot maintains a symbolic grasp pose on the blackboard and verifies object capture prior to leaving the work area.",
    "preconditions": ["Robot powered and homed", "Workspace clear except plate and grapes", "Camera provides view of plate area", "Gripper operational and empty"],
    "stepwise_plan": [
      "Perceive or detect the grapes on the plate.",
      "Move above the target and compute a pinch grasp pose.",
      "Verify the grasp pose is available; align precisely.",
      "Open the gripper, descend until contact, and close with low force.",
      "Check grasp stability, wait briefly, then verify object in gripper.",
      "Retreat vertically away from the plate."
    ],
    "success_criteria": ["Grapes securely held in gripper", "No collision with plate edge or table", "Retreat distance achieved", "Perception and alignment completed within timeouts"],
    "failure_and_recovery": [
      "Perception fails: retry DetectObject via Fallback path.",
      "Misalignment: ApproachAndAlign returns failure; re-run approach.",
      "Weak grasp: IsGraspStable fails; reopen and retry sequence.",
      "Contact not sensed: abort descent by timeout and back off."
    ],
    "termination": "Tree ends after a stable grasp is verified and the robot retreats to a safe height."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0", "frame_8"],
    "scores": {
      "frame_0": 0.12, "frame_1": 0.34, "frame_2": 0.56, "frame_3": 0.92,
      "frame_4": 0.28, "frame_5": 0.80, "frame_6": 0.49, "frame_7": 0.18, "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "first stable contact and alignment cue visible",
        "predicts_next": "push actuation expected; confirms goal direction",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "picking a grape",
  "instruction_to_ports": {
    "force": 10,
    "timeout_ms": 800,
    "tolerance": 0.01,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7", "frame_8"],
  "objects": ["grape cluster","plate","table","robot gripper"],
  "objects_from_instruction": ["grape"],
  "blackboard_keys": ["grasp_grape"],
  "node_specs": [
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"grape"},"description":"Quick check if grapes are already visible."},
    {"id":"DetectObject","type":"Action","ports":{"target":"grape","timeout_ms":800},"description":"Perceive grapes if not already visible."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"grape","offset_z":0.05,"timeout_ms":1200},"description":"Move to a safe pregrasp height above grapes."},
    {"id":"ComputeGraspPose","type":"Action","ports":{"target":"grape","strategy":"pinch","result_key":"grasp_grape"},"description":"Compute pinch grasp pose for grapes and store on blackboard."},
    {"id":"PoseAvailable","type":"Condition","ports":{"key":"grasp_grape"},"description":"Verify grasp pose exists before proceeding."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"grape","tolerance":0.01,"timeout_ms":1500},"description":"Align end effector to grasp pose."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.06,"timeout_ms":500},"description":"Prepare gripper opening for delicate grasp."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":0.03,"force_threshold":5.0,"timeout_ms":1200},"description":"Descend gently until contact with grapes/plate vicinity."},
    {"id":"CloseGripper","type":"Action","ports":{"force":10,"timeout_ms":800},"description":"Close with low force suitable for grapes."},
    {"id":"IsGraspStable","type":"Condition","ports":{},"description":"Check grasp stability."},
    {"id":"Wait","type":"Action","ports":{"timeout_ms":400},"description":"Brief stabilization hold."},
    {"id":"ObjectInGripper","type":"Condition","ports":{"target":"grape"},"description":"Confirm grapes are held."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":1200},"description":"Back off vertically to a safe height."}
  ],
  "tree_stats": {"nodes_total": 15, "actions": 9, "conditions": 4, "depth": 3},
  "failure_modes": ["Object not detected", "Collision with plate edge", "Insufficient closing force causing drop", "Over-descent contacting plate", "Perception noise causing misalignment"],
  "recovery_strategy": ["Re-run DetectObject via Fallback", "Abort and move above before re-approach", "Re-open and re-grasp with same plan", "Stop descent on timeout and retry", "Short wait then retry alignment"],
  "assumptions": ["Frames suggest a small grape cluster rather than a single grape; instruction says 'a grape'â€”we assume grasp of the cluster is acceptable.", "Contact cues in frames are interpreted as gentle descent before closing."],
  "evaluation_notes": {
    "expected_success_criteria": ["Grapes securely in gripper", "No visible plate displacement", "Retreat completed without collision"],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"grape","timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"grape","offset_z":0.05,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "approach",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"grape","tolerance":0.01,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "approach",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"grape","tolerance":0.01,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "verify",
      "active_leaf": {"id":"PoseAvailable","attrs":{"key":"grasp_grape"}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "grasp",
      "active_leaf": {"id":"OpenGripper","attrs":{"width":0.06,"timeout_ms":500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "grasp",
      "active_leaf": {"id":"CloseGripper","attrs":{"force":10,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "transfer",
      "active_leaf": {"id":"Wait","attrs":{"timeout_ms":400}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":1200}},
      "active_path_ids": []
    }
  ]
}
