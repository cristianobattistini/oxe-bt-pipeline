{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_026",
  "task_summary": "Detect the cloth, grasp one edge, lift and fold it over by a lateral motion, release and flatten, then retreat.",
  "task_long_description": {
    "overview": "A PR2 end-effector manipulates a pink cloth on a wooden tabletop. The goal is to fold the cloth by grasping an edge, lifting slightly, translating laterally to bring the edge over itself, and then releasing. The sequence emphasizes reliable perception, gentle contact, and short vertical motions to avoid dragging. After placement, a brief wipe helps flatten the folded cloth. The robot should finish by retreating to clear the workspace.",
    "preconditions": ["Workspace clear and reachable", "Cloth visible on table", "Gripper operational and empty", "Calibration valid for camera-to-arm"],
    "stepwise_plan": ["Detect cloth location", "Open gripper and move above target edge", "Align to edge and touch down lightly", "Close gripper to pinch edge", "Lift slightly", "Translate laterally to fold", "Lower and release", "Optionally wipe to flatten", "Retreat from workspace"],
    "success_criteria": ["Cloth shows a clear fold line", "No slippage during transport", "Gripper released without snags", "End-effector safely clear of cloth at end"],
    "failure_and_recovery": ["If detection fails, rescan area", "If contact not detected, retry approach", "If grasp slips, reopen and regrasp", "If fold not complete, repeat lateral move and wipe"],
    "termination": "Terminate when release, optional wipe, and retreat succeed without errors."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_6","frame_2","frame_4","frame_1","frame_7","frame_0","frame_8"],
    "scores": {
      "frame_0": 0.18, "frame_1": 0.42, "frame_2": 0.60, "frame_3": 0.90,
      "frame_4": 0.55, "frame_5": 0.82, "frame_6": 0.78, "frame_7": 0.30, "frame_8": 0.10
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "Tool is at the cloth edge with first contact imminent, indicating grasp setup.",
        "predicts_next": "Successful contact implies closing gripper and lifting will follow.",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "folding a cloth",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7", "frame_8"],
  "objects": ["pink_cloth", "table", "pr2_gripper"],
  "objects_from_instruction": ["cloth"],
  "blackboard_keys": [],
  "node_specs": [
    {"id":"DetectObject","type":"Action","ports":{"target":"cloth","timeout_ms":1500},"description":"Locate the cloth on the table."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.08,"timeout_ms":800},"description":"Prepare to grasp the cloth edge."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"cloth_edge","offset_z":0.05,"timeout_ms":1500},"description":"Move to a pregrasp pose above the cloth edge."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"cloth_edge","tolerance":0.005,"timeout_ms":1500},"description":"Align gripper with the edge before touching."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":0.02,"force_threshold":10,"timeout_ms":1200},"description":"Gently descend until contact with the cloth."},
    {"id":"CloseGripper","type":"Action","ports":{"force":10,"timeout_ms":800},"description":"Pinch the cloth edge to secure grasp."},
    {"id":"MoveDelta","type":"Action","ports":{"axis":"z","dist":0.05,"timeout_ms":1200},"description":"Lift slightly to clear the table."},
    {"id":"MoveDelta","type":"Action","ports":{"axis":"y","dist":0.15,"timeout_ms":1500},"description":"Translate laterally to fold the cloth over."},
    {"id":"MoveDelta","type":"Action","ports":{"axis":"z","dist":-0.05,"timeout_ms":1200},"description":"Lower the grasped edge to place the fold."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.09,"timeout_ms":800},"description":"Release the cloth to complete the fold."},
    {"id":"WipeArea","type":"Action","ports":{"area_id":"cloth","pattern":"line","passes":1,"timeout_ms":1500},"description":"Flatten the fold with a short wipe."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":1500},"description":"Back off to clear the workspace."}
  ],
  "tree_stats": {"nodes_total": 13, "actions": 12, "conditions": 0, "depth": 2},
  "failure_modes": ["Cloth not detected", "Misalignment causes missed edge", "Grasp slippage", "Fold undone during release"],
  "recovery_strategy": ["Re-run detection and re-approach", "Retry alignment with tighter tolerance", "Reopen, regrasp at a new point", "Repeat lateral move and wipe"],
  "assumptions": ["Edge grasp and lateral translation are adequate for folding; negative MoveDelta distances are supported; frames suggest approach→grasp→move→release despite limited visibility of the wipe step."],
  "evaluation_notes": {
    "expected_success_criteria": ["Visible half-fold with edges overlapped", "No dragging damage", "End-effector clear after retreat"],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"cloth","timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"cloth_edge","offset_z":0.05,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "verify",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"cloth_edge","tolerance":0.005,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "grasp",
      "active_leaf": {"id":"LowerUntilContact","attrs":{"speed":"slow","max_depth":0.02,"force_threshold":10,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "grasp",
      "active_leaf": {"id":"CloseGripper","attrs":{"force":10,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"MoveDelta","attrs":{"axis":"z","dist":0.05,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "transfer",
      "active_leaf": {"id":"MoveDelta","attrs":{"axis":"y","dist":0.15,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "place",
      "active_leaf": {"id":"OpenGripper","attrs":{"width":0.09,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":1500}},
      "active_path_ids": []
    }
  ]
}
