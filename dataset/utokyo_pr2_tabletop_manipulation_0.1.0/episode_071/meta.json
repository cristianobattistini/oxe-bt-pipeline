{
  "dataset_id": "utokyo_pr2_tabletop_manipulation_0.1.0",
  "episode_id": "episode_071",
  "task_summary": "Detect the grape, approach with precise alignment, gently grasp, and lift/retreat while confirming the grape is held.",
  "task_long_description": {
    "overview": "A PR2 end-effector picks a grape seen near or on a white plate on a wooden tabletop. The robot must perceive the target, approach from above, compute a pinch grasp suitable for a small object, and close the gripper with low force to avoid crushing. After confirming a stable grasp, it lifts and retreats from the plate area. The scene shows the gripper entering from the right, aligning over the plate, closing on the grape cluster, and moving away.",
    "preconditions": ["Robot powered and homed", "Workspace clear except plate and grapes", "Camera provides view of table", "Gripper functional and calibrated"],
    "stepwise_plan": ["Open gripper", "Detect grape; raster scan if not immediately visible", "Move above target to pregrasp height", "Compute pinch grasp and verify pose availability", "Approach precisely and align", "Lower until contact at low speed", "Close gripper with low force", "Verify grasp stability", "Retreat upward/away", "Confirm object in gripper"],
    "success_criteria": ["Grape detected", "Gripper closes around grape without slipping", "Object remains in gripper during retreat", "No collision with plate/table"],
    "failure_and_recovery": ["If detection fails: perform ScanForTarget and retry visibility check", "If grasp pose missing: recompute", "If contact not detected or grasp unstable: reopen, re-approach and retry"],
    "termination": "Tree ends after confirming the object is in the gripper following retreat."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0", "frame_8"],
    "scores": {
      "frame_0": 0.12, "frame_1": 0.34, "frame_2": 0.56, "frame_3": 0.92,
      "frame_4": 0.28, "frame_5": 0.80, "frame_6": 0.49, "frame_7": 0.18, "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "first stable contact and alignment cue visible",
        "predicts_next": "push actuation expected; confirms goal direction",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "picking a grape",
  "instruction_to_ports": {
    "force": 10,
    "timeout_ms": 800,
    "tolerance": 0.005,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7", "frame_8"],
  "objects": ["grape", "plate", "table", "gripper"],
  "objects_from_instruction": ["grape"],
  "blackboard_keys": ["grasp_grape"],
  "node_specs": [
    {"id":"OpenGripper","type":"Action","ports":{"width":0.09,"timeout_ms":500},"description":"Prepare for grasp by opening to maximum allowed width."},
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"grape"},"description":"Checks if the grape is currently detected."},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"grape","pattern":"raster","max_attempts":3,"timeout_ms":1200},"description":"Camera/arm scan to recover target visibility."},
    {"id":"MoveAbove","type":"Action","ports":{"target":"grape","offset_z":0.05,"timeout_ms":800},"description":"Move to pregrasp height above the grape."},
    {"id":"ComputeGraspPose","type":"Action","ports":{"target":"grape","strategy":"pinch","result_key":"grasp_grape"},"description":"Plan a pinch grasp pose for a small object."},
    {"id":"PoseAvailable","type":"Condition","ports":{"key":"grasp_grape"},"description":"Verify grasp pose computed and on blackboard."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"grape","tolerance":0.005,"timeout_ms":800},"description":"Precisely align TCP to the target pose."},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":0.03,"force_threshold":5.0,"timeout_ms":800},"description":"Descend gently until contact is detected."},
    {"id":"CloseGripper","type":"Action","ports":{"force":10,"timeout_ms":500},"description":"Close with low force to avoid crushing."},
    {"id":"IsGraspStable","type":"Condition","ports":{},"description":"Confirm grasp stability before lifting."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":800},"description":"Lift/withdraw from the plate area."},
    {"id":"ObjectInGripper","type":"Condition","ports":{"target":"grape"},"description":"Final confirmation that the grape is held."}
  ],
  "tree_stats": {"nodes_total": 16, "actions": 8, "conditions": 5, "depth": 4},
  "failure_modes": ["Target not detected", "Collision with plate during descent", "Grape slips during closing", "Insufficient clearance to retreat"],
  "recovery_strategy": ["Raster scan and re-detect", "Recompute grasp pose and realign", "Reopen and retry with better alignment", "Increase retreat distance if blocked"],
  "assumptions": ["Frames show a cluster of grapes near/on a plate; instruction says 'a grape' (singular). Tree treats 'grape' as the graspable item, potentially a small cluster."],
  "evaluation_notes": {
    "expected_success_criteria": ["Object detected, grasp planned, stable grasp confirmed, retreat executed without collision"],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"IsObjectVisible","attrs":{"target":"grape"}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"grape","offset_z":0.05,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "verify",
      "active_leaf": {"id":"ComputeGraspPose","attrs":{"target":"grape","strategy":"pinch","result_key":"grasp_grape"}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "verify",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"grape","tolerance":0.005,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "grasp",
      "active_leaf": {"id":"LowerUntilContact","attrs":{"speed":"slow","max_depth":0.03,"force_threshold":5.0,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "grasp",
      "active_leaf": {"id":"CloseGripper","attrs":{"force":10,"timeout_ms":500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "transfer",
      "active_leaf": {"id":"IsGraspStable","attrs":{}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"ObjectInGripper","attrs":{"target":"grape"}},
      "active_path_ids": []
    }
  ]
}
