{
  "dataset_id": "cmu_stretch_0.1.0",
  "episode_id": "episode_028",
  "task_summary": "Detect the drawer handle, approach and align, grasp the handle, pull to open the drawer, then release and retreat.",
  "task_long_description": {
    "overview": "A mobile manipulator (Stretch) faces a kitchen cabinet with shallow drawers beneath a countertop. The robot must locate the drawer handle, approach while keeping a safe alignment to the handle bar, grasp it, and pull along the opening direction to slide the drawer out. After confirming opening, the robot releases the handle and retreats to avoid collision with the drawer face or nearby dishwasher rails. Visual feedback guides detection and alignment; force is moderate to avoid damage.",
    "preconditions": [
      "Drawer handle is visible or discoverable by scanning",
      "Workspace free of occlusions within the pull path",
      "Gripper calibrated; yaw alignment achievable",
      "Robot within reachable distance to the drawer"
    ],
    "stepwise_plan": [
      "Open gripper and search/confirm the drawer handle.",
      "Approach and align to the handle; set tool yaw to 0Â°.",
      "Verify orientation, then close gripper to grasp the handle.",
      "Pull along x-axis to open the drawer.",
      "Check that the drawer is open, release the handle, and retreat."
    ],
    "success_criteria": [
      "Drawer extends outward visibly",
      "ContainerOpen(drawer) condition satisfied",
      "Gripper releases without collision",
      "Robot ends clear of the drawer"
    ],
    "failure_and_recovery": [
      "Handle not detected -> raster scan and retry detection",
      "Misalignment -> re-approach and re-align, adjust yaw",
      "Slip during pull -> reopen, regrasp with higher force (within safe range)",
      "Obstruction -> retreat slightly and retry shorter pull"
    ],
    "termination": "Terminate when the drawer is confirmed open and the robot has released the handle and retreated to a safe standoff."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0", "frame_8"],
    "scores": {
      "frame_0": 0.12, "frame_1": 0.34, "frame_2": 0.56, "frame_3": 0.92,
      "frame_4": 0.28, "frame_5": 0.80, "frame_6": 0.49, "frame_7": 0.18, "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "Gripper aligned at the handle with clear contact geometry visible.",
        "predicts_next": "Closing gripper followed by a straight pull is expected.",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "open drawer",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7", "frame_8"],
  "objects": ["drawer","drawer_handle","cabinet","countertop","fridge","robot_gripper","dishwasher_rail"],
  "objects_from_instruction": ["drawer"],
  "blackboard_keys": [],
  "node_specs": [
    {"id":"OpenGripper","type":"Action","ports":{"width":0.09,"timeout_ms":800},"description":"Open gripper to maximum before search and to release after opening."},
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"drawer_handle"}, "description":"Quick visibility check to short-circuit scanning."},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"drawer_handle","pattern":"raster","max_attempts":3,"timeout_ms":1500},"description":"Raster scan for the handle if not immediately visible."},
    {"id":"DetectObject","type":"Action","ports":{"target":"drawer_handle","timeout_ms":1200},"description":"Perception to localize the handle."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"drawer_handle","tolerance":0.01,"timeout_ms":1500},"description":"Move to pregrasp and align on the handle bar."},
    {"id":"SetTCPYaw","type":"Action","ports":{"yaw_deg":0},"description":"Set end-effector yaw for bar grasp."},
    {"id":"AtOrientation","type":"Condition","ports":{"yaw_deg":0},"description":"Verify desired yaw is achieved."},
    {"id":"CloseGripper","type":"Action","ports":{"force":30,"timeout_ms":1200},"description":"Grasp the handle with moderate force."},
    {"id":"MoveDelta","type":"Action","ports":{"axis":"x","dist":0.2,"timeout_ms":1500},"description":"Pull straight along x-axis to open the drawer."},
    {"id":"ContainerOpen","type":"Condition","ports":{"target":"drawer"}, "description":"Confirm drawer has opened."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":800},"description":"Back off to a safe standoff after release."}
  ],
  "tree_stats": {"nodes_total": 14, "actions": 9, "conditions": 3, "depth": 3},
  "failure_modes": [
    "Handle not detected due to glare or occlusion",
    "Pose estimate drift causing misalignment",
    "Gripper slip during pull",
    "Collision with adjacent dishwasher rail"
  ],
  "recovery_strategy": [
    "Fallback to scan then re-detect",
    "Re-run ApproachAndAlign with tighter tolerance",
    "Re-open and regrasp with adjusted force",
    "Shorter pull and incremental retries"
  ],
  "assumptions": [
    "Frames show a bar-style handle on a wooden drawer; pull direction is approximately robot base x-axis.",
    "The dishwasher rail visible on the right is static and not the target.",
    "No explicit force/timeout specified in instruction; safe defaults selected from library bins."
  ],
  "evaluation_notes": {
    "expected_success_criteria": [
      "Drawer extends outward by a noticeable margin",
      "ContainerOpen(drawer) returns true",
      "Robot retreats without contact after releasing"
    ],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"IsObjectVisible","attrs":{"target":"drawer_handle"}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "perceive",
      "active_leaf": {"id":"ScanForTarget","attrs":{"target":"drawer_handle","pattern":"raster","max_attempts":3,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"drawer_handle","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "approach",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"drawer_handle","tolerance":0.01,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "verify",
      "active_leaf": {"id":"AtOrientation","attrs":{"yaw_deg":0}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "grasp",
      "active_leaf": {"id":"CloseGripper","attrs":{"force":30,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "transfer",
      "active_leaf": {"id":"MoveDelta","attrs":{"axis":"x","dist":0.2,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "transfer",
      "active_leaf": {"id":"ContainerOpen","attrs":{"target":"drawer"}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "place",
      "active_leaf": {"id":"OpenGripper","attrs":{"width":0.09,"timeout_ms":800}},
      "active_path_ids": []
    }
  ]
}
