{
  "dataset_id": "utokyo_pr2_opening_fridge_0.1.0",
  "episode_id": "episode_045",
  "task_summary": "PR2 detects the fridge handle, approaches and grasps it, then pulls to open the hinged fridge door and retreats to clear the doorway.",
  "task_long_description": {
    "overview": "A PR2 robot operates in a cluttered lab near a small fridge. The robot must open the hinged fridge door by locating the handle, aligning its gripper, grasping, and pulling the door open. The contact sheet shows approach, initial door motion, and a fully opened state with visible shelves. The plan prioritizes reliable perception followed by a precise approach, grasp with moderate force, and a single high-level open action. Recovery uses a visibility check and scanning fallback before approach.",
    "preconditions": ["Fridge is reachable by the PR2 arm", "Handle is unobstructed", "Robot base is stable and within workspace limits"],
    "stepwise_plan": ["Check/scan for the fridge handle", "Detect handle and approach with alignment tolerance", "Prepare and grasp the handle", "Align wrist yaw for a pull", "Execute open on the hinged door", "Verify door is open", "Retreat to avoid collision with the door"],
    "success_criteria": ["Fridge door angle noticeably increases and remains open", "No collisions with drawers or surroundings", "Robot ends clear of the swing path"],
    "failure_and_recovery": ["Handle not visible → perform scanning fallback", "Pose estimate drift → re-detect and re-approach", "Grasp slip → re-open gripper and retry close", "Door jam or obstruction → stop and report"],
    "termination": "Terminate when the door state is open and the arm has retreated to a safe distance."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0", "frame_8"],
    "scores": {
      "frame_0": 0.12, "frame_1": 0.34, "frame_2": 0.56, "frame_3": 0.92,
      "frame_4": 0.28, "frame_5": 0.80, "frame_6": 0.49, "frame_7": 0.18, "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "Gripper is at the handle with alignment cues; first clear contact before door motion.",
        "predicts_next": "Pull/open actuation should follow; door angle expected to increase.",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "opening the fridge",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7", "frame_8"],
  "objects": ["fridge_door", "fridge_handle", "interior_shelves", "drawer_stack", "pr2_robot"],
  "objects_from_instruction": ["fridge"],
  "blackboard_keys": ["handle_grasp"],
  "node_specs": [
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"fridge_handle"},"description":"Checks if the handle is in view."},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"fridge_handle","pattern":"arc","max_attempts":3,"timeout_ms":1200},"description":"Scan in an arc to find the handle if not visible."},
    {"id":"DetectObject","type":"Action","ports":{"target":"fridge_handle","timeout_ms":800},"description":"Run perception to localize the handle."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"fridge_handle","tolerance":0.01,"timeout_ms":1500},"description":"Move end-effector to handle with alignment tolerance."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.09,"timeout_ms":500},"description":"Open gripper to prepare for grasp."},
    {"id":"ComputeGraspPose","type":"Action","ports":{"target":"fridge_handle","strategy":"pull","result_key":"handle_grasp"},"description":"Compute a pull-style grasp pose for the handle."},
    {"id":"CloseGripper","type":"Action","ports":{"force":20,"timeout_ms":500},"description":"Close gripper to secure the handle."},
    {"id":"SetTCPYaw","type":"Action","ports":{"yaw_deg":90},"description":"Rotate wrist yaw to align with pull direction."},
    {"id":"OpenContainer","type":"Action","ports":{"target":"fridge_door","container_type":"hinged_door","timeout_ms":1500},"description":"Command to open the hinged fridge door."},
    {"id":"ContainerOpen","type":"Condition","ports":{"target":"fridge_door"},"description":"Verify the door is open."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":800},"description":"Back off to clear the door swing."}
  ],
  "tree_stats": {"nodes_total": 13, "actions": 9, "conditions": 2, "depth": 3},
  "failure_modes": ["Handle not detected", "Approach misalignment due to clutter", "Gripper fails to secure handle", "Door obstructed or jams", "Collision with drawers or door edge"],
  "recovery_strategy": ["Fallback scanning to regain visibility", "Re-run detection then re-approach with same tolerance", "Re-open then re-close gripper with same force", "Abort open if resistance persists and report"],
  "assumptions": ["Door is a hinged door opening toward the camera-left as indicated by frames", "Handle affords a pull action compatible with PR2 gripper", "No human interference during execution"],
  "evaluation_notes": {
    "expected_success_criteria": ["ContainerOpen condition satisfied", "Visual confirmation of interior shelves", "Final arm pose outside the door swing path"],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"fridge_handle","timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"fridge_handle","tolerance":0.01,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "approach",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"fridge_handle","tolerance":0.01,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "grasp",
      "active_leaf": {"id":"CloseGripper","attrs":{"force":20,"timeout_ms":500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "grasp",
      "active_leaf": {"id":"SetTCPYaw","attrs":{"yaw_deg":90}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"OpenContainer","attrs":{"target":"fridge_door","container_type":"hinged_door","timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "transfer",
      "active_leaf": {"id":"OpenContainer","attrs":{"target":"fridge_door","container_type":"hinged_door","timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "transfer",
      "active_leaf": {"id":"OpenContainer","attrs":{"target":"fridge_door","container_type":"hinged_door","timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":800}},
      "active_path_ids": []
    }
  ]
}
