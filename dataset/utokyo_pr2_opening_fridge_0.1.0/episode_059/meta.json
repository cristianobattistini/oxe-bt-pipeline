{
  "dataset_id": "utokyo_pr2_opening_fridge_0.1.0",
  "episode_id": "episode_059",
  "task_summary": "Open the hinged fridge door by locating the handle, aligning the gripper, pulling to open, verifying the door is open, releasing the handle, and retreating.",
  "task_long_description": {
    "overview": "A PR2 manipulator operates in a cluttered lab corner to open a small refrigerator. The scene shows a bar-style handle on a hinged door, drawers nearby, and shelves inside the fridge. The robot must perceive the handle, approach with proper yaw alignment, grasp securely, actuate the door to open, confirm the open state, release, and back away to a safe standoff. Timeouts and conservative forces are used to avoid collisions with nearby furniture and the door edge.",
    "preconditions": [
      "Robot base already positioned in front of fridge",
      "Fridge powered and door initially closed",
      "Handle reachable with current arm workspace",
      "No obstacles blocking the pull arc"
    ],
    "stepwise_plan": [
      "Navigate end-effector to fridge front and search for the handle using visibility check and raster scan fallback",
      "Localize the handle and move above it with proper yaw alignment",
      "Open gripper, align precisely, and close on the handle",
      "Execute door opening using hinged_door primitive",
      "Verify door open state, release handle, and retreat to a safe distance"
    ],
    "success_criteria": [
      "Door visibly open beyond initial closed position",
      "ContainerOpen condition returns success",
      "End-effector no longer in contact and at safe retreat pose"
    ],
    "failure_and_recovery": [
      "Handle not detected: invoke ScanForTarget with retries and re-run DetectObject",
      "Poor grasp: if CloseGripper fails, repeat alignment and grasp",
      "Door stuck: extend OpenContainer timeout and attempt again",
      "Collision risk: abort and Retreat immediately"
    ],
    "termination": "Terminate after successful ContainerOpen check, handle release, and retreat wait period"
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0","frame_8"],
    "scores": {
      "frame_0": 0.12,
      "frame_1": 0.34,
      "frame_2": 0.56,
      "frame_3": 0.92,
      "frame_4": 0.28,
      "frame_5": 0.80,
      "frame_6": 0.49,
      "frame_7": 0.18,
      "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "first stable contact and alignment cue visible",
        "predicts_next": "push actuation expected; confirms goal direction",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "opening the fridge",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7","frame_8"],
  "objects": ["fridge", "fridge_door", "fridge_handle", "shelves", "drawer_unit"],
  "objects_from_instruction": ["fridge"],
  "blackboard_keys": [],
  "node_specs": [
    {"id":"MoveTo","type":"Action","ports":{"target":"fridge_front","timeout_ms":1500},"description":"Approach the fridge front to get within manipulation range"},
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"fridge_handle"},"description":"Quick visibility check for the handle"},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"fridge_handle","pattern":"raster","max_attempts":3,"timeout_ms":1500},"description":"Fallback scan if the handle is not immediately visible"},
    {"id":"DetectObject","type":"Action","ports":{"target":"fridge_handle","timeout_ms":1200},"description":"Perceive and localize the handle precisely"},
    {"id":"MoveAbove","type":"Action","ports":{"target":"fridge_handle","offset_z":0.02,"timeout_ms":1200},"description":"Move above the handle to establish a good pregrasp"},
    {"id":"SetTCPYaw","type":"Action","ports":{"yaw_deg":90},"description":"Align the wrist yaw with the bar handle orientation"},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.09,"timeout_ms":800},"description":"Prepare gripper for grasp"},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"fridge_handle","tolerance":0.0,"timeout_ms":1500},"description":"Close-in and align to the handle with tight tolerance"},
    {"id":"CloseGripper","type":"Action","ports":{"force":20,"timeout_ms":1200},"description":"Grasp the handle with moderate force"},
    {"id":"OpenContainer","type":"Action","ports":{"target":"fridge_door","container_type":"hinged_door","timeout_ms":2000},"description":"Pull to open the fridge door along its hinge arc"},
    {"id":"ContainerOpen","type":"Condition","ports":{"target":"fridge_door"},"description":"Verify that the door is open"},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.09,"timeout_ms":800},"description":"Release the handle after opening"},
    {"id":"Retreat","type":"Action","ports":{"distance":0.2,"timeout_ms":1200},"description":"Back off to a safe distance"},
    {"id":"Wait","type":"Action","ports":{"timeout_ms":400},"description":"Short pause to stabilize after retreat"}
  ],
  "tree_stats": {"nodes_total": 16, "actions": 12, "conditions": 2, "depth": 3},
  "failure_modes": ["handle not detected", "misalignment causes failed grasp", "door resists opening", "collision with door edge or drawers"],
  "recovery_strategy": ["fallback scan and re-detect", "re-open gripper and re-align then re-grasp", "increase timeout and re-open", "immediate retreat then re-approach"],
  "assumptions": ["Frames clearly show a hinged fridge door with bar handle; instruction matches visuals", "Robot already positioned near the fridge; only arm manipulation is required"],
  "evaluation_notes": {
    "expected_success_criteria": ["ContainerOpen succeeds and door visibly ajar", "Robot releases handle and retreats without collision"],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"ScanForTarget","attrs":{"target":"fridge_handle","pattern":"raster","max_attempts":3,"timeout_ms":1500}},
      "active_path_ids": ["Sequence","Fallback","ScanForTarget"]
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"MoveTo","attrs":{"target":"fridge_front","timeout_ms":1500}},
      "active_path_ids": ["Sequence","MoveTo"]
    },
    {
      "frame": "frame_2",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"fridge_handle","offset_z":0.02,"timeout_ms":1200}},
      "active_path_ids": ["Sequence","MoveAbove"]
    },
    {
      "frame": "frame_3",
      "phase": "grasp",
      "active_leaf": {"id":"CloseGripper","attrs":{"force":20,"timeout_ms":1200}},
      "active_path_ids": ["Sequence","CloseGripper"]
    },
    {
      "frame": "frame_4",
      "phase": "transfer",
      "active_leaf": {"id":"OpenContainer","attrs":{"target":"fridge_door","container_type":"hinged_door","timeout_ms":2000}},
      "active_path_ids": ["Sequence","OpenContainer"]
    },
    {
      "frame": "frame_5",
      "phase": "verify",
      "active_leaf": {"id":"ContainerOpen","attrs":{"target":"fridge_door"}},
      "active_path_ids": ["Sequence","ContainerOpen"]
    },
    {
      "frame": "frame_6",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.2,"timeout_ms":1200}},
      "active_path_ids": ["Sequence","Retreat"]
    },
    {
      "frame": "frame_7",
      "phase": "retreat",
      "active_leaf": {"id":"Wait","attrs":{"timeout_ms":400}},
      "active_path_ids": ["Sequence","Wait"]
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Wait","attrs":{"timeout_ms":400}},
      "active_path_ids": ["Sequence","Wait"]
    }
  ]
}

