{
  "dataset_id": "utokyo_pr2_opening_fridge_0.1.0",
  "episode_id": "episode_018",
  "task_summary": "PR2 detects the fridge handle, aligns, grasps it, pulls to open the hinged door, verifies it is open, and retreats.",
  "task_long_description": {
    "overview": "In an office-kitchen setting, a PR2 robot must open a refrigerator door. The robot first perceives the handle location, aligns its wrist for a side pull, computes a grasp, and closes the gripper on the handle. It then executes a pulling motion using a container-aware primitive for hinged doors, briefly waits to damp motion, verifies that the door is open, and retreats to a safe distance. The main objects are the fridge body, the hinged door, and the bar-style handle. Constraints include tight workspace and avoiding collisions with nearby furniture.",
    "preconditions": [
      "Fridge is closed and reachable",
      "Handle visible or discoverable by scan",
      "Gripper empty and operational"
    ],
    "stepwise_plan": [
      "Open gripper and scan for the fridge handle",
      "Detect handle and approach with fine alignment",
      "Set wrist yaw for side pull and compute grasp",
      "Grasp handle and check stability",
      "Open the hinged door using pull action",
      "Briefly wait, verify door open, then retreat"
    ],
    "success_criteria": [
      "Door angle visibly increases to an open state",
      "Robot maintains stable grasp during pull",
      "Robot ends at a safe standoff pose without collisions"
    ],
    "failure_and_recovery": [
      "Handle not detected → rescan and re-approach",
      "Slipped grasp → reopen gripper, recompute grasp, retry pick",
      "Door stuck → increase attempts or adjust yaw and re-pull",
      "Collision risk → abort pull and retreat"
    ],
    "termination": "Terminate when ContainerOpen confirms the fridge door is open and the robot has retreated."
  },
  "frame_ranking": {
    "order": ["frame_5","frame_7","frame_6","frame_4","frame_3","frame_8","frame_2","frame_1","frame_0"],
    "scores": {
      "frame_0": 0.18, "frame_1": 0.32, "frame_2": 0.46, "frame_3": 0.72,
      "frame_4": 0.80, "frame_5": 0.91, "frame_6": 0.83, "frame_7": 0.93, "frame_8": 0.55
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "Wrist and gripper aligned near the handle indicating imminent grasp.",
        "predicts_next": "Next step should be closing the gripper and initiating the pull.",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "opening the fridge",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7","frame_8"],
  "objects": ["fridge", "fridge_door", "fridge_handle", "nearby_drawers", "interior_shelves"],
  "objects_from_instruction": ["fridge"],
  "blackboard_keys": ["fridge_handle_grasp"],
  "node_specs": [
    {"id":"OpenGripper","type":"Action","ports":{"width":0.09,"timeout_ms":800},"description":"Prepare gripper to approach the handle."},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"fridge_handle","pattern":"arc","max_attempts":3,"timeout_ms":1500},"description":"Search pattern to localize handle."},
    {"id":"DetectObject","type":"Action","ports":{"target":"fridge_handle","timeout_ms":800},"description":"Perception confirmation of handle."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"fridge_handle","tolerance":0.01,"timeout_ms":1500},"description":"Approach with fine alignment to grasp pose."},
    {"id":"SetTCPYaw","type":"Action","ports":{"yaw_deg":90},"description":"Orient wrist for side pull."},
    {"id":"ComputeGraspPose","type":"Action","ports":{"target":"fridge_handle","strategy":"pull","result_key":"fridge_handle_grasp"},"description":"Compute grasp for pulling the hinged door."},
    {"id":"Pick","type":"Action","ports":{"grasp_key":"fridge_handle_grasp","timeout_ms":1500},"description":"Close on handle using computed grasp."},
    {"id":"IsGraspStable","type":"Condition","ports":{},"description":"Check that the grasp is secure."},
    {"id":"OpenContainer","type":"Action","ports":{"target":"fridge_door","container_type":"hinged_door","timeout_ms":2000},"description":"Pull to open the hinged fridge door."},
    {"id":"Wait","type":"Action","ports":{"timeout_ms":400},"description":"Brief settle time after door motion."},
    {"id":"ContainerOpen","type":"Condition","ports":{"target":"fridge_door"},"description":"Verify door is open."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.2,"timeout_ms":1200},"description":"Back away to a safe distance."}
  ],
  "tree_stats": {"nodes_total": 13, "actions": 10, "conditions": 2, "depth": 2},
  "failure_modes": [
    "Handle not found due to occlusion",
    "Poor alignment causing missed grasp",
    "Insufficient pull leading to partial opening",
    "Collision with drawers or fridge body during pull"
  ],
  "recovery_strategy": [
    "Rescan with arc pattern and adjust approach",
    "Recompute grasp and retry pick",
    "Reorient wrist yaw and re-execute OpenContainer",
    "Abort and Retreat on contact spikes, then re-plan"
  ],
  "assumptions": [
    "Door is a right-hinged fridge door opening outward toward the robot as seen in frames 6–8.",
    "Handle is bar-style suitable for pull grasp; yaw 90° chosen from visual alignment.",
    "Environment remains static except the door; no human interference."
  ],
  "evaluation_notes": {
    "expected_success_criteria": [
      "ContainerOpen returns true after OpenContainer",
      "Door visually open in frames 6–8",
      "No collision events during approach or pull"
    ],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"ScanForTarget","attrs":{"target":"fridge_handle","pattern":"arc","max_attempts":3,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"fridge_handle","timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "approach",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"fridge_handle","tolerance":0.01,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "approach",
      "active_leaf": {"id":"ComputeGraspPose","attrs":{"target":"fridge_handle","strategy":"pull","result_key":"fridge_handle_grasp"}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "grasp",
      "active_leaf": {"id":"Pick","attrs":{"grasp_key":"fridge_handle_grasp","timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"OpenContainer","attrs":{"target":"fridge_door","container_type":"hinged_door","timeout_ms":2000}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "transfer",
      "active_leaf": {"id":"OpenContainer","attrs":{"target":"fridge_door","container_type":"hinged_door","timeout_ms":2000}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.2,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.2,"timeout_ms":1200}},
      "active_path_ids": []
    }
  ]
}
