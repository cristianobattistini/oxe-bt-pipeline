{
  "dataset_id": "utokyo_pr2_opening_fridge_0.1.0",
  "episode_id": "episode_054",
  "task_summary": "Detect the fridge and its handle, approach, grasp the handle, and open the hinged fridge door, then retreat and release.",
  "task_long_description": {
    "overview": "A PR2 robot must open a hinged fridge door visible in a small lab scene with cabinets and a compact refrigerator. The sequence begins with perception to localize the door and handle, continues with precise approach and gripper yaw alignment, followed by grasping the handle using a pull strategy. The robot actuates door opening via a container action, verifies the door is open, retreats to clear the swing path, and releases the handle. Timing and tolerances are set conservatively to match tight spaces and avoid collisions.",
    "preconditions": ["Fridge and handle are within reachable workspace", "Robot base is positioned near the fridge front", "Gripper and wrist functioning with force control", "Camera provides sufficient view of door and handle"],
    "stepwise_plan": ["Scan the scene to find the fridge door", "Detect and localize the handle", "Move to the fridge front and align wrist yaw", "Open gripper and approach the handle precisely", "Compute grasp pose using a pull strategy and pick the handle", "Execute container opening for a hinged door", "Verify door is open, retreat, and release"],
    "success_criteria": ["ContainerOpen condition satisfied for fridge_door", "Door visibly open with increased opening angle", "Robot ends clear of the door swing with handle released"],
    "failure_and_recovery": ["If handle not detected, rescan the scene", "If alignment fails, re-approach with tighter tolerance", "If grasp slips, reopen gripper, recompute grasp, and retry pick", "If door jams, slightly adjust pose and reissue open action"],
    "termination": "Terminate after ContainerOpen is true, the robot retreats a set distance, and gripper is released."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0", "frame_8"],
    "scores": {
      "frame_0": 0.12, "frame_1": 0.34, "frame_2": 0.56, "frame_3": 0.92,
      "frame_4": 0.28, "frame_5": 0.80, "frame_6": 0.49, "frame_7": 0.18, "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "first stable contact and alignment cue visible",
        "predicts_next": "push actuation expected; confirms goal direction",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "opening the fridge",
  "instruction_to_ports": {
    "force": null,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": null
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7", "frame_8"],
  "objects": ["fridge", "fridge_door", "fridge_handle", "interior shelves", "cabinet drawers", "floor", "PR2 robot"],
  "objects_from_instruction": ["fridge"],
  "blackboard_keys": ["handle_grasp"],
  "node_specs": [
    {"id":"ScanForTarget","type":"Action","ports":{"target":"fridge_door","pattern":"raster","max_attempts":3,"timeout_ms":1500},"description":"Scan the scene to localize the fridge door using a raster pattern."},
    {"id":"DetectObject","type":"Action","ports":{"target":"fridge_handle","timeout_ms":800},"description":"Detect the fridge handle for grasp planning."},
    {"id":"MoveTo","type":"Action","ports":{"target":"fridge_front","timeout_ms":1500},"description":"Move the end-effector/base to the front of the fridge."},
    {"id":"SetTCPYaw","type":"Action","ports":{"yaw_deg":90},"description":"Rotate wrist yaw to align with handle orientation."},
    {"id":"AtOrientation","type":"Condition","ports":{"yaw_deg":90},"description":"Verify wrist yaw alignment before approach."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.09,"timeout_ms":500},"description":"Open gripper to prepare for handle grasp."},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"fridge_handle","tolerance":0.005,"timeout_ms":1200},"description":"Approach the handle with tight alignment tolerance."},
    {"id":"ComputeGraspPose","type":"Action","ports":{"target":"fridge_handle","strategy":"pull","result_key":"handle_grasp"},"description":"Compute a pulling grasp for the handle and store it."},
    {"id":"PoseAvailable","type":"Condition","ports":{"key":"handle_grasp"},"description":"Ensure computed grasp pose is available."},
    {"id":"Pick","type":"Action","ports":{"grasp_key":"handle_grasp","timeout_ms":1200},"description":"Execute the grasp on the handle."},
    {"id":"OpenContainer","type":"Action","ports":{"target":"fridge_door","container_type":"hinged_door","timeout_ms":1500},"description":"Open the hinged fridge door."},
    {"id":"ContainerOpen","type":"Condition","ports":{"target":"fridge_door"},"description":"Verify the door is open."},
    {"id":"Retreat","type":"Action","ports":{"distance":0.2,"timeout_ms":800},"description":"Back away to clear the door swing."},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.08,"timeout_ms":500},"description":"Release the handle after opening."},
    {"id":"Wait","type":"Action","ports":{"timeout_ms":400},"description":"Short stabilization wait after release."}
  ],
  "tree_stats": {"nodes_total": 16, "actions": 12, "conditions": 3, "depth": 2},
  "failure_modes": ["Handle not detected due to occlusion", "Wrist yaw misalignment prevents secure grasp", "Grasp slip during pull", "Door jam or collision with adjacent cabinet"],
  "recovery_strategy": ["Re-run ScanForTarget and DetectObject from a slightly different view", "Re-align yaw and re-approach with tolerance 0.005", "Recompute grasp and reattempt Pick", "Back off slightly and retry OpenContainer"],
  "assumptions": ["Frames depict a hinged fridge door with a graspable handle; OpenContainer models the pulling motion internally", "Robot platform is PR2 with parallel gripper and wrist yaw control", "No explicit retries instructed; conservative timeouts selected"],
  "evaluation_notes": {
    "expected_success_criteria": ["ContainerOpen true and visible open state", "Robot retreats and releases handle without collision"],
    "test_scenarios": ["happy path","object_missing","grasp_fail","perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"ScanForTarget","attrs":{"target":"fridge_door","pattern":"raster","max_attempts":3,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"fridge_handle","timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "approach",
      "active_leaf": {"id":"MoveTo","attrs":{"target":"fridge_front","timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "approach",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"fridge_handle","tolerance":0.005,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "grasp",
      "active_leaf": {"id":"Pick","attrs":{"grasp_key":"handle_grasp","timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"OpenContainer","attrs":{"target":"fridge_door","container_type":"hinged_door","timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "transfer",
      "active_leaf": {"id":"OpenContainer","attrs":{"target":"fridge_door","container_type":"hinged_door","timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.2,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"OpenGripper","attrs":{"width":0.08,"timeout_ms":500}},
      "active_path_ids": []
    }
  ]
}
