#!/usr/bin/env bash
set -e

repo_root="$(git rev-parse --show-toplevel)"
pyexe="$USERPROFILE\\anaconda3\\envs\\oxe-bt-pipeline\\python.exe"
script="$repo_root\\dev_logs\\scripts\\commit_log.py"

# Trace log
{
  echo "post-commit ran: $(date)"
  echo "repo_root=$repo_root"
  echo "pyexe=$pyexe"
  echo "script=$script"
} >> "$repo_root/dev_logs/hook_trace.txt"

# Esegui con cmd.exe per gestire spazi nel path
cmd.exe /C "\"$pyexe\" \"$script\"" >> "$repo_root/dev_logs/hook_trace.txt" 2>&1 || true
