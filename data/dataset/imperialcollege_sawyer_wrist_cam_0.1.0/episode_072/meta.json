{
  "dataset_id": "imperialcollege_sawyer_wrist_cam_0.1.0",
  "episode_id": "episode_072",
  "task_summary": "Insert a cap into the mouth of a bottle using a robotic arm.",
  "task_long_description": {
    "overview": "This task involves a robot identifying a cap, grasping it with precision using a pinch strategy, and aligning it over a bottle mouth before inserting it vertically. The contact sheet frames illustrate the final alignment and insertion phases, confirming the cap's approach toward the target slot. This behavior tree models visual recovery, fine alignment, and verification of insertion success.",
    "preconditions": ["Cap is within robot's workspace", "Bottle mouth is exposed and accessible", "Gripper is initially open"],
    "stepwise_plan": [
      "Detect or scan for the cap",
      "Open gripper to appropriate width",
      "Move above the cap with a vertical offset",
      "Compute and align to the grasp pose",
      "Lower until gentle contact is detected",
      "Close gripper with low force to secure cap",
      "Confirm grasp stability",
      "Locate bottle mouth",
      "Move above the bottle mouth",
      "Insert cap along vertical axis into mouth",
      "Verify insertion",
      "Release the cap",
      "Retreat from insertion zone"
    ],
    "success_criteria": [
      "Cap is securely inserted into the bottle mouth",
      "Insertion verified by confirmation condition",
      "Robot retreats safely after releasing"
    ],
    "failure_and_recovery": [
      "If cap not detected, retry with scan",
      "If grasp fails, retry from detection",
      "If insertion fails, abort and retry alignment"
    ],
    "termination": "Task ends after successful insertion, release, and retreat."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0", "frame_8"],
    "scores": {
      "frame_0": 0.12, "frame_1": 0.34, "frame_2": 0.56, "frame_3": 0.92,
      "frame_4": 0.28, "frame_5": 0.80, "frame_6": 0.49, "frame_7": 0.18, "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "first stable contact and alignment cue visible",
        "predicts_next": "push actuation expected; confirms goal direction",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "insert cap in bottle",
  "instruction_to_ports": {
    "force": 10,
    "timeout_ms": 1200,
    "tolerance": 0.005,
    "retry_attempts": 3
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7", "frame_8"],
  "objects": ["cap", "bottle"],
  "objects_from_instruction": ["cap", "bottle"],
  "blackboard_keys": ["grasp_cap"],
  "node_specs": [
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"cap"},"description":"Check if cap is visible"},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"cap","pattern":"raster","max_attempts":3,"timeout_ms":1200},"description":"Search for cap if not immediately visible"},
    {"id":"DetectObject","type":"Action","ports":{"target":"cap","timeout_ms":800},"description":"Trigger object detection for cap"},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.06,"timeout_ms":500},"description":"Open the gripper to grasp cap"},
    {"id":"MoveAbove","type":"Action","ports":{"target":"cap","offset_z":0.05,"timeout_ms":1500},"description":"Position gripper above cap"},
    {"id":"ComputeGraspPose","type":"Action","ports":{"target":"cap","strategy":"pinch","result_key":"grasp_cap"},"description":"Calculate grasp pose for cap"},
    {"id":"ApproachAndAlign","type":"Action","ports":{"target":"cap","tolerance":0.005,"timeout_ms":1500},"description":"Fine-tune alignment before grasp"},
    {"id":"LowerUntilContact","type":"Action","ports":{"speed":"slow","max_depth":0.05,"force_threshold":5,"timeout_ms":1200},"description":"Lower to make gentle contact with cap"},
    {"id":"CloseGripper","type":"Action","ports":{"force":10,"timeout_ms":800},"description":"Close gripper to hold cap"},
    {"id":"IsGraspStable","type":"Condition","ports":{},"description":"Check if cap is stably grasped"},
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"bottle"},"description":"Check if bottle is visible"},
    {"id":"DetectObject","type":"Action","ports":{"target":"bottle","timeout_ms":800},"description":"Detect bottle location"},
    {"id":"MoveAbove","type":"Action","ports":{"target":"bottle","offset_z":0.05,"timeout_ms":1500},"description":"Move above bottle mouth"},
    {"id":"InsertInto","type":"Action","ports":{"target":"cap","slot_id":"bottle_mouth","axis":"z","distance":0.05,"tolerance":0.005,"force_limit":10,"timeout_ms":1500},"description":"Insert cap into bottle"},
    {"id":"Inserted","type":"Condition","ports":{"target":"cap","slot_id":"bottle_mouth"},"description":"Confirm cap insertion"},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.06,"timeout_ms":500},"description":"Release cap after insertion"},
    {"id":"Retreat","type":"Action","ports":{"distance":0.1,"timeout_ms":1200},"description":"Withdraw from insertion zone"}
  ],
  "tree_stats": {"nodes_total": 17, "actions": 13, "conditions": 4, "depth": 3},
  "failure_modes": ["cap not detected", "grasp unstable", "bottle not located", "insertion fails due to misalignment"],
  "recovery_strategy": [
    "Retry scan if cap not visible",
    "Repeat grasp sequence on failure",
    "Abort and retry insertion with alignment adjustment"
  ],
  "assumptions": [
    "The slot_id 'bottle_mouth' is not explicitly visible in frames but inferred from instruction and spatial cues",
    "The cap is assumed to be a manipulable object matching size and orientation cues from the frames"
  ],
  "evaluation_notes": {
    "expected_success_criteria": ["Cap is inserted fully and gripper released without collision"],
    "test_scenarios": ["happy path", "object_missing", "grasp_fail", "perception_noise"]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"cap","offset_z":0.05,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id":"ComputeGraspPose","attrs":{"target":"cap","strategy":"pinch","result_key":"grasp_cap"}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "verify",
      "active_leaf": {"id":"ApproachAndAlign","attrs":{"target":"cap","tolerance":0.005,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "grasp",
      "active_leaf": {"id":"LowerUntilContact","attrs":{"speed":"slow","max_depth":0.05,"force_threshold":5,"timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "grasp",
      "active_leaf": {"id":"CloseGripper","attrs":{"force":10,"timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "transfer",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"bottle","offset_z":0.05,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "place",
      "active_leaf": {"id":"InsertInto","attrs":{"target":"cap","slot_id":"bottle_mouth","axis":"z","distance":0.05,"tolerance":0.005,"force_limit":10,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "place",
      "active_leaf": {"id":"Inserted","attrs":{"target":"cap","slot_id":"bottle_mouth"}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.1,"timeout_ms":1200}},
      "active_path_ids": []
    }
  ]
}
