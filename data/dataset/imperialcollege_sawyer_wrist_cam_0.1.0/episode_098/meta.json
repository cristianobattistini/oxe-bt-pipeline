{
  "dataset_id": "imperialcollege_sawyer_wrist_cam_0.1.0",
  "episode_id": "episode_098",
  "task_summary": "Stacking two bowls by grasping the top bowl and placing it onto the bottom bowl for stable alignment.",
  "task_long_description": {
    "overview": "This episode involves a robot arm manipulating two white bowls placed on a blue surface. The robot locates the bowls, grasps the top bowl, aligns it above the bottom bowl, and gently stacks it to ensure stability. The main constraint is precise and gentle alignment to avoid toppling, with visual confirmation of bowl locations. Actions proceed in strict order, directly mapped from contact sheet frames. The environment is uncluttered, focusing solely on stacking.",
    "preconditions": [
      "Both bowls are visible and accessible",
      "Gripper is initially open",
      "No objects obstruct bowl stacking area"
    ],
    "stepwise_plan": [
      "Locate the top bowl",
      "Confirm visibility and presence of both bowls",
      "Open the gripper to an appropriate width",
      "Move above and compute a top grasp pose for the top bowl",
      "Grasp the top bowl from above",
      "Verify grasp stability",
      "Move above the bottom bowl",
      "Stack the top bowl onto the bottom bowl with centered alignment and gentle force",
      "Release the gripper and retreat"
    ],
    "success_criteria": [
      "Top bowl stably sits atop the bottom bowl, aligned centrally",
      "No visible movement or toppling after release",
      "Gripper is clear after stacking"
    ],
    "failure_and_recovery": [
      "Failed bowl detection → retry up to 3 visual scans",
      "Instable grasp → retry grasping or abort",
      "Failed stacking alignment → reposition and stack again"
    ],
    "termination": "Tree terminates after successful stacking and retreat."
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0","frame_8"],
    "scores": {
      "frame_0": 0.12, "frame_1": 0.34, "frame_2": 0.56, "frame_3": 0.92,
      "frame_4": 0.28, "frame_5": 0.80, "frame_6": 0.49, "frame_7": 0.18, "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "first stable contact and alignment cue visible",
        "predicts_next": "push actuation expected; confirms goal direction",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "stack bowls",
  "instruction_to_ports": {
    "force": 5,
    "timeout_ms": null,
    "tolerance": null,
    "retry_attempts": 3
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7", "frame_8"],
  "objects": ["bowl_top", "bowl_bottom"],
  "objects_from_instruction": ["bowl"],
  "blackboard_keys": ["grasp_top"],
  "node_specs": [
    {"id":"IsObjectVisible","type":"Condition","ports":{"target":"bowl_top"},"description":"Checks if the top bowl is visible"},
    {"id":"ScanForTarget","type":"Action","ports":{"target":"bowl_top","pattern":"spiral","max_attempts":3,"timeout_ms":1200},"description":"Visually scan for bowl_top up to 3 tries"},
    {"id":"DetectObject","type":"Action","ports":{"target":"bowl_top","timeout_ms":800},"description":"Detect bowl_top for grasp planning"},
    {"id":"DetectObject","type":"Action","ports":{"target":"bowl_bottom","timeout_ms":800},"description":"Detect bowl_bottom target placement"},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.06,"timeout_ms":500},"description":"Open gripper to grasp width"},
    {"id":"MoveAbove","type":"Action","ports":{"target":"bowl_top","offset_z":0.05,"timeout_ms":1500},"description":"Position above the top bowl"},
    {"id":"ComputeGraspPose","type":"Action","ports":{"target":"bowl_top","strategy":"top","result_key":"grasp_top"},"description":"Compute a top grasp pose for bowl_top"},
    {"id":"GraspAtPose","type":"Action","ports":{"pose_key":"grasp_top","strategy":"top","timeout_ms":1000},"description":"Grasp bowl_top at computed pose"},
    {"id":"IsGraspStable","type":"Condition","ports":{},"description":"Check stability of current grasp"},
    {"id":"MoveAbove","type":"Action","ports":{"target":"bowl_bottom","offset_z":0.05,"timeout_ms":1500},"description":"Move above destination bowl"},
    {"id":"Stack","type":"Action","ports":{"target":"bowl_top","on_top_of":"bowl_bottom","alignment":"centered","press_force":5,"timeout_ms":1000},"description":"Stack bowl_top onto bowl_bottom gently"},
    {"id":"OpenGripper","type":"Action","ports":{"width":0.08,"timeout_ms":500},"description":"Release gripper to drop bowl"},
    {"id":"Retreat","type":"Action","ports":{"distance":0.10,"timeout_ms":1200},"description":"Retreat arm after stacking"}
  ],
  "tree_stats": {"nodes_total": 14, "actions": 10, "conditions": 2, "depth": 5},
  "failure_modes": [
    "Failed object detection (bowl not found)",
    "Unstable grasp of bowl_top",
    "Misalignment during stacking",
    "Gripper fails to open/close"
  ],
  "recovery_strategy": [
    "Retry visual scan up to 3 times",
    "Retry grasp, recompute pose if unstable",
    "Reattempt alignment and stacking if position is off"
  ],
  "assumptions": [
    "Frame evidence shows two bowls and robot interaction consistent with instruction",
    "Exact object naming ('bowl_top', 'bowl_bottom') assigned based on frame ordering",
    "Alignment set to 'centered' though frames do not explicitly confirm precision; no visible tight tolerance bin needed"
  ],
  "evaluation_notes": {
    "expected_success_criteria": [
      "Both bowls are stacked in stable, centered configuration",
      "Retreat complete and no collision detected"
    ],
    "test_scenarios": [
      "happy path",
      "object_missing",
      "grasp_fail",
      "perception_noise"
    ]
  },
  "timing": {"model_reported_tokens": null, "client_elapsed_ms": null},
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id":"IsObjectVisible","attrs":{"target":"bowl_top"}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"bowl_top","timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "perceive",
      "active_leaf": {"id":"DetectObject","attrs":{"target":"bowl_bottom","timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "approach",
      "active_leaf": {"id":"OpenGripper","attrs":{"width":0.06,"timeout_ms":500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "approach",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"bowl_top","offset_z":0.05,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "grasp",
      "active_leaf": {"id":"GraspAtPose","attrs":{"pose_key":"grasp_top","strategy":"top","timeout_ms":1000}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "transfer",
      "active_leaf": {"id":"MoveAbove","attrs":{"target":"bowl_bottom","offset_z":0.05,"timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "place",
      "active_leaf": {"id":"Stack","attrs":{"target":"bowl_top","on_top_of":"bowl_bottom","alignment":"centered","press_force":5,"timeout_ms":1000}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id":"Retreat","attrs":{"distance":0.10,"timeout_ms":1200}},
      "active_path_ids": []
    }
  ]
}