{
  "dataset_id": "imperialcollege_sawyer_wrist_cam_0.1.0",
  "episode_id": "episode_044",
  "task_summary": "Insert the cap into the bottle by grasping the cap and aligning it above the bottle opening before pressing it in.",
  "task_long_description": {
    "overview": "The robot arm is instructed to insert a cap into the neck of a bottle. The environment is static with both objects visible. The cap must be grasped precisely, aligned with the bottle’s opening, and inserted with gentle pressure along the vertical axis. Visual confirmation is used for both objects, followed by precise pose estimation and actuation.",
    "preconditions": ["cap and bottle are within reachable workspace", "cap is not obstructed", "gripper is empty"],
    "stepwise_plan": [
      "Verify or locate the cap using visual input",
      "Approach and grasp the cap with a pinch strategy",
      "Verify the grasp is stable",
      "Verify or locate the bottle",
      "Align above the bottle opening",
      "Insert cap into bottle hole along z-axis with moderate force",
      "Release cap and retreat"
    ],
    "success_criteria": ["cap is fully inserted into the bottle opening", "gripper released the cap", "robot arm retreats to a safe position"],
    "failure_and_recovery": [
      "cap not detected → retry scan",
      "grasp failed → retry grasp pose computation",
      "bottle not detected → fallback detection step",
      "misaligned insertion → early retreat"
    ],
    "termination": "Task ends once cap is inserted, gripper released, and robot retreats"
  },
  "frame_ranking": {
    "order": ["frame_3","frame_5","frame_2","frame_6","frame_1","frame_4","frame_7","frame_0","frame_8"],
    "scores": {
      "frame_0": 0.12, "frame_1": 0.34, "frame_2": 0.56, "frame_3": 0.92,
      "frame_4": 0.28, "frame_5": 0.80, "frame_6": 0.49, "frame_7": 0.18, "frame_8": 0.05
    },
    "rationale_per_frame": {
      "frame_3": {
        "now_evidence": "first stable contact and alignment cue visible",
        "predicts_next": "push actuation expected; confirms goal direction",
        "uncertainty_reduction": "high"
      }
    }
  },
  "task_instruction": "insert cap in bottle",
  "instruction_to_ports": {
    "force": 10,
    "timeout_ms": 1200,
    "tolerance": 0.005,
    "retry_attempts": 3
  },
  "frame_source": "contact_sheet",
  "frame_order": ["frame_0","frame_1","frame_2","frame_3","frame_4","frame_5","frame_6","frame_7","frame_8"],
  "objects": ["cap", "bottle"],
  "objects_from_instruction": ["cap", "bottle"],
  "blackboard_keys": ["grasp_cap"],
  "node_specs": [
    {"id":"ScanForTarget", "type":"Action", "ports":{"target":"cap", "pattern":"raster", "max_attempts":3, "timeout_ms":1200}, "description":"Visual scan for cap using raster pattern"},
    {"id":"DetectObject", "type":"Action", "ports":{"target":"cap", "timeout_ms":1000}, "description":"Detect the cap"},
    {"id":"OpenGripper", "type":"Action", "ports":{"width":0.06, "timeout_ms":500}, "description":"Open gripper"},
    {"id":"MoveAbove", "type":"Action", "ports":{"target":"cap", "offset_z":0.05, "timeout_ms":1500}, "description":"Move above cap"},
    {"id":"ComputeGraspPose", "type":"Action", "ports":{"target":"cap", "strategy":"pinch", "result_key":"grasp_cap"}, "description":"Compute grasp pose"},
    {"id":"ApproachAndAlign", "type":"Action", "ports":{"target":"cap", "tolerance":0.005, "timeout_ms":1500}, "description":"Align with cap"},
    {"id":"LowerUntilContact", "type":"Action", "ports":{"speed":"slow", "max_depth":0.05, "force_threshold":5, "timeout_ms":1200}, "description":"Lower until contact"},
    {"id":"CloseGripper", "type":"Action", "ports":{"force":10, "timeout_ms":800}, "description":"Close gripper"},
    {"id":"IsGraspStable", "type":"Condition", "ports":{}, "description":"Check if grasp is stable"},
    {"id":"DetectObject", "type":"Action", "ports":{"target":"bottle", "timeout_ms":1000}, "description":"Detect bottle"},
    {"id":"MoveAbove", "type":"Action", "ports":{"target":"bottle", "offset_z":0.10, "timeout_ms":1500}, "description":"Move above bottle"},
    {"id":"InsertInto", "type":"Action", "ports":{"target":"cap", "slot_id":"hole_A", "axis":"z", "distance":0.05, "tolerance":0.005, "force_limit":10, "timeout_ms":1500}, "description":"Insert cap into bottle"},
    {"id":"Retreat", "type":"Action", "ports":{"distance":0.10, "timeout_ms":1200}, "description":"Retreat after insertion"}
  ],
  "tree_stats": {"nodes_total": 15, "actions": 13, "conditions": 2, "depth": 5},
  "failure_modes": ["object not detected", "grasp fails", "insertion misaligned"],
  "recovery_strategy": ["retry scan", "re-align and retry grasp", "early abort on contact issues"],
  "assumptions": ["cap is not pre-aligned with bottle; insertion must be actively executed"],
  "evaluation_notes": {
    "expected_success_criteria": ["cap inserted and released into bottle neck"],
    "test_scenarios": ["happy path", "object_missing", "grasp_fail", "perception_noise"]
  },
  "timing": {
    "model_reported_tokens": null,
    "client_elapsed_ms": null
  },
  "local_annotations": [
    {
      "frame": "frame_0",
      "phase": "perceive",
      "active_leaf": {"id": "ScanForTarget", "attrs": {"target":"cap", "pattern":"raster", "max_attempts":3, "timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_1",
      "phase": "approach",
      "active_leaf": {"id": "MoveAbove", "attrs": {"target":"cap", "offset_z":0.05, "timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_2",
      "phase": "verify",
      "active_leaf": {"id": "ComputeGraspPose", "attrs": {"target":"cap", "strategy":"pinch", "result_key":"grasp_cap"}},
      "active_path_ids": []
    },
    {
      "frame": "frame_3",
      "phase": "grasp",
      "active_leaf": {"id": "CloseGripper", "attrs": {"force":10, "timeout_ms":800}},
      "active_path_ids": []
    },
    {
      "frame": "frame_4",
      "phase": "transfer",
      "active_leaf": {"id": "MoveAbove", "attrs": {"target":"bottle", "offset_z":0.10, "timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_5",
      "phase": "place",
      "active_leaf": {"id": "InsertInto", "attrs": {"target":"cap", "slot_id":"hole_A", "axis":"z", "distance":0.05, "tolerance":0.005, "force_limit":10, "timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_6",
      "phase": "place",
      "active_leaf": {"id": "InsertInto", "attrs": {"target":"cap", "slot_id":"hole_A", "axis":"z", "distance":0.05, "tolerance":0.005, "force_limit":10, "timeout_ms":1500}},
      "active_path_ids": []
    },
    {
      "frame": "frame_7",
      "phase": "retreat",
      "active_leaf": {"id": "Retreat", "attrs": {"distance":0.10, "timeout_ms":1200}},
      "active_path_ids": []
    },
    {
      "frame": "frame_8",
      "phase": "retreat",
      "active_leaf": {"id": "Retreat", "attrs": {"distance":0.10, "timeout_ms":1200}},
      "active_path_ids": []
    }
  ]
}
